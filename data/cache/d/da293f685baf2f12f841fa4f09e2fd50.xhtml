
<h1 class="sectionedit1" id="use_python_for_pattern_searching">Use Python for pattern searching</h1>
<div class="level1">

<p>
<br/>

Material prepared by Stephen Weston
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Use Python for pattern searching&quot;,&quot;hid&quot;:&quot;use_python_for_pattern_searching&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-90&quot;} -->
<h3 class="sectionedit2" id="lecture_introduction_to_python">Lecture Introduction to Python</h3>
<div class="level3">
<pre class="code">mkdir python
cd python
wget http://research.computing.yale.edu/sites/default/files/files/python13JUL2016.pdf
wget https://raw.githubusercontent.com/selvaje/spatial-ecology-codes/master/wiki/python/notebooks/Python_Notebook.ipynb</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Lecture Introduction to Python&quot;,&quot;hid&quot;:&quot;lecture_introduction_to_python&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;91-372&quot;} -->
<h3 class="sectionedit3" id="exercise">Exercise</h3>
<div class="level3">
<pre class="code">wget https://raw.githubusercontent.com/selvaje/spatial-ecology-codes/master/wiki/python/example.txt
wget https://raw.githubusercontent.com/selvaje/spatial-ecology-codes/master/wiki/python/grep_1.py
wget https://raw.githubusercontent.com/selvaje/spatial-ecology-codes/master/wiki/python/grep_2.py
wget https://raw.githubusercontent.com/selvaje/spatial-ecology-codes/master/wiki/python/grep_3.py
wget https://raw.githubusercontent.com/selvaje/spatial-ecology-codes/master/wiki/python/grep.py
wget https://raw.githubusercontent.com/selvaje/spatial-ecology-codes/master/wiki/python/sub.py
wget https://raw.githubusercontent.com/selvaje/spatial-ecology-codes/master/wiki/python/grep_color.py</pre>
<pre class="code">./grep_1.py</pre>
<dl class="file">
<dt><a href="https://github.com/selvaje/spatial-ecology-codes/blob/master/wiki/python/grep_1.py" class="mediafile mf_py">wiki/python/grep_1.py</a></dt>
<dd><pre class="code file python"><span class="co1">#!/usr/bin/env python</span>
<span class="co1">#</span>
<span class="co1"># Print all lines from &quot;example.txt&quot; that contain the string &quot;line&quot;</span>
<span class="co1">#</span>
<span class="kw1">import</span> <span class="kw3">sys</span><span class="sy0">,</span> <span class="kw3">re</span>
<span class="kw1">for</span> s <span class="kw1">in</span> <span class="kw2">open</span><span class="br0">&#40;</span><span class="st0">'example.txt'</span><span class="sy0">,</span> <span class="st0">'rt'</span><span class="br0">&#41;</span>:
    <span class="kw1">if</span> <span class="kw3">re</span>.<span class="me1">search</span><span class="br0">&#40;</span><span class="st0">'line'</span><span class="sy0">,</span> s<span class="br0">&#41;</span>:
        <span class="kw3">sys</span>.<span class="me1">stdout</span>.<span class="me1">write</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span></pre>
</dd></dl><pre class="code">./grep_2.py line example.txt</pre>
<dl class="file">
<dt><a href="https://github.com/selvaje/spatial-ecology-codes/blob/master/wiki/python/grep_2.py" class="mediafile mf_py">wiki/python/grep_2.py</a></dt>
<dd><pre class="code file python"><span class="co1">#!/usr/bin/env python</span>
<span class="co1">#</span>
<span class="co1"># Print all lines from file argv[2] that match regex argv[1]</span>
<span class="co1">#</span>
<span class="kw1">import</span> <span class="kw3">sys</span><span class="sy0">,</span> <span class="kw3">re</span>
<span class="kw1">for</span> s <span class="kw1">in</span> <span class="kw2">open</span><span class="br0">&#40;</span><span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="st0">'rt'</span><span class="br0">&#41;</span>:
    <span class="kw1">if</span> <span class="kw3">re</span>.<span class="me1">search</span><span class="br0">&#40;</span><span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">,</span> s<span class="br0">&#41;</span>:
        <span class="kw3">sys</span>.<span class="me1">stdout</span>.<span class="me1">write</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span></pre>
</dd></dl><pre class="code">./grep_3.py line example.txt</pre>
<dl class="file">
<dt><a href="https://github.com/selvaje/spatial-ecology-codes/blob/master/wiki/python/grep_3.py" class="mediafile mf_py">wiki/python/grep_3.py</a></dt>
<dd><pre class="code file python"><span class="co1">#!/usr/bin/env python</span>
<span class="co1">#</span>
<span class="co1"># Python script that works like a simplified &quot;grep&quot; command</span>
<span class="co1"># but without any error handling</span>
<span class="co1">#</span>
<span class="kw1">import</span> <span class="kw3">sys</span><span class="sy0">,</span> <span class="kw3">re</span>
&nbsp;
<span class="kw1">for</span> fn <span class="kw1">in</span> <span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">2</span>:<span class="br0">&#93;</span>:
    fobj <span class="sy0">=</span> <span class="kw2">open</span><span class="br0">&#40;</span>fn<span class="sy0">,</span> <span class="st0">'rt'</span><span class="br0">&#41;</span>
    <span class="kw1">for</span> s <span class="kw1">in</span> fobj:
        <span class="kw1">if</span> <span class="kw3">re</span>.<span class="me1">search</span><span class="br0">&#40;</span><span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">,</span> s<span class="br0">&#41;</span>:
            <span class="kw3">sys</span>.<span class="me1">stdout</span>.<span class="me1">write</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>
    fobj.<span class="me1">close</span><span class="br0">&#40;</span><span class="br0">&#41;</span></pre>
</dd></dl><pre class="code"># see the error message 
./grep.py line
# correct way to run 
./grep.py line example.txt</pre>
<dl class="file">
<dt><a href="https://github.com/selvaje/spatial-ecology-codes/blob/master/wiki/python/grep.py" class="mediafile mf_py">wiki/python/grep.py</a></dt>
<dd><pre class="code file python"><span class="co1">#!/usr/bin/env python</span>
<span class="co1">#</span>
<span class="co1"># Python script that works like a simplified &quot;grep&quot; command</span>
<span class="co1"># which doesn't read from stdin</span>
<span class="co1">#</span>
<span class="kw1">import</span> <span class="kw3">sys</span><span class="sy0">,</span> <span class="kw3">re</span>
<span class="kw1">from</span> <span class="kw3">os</span>.<span class="me1">path</span> <span class="kw1">import</span> basename
&nbsp;
<span class="kw1">if</span> <span class="kw2">len</span><span class="br0">&#40;</span><span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#41;</span> <span class="sy0">&lt;</span> <span class="nu0">3</span>:
    <span class="kw3">sys</span>.<span class="me1">stderr</span>.<span class="me1">write</span><span class="br0">&#40;</span><span class="st0">'Usage: %s regex file ...<span class="es0">\n</span>'</span> % basename<span class="br0">&#40;</span><span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="kw3">sys</span>.<span class="me1">exit</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>
&nbsp;
r <span class="sy0">=</span> <span class="kw3">re</span>.<span class="kw2">compile</span><span class="br0">&#40;</span><span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">for</span> fn <span class="kw1">in</span> <span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">2</span>:<span class="br0">&#93;</span>:
    <span class="kw1">try</span>:
        fobj <span class="sy0">=</span> <span class="kw2">open</span><span class="br0">&#40;</span>fn<span class="sy0">,</span> <span class="st0">'rt'</span><span class="br0">&#41;</span>
        <span class="kw1">try</span>:
            <span class="kw1">for</span> s <span class="kw1">in</span> fobj:
                <span class="kw1">if</span> r.<span class="me1">search</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>:
                    <span class="kw3">sys</span>.<span class="me1">stdout</span>.<span class="me1">write</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>
        <span class="kw1">finally</span>:
            fobj.<span class="me1">close</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="kw1">except</span> <span class="kw2">IOError</span><span class="sy0">,</span> e:
        <span class="kw3">sys</span>.<span class="me1">stderr</span>.<span class="me1">write</span><span class="br0">&#40;</span><span class="st0">'error opening file %r<span class="es0">\n</span>'</span> % fn<span class="br0">&#41;</span></pre>
</dd></dl><dl class="file">
<dt><a href="https://github.com/selvaje/spatial-ecology-codes/blob/master/wiki/python/sub.py" class="mediafile mf_py">wiki/python/sub.py</a></dt>
<dd><pre class="code file python"><span class="co1">#!/usr/bin/env python</span>
<span class="co1">#</span>
<span class="co1"># Example use of the re.sub function</span>
<span class="co1">#</span>
<span class="kw1">import</span> <span class="kw3">re</span>
<span class="kw1">print</span> <span class="kw3">re</span>.<span class="me1">sub</span><span class="br0">&#40;</span><span class="st0">'a+'</span><span class="sy0">,</span> <span class="st0">'++<span class="es0">\\</span>g&lt;0&gt;++'</span><span class="sy0">,</span> <span class="st0">'a test aaaa of aaaaaa'</span><span class="br0">&#41;</span></pre>
</dd></dl><pre class="code">./grep_color.py line example.txt
# or 
./grep_color.py  &quot;t[a-z]&quot;   example.txt</pre>
<dl class="file">
<dt><a href="https://github.com/selvaje/spatial-ecology-codes/blob/master/wiki/python/grep_color.py" class="mediafile mf_py">wiki/python/grep_color.py</a></dt>
<dd><pre class="code file python"><span class="co1">#!/usr/bin/env python</span>
<span class="co1">#</span>
<span class="co1"># Python script that works like a simplified &quot;grep&quot; command</span>
<span class="co1"># which doesn't read from stdin and uses terminal highlighting</span>
<span class="co1">#</span>
<span class="kw1">import</span> <span class="kw3">sys</span><span class="sy0">,</span> <span class="kw3">re</span>
<span class="kw1">from</span> <span class="kw3">os</span>.<span class="me1">path</span> <span class="kw1">import</span> basename
&nbsp;
<span class="kw1">if</span> <span class="kw2">len</span><span class="br0">&#40;</span><span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#41;</span> <span class="sy0">&lt;</span> <span class="nu0">3</span>:
    <span class="kw3">sys</span>.<span class="me1">stderr</span>.<span class="me1">write</span><span class="br0">&#40;</span><span class="st0">'Usage: %s regex file ...<span class="es0">\n</span>'</span> % basename<span class="br0">&#40;</span><span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="kw3">sys</span>.<span class="me1">exit</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>
&nbsp;
r <span class="sy0">=</span> <span class="kw3">re</span>.<span class="kw2">compile</span><span class="br0">&#40;</span><span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>
repl <span class="sy0">=</span> <span class="st0">'<span class="es0">\x</span>1b[7m<span class="es0">\\</span>g&lt;0&gt;<span class="es0">\x</span>1b[0m'</span>
&nbsp;
<span class="kw1">for</span> fn <span class="kw1">in</span> <span class="kw3">sys</span>.<span class="me1">argv</span><span class="br0">&#91;</span><span class="nu0">2</span>:<span class="br0">&#93;</span>:
    <span class="kw1">try</span>:
        fobj <span class="sy0">=</span> <span class="kw2">open</span><span class="br0">&#40;</span>fn<span class="sy0">,</span> <span class="st0">'rt'</span><span class="br0">&#41;</span>
        <span class="kw1">try</span>:
            <span class="kw1">for</span> s <span class="kw1">in</span> fobj:
                <span class="kw1">if</span> r.<span class="me1">search</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>:
                    <span class="kw3">sys</span>.<span class="me1">stdout</span>.<span class="me1">write</span><span class="br0">&#40;</span><span class="kw3">re</span>.<span class="me1">sub</span><span class="br0">&#40;</span>r<span class="sy0">,</span> repl<span class="sy0">,</span> s<span class="br0">&#41;</span><span class="br0">&#41;</span>
        <span class="kw1">finally</span>:
            fobj.<span class="me1">close</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="kw1">except</span> <span class="kw2">IOError</span><span class="sy0">,</span> e:
        <span class="kw3">sys</span>.<span class="me1">stderr</span>.<span class="me1">write</span><span class="br0">&#40;</span><span class="st0">'error opening file %r<span class="es0">\n</span>'</span> % fn<span class="br0">&#41;</span></pre>
</dd></dl>
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Exercise&quot;,&quot;hid&quot;:&quot;exercise&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;373-&quot;} -->