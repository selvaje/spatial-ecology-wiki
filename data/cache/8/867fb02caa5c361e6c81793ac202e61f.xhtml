
<h1 class="sectionedit1" id="introducing_rasdaman">Introducing rasdaman</h1>
<div class="level1">

<p>
Professor Peter Baumann presenting <a href="http://www.spatial-ecology.net/ost4sem/lecture/PBAumann20160615_FOSS_summerschool-intro.pdf" class="urlextern" target="blanc" title="http://www.spatial-ecology.net/ost4sem/lecture/PBAumann20160615_FOSS_summerschool-intro.pdf" rel="nofollow noopener"> Spatio-Temporal Datacubes &quot;one cube says more than a million images&quot;</a> Summer school 2016 in Matera, Italy.
</p>

</div>
<!-- EDIT1 SECTION "Introducing rasdaman" [1-275] -->
<h1 class="sectionedit2" id="what_is_rasdaman">What is rasdaman?</h1>
<div class="level1">

<p>
<strong>Material prepared for Summer School: Hands-on Open Source Drone Mapping and High Performance Computing for Big Geo-Data, Matera, Italy,  13th-17th June 2016<br/>

<br/>

by:<br/>

Vlad Merticariu (v.merticariu@jacobs-university.de)<br/>

Alex Mircea Dumitru (m.dumitru@jacobs-university.de)</strong>
<br/>

</p>

<p>
Rasdaman (“raster data manager”) allows storing and querying massive multi-dimensional arrays, such as sensor, image, simulation, and statistics data appearing in
domains like earth, space, and life science. This worldwide leading array analytics engine distinguishes itself by its flexibility, performance, and scalability.
Rasdaman can process arrays residing in file system directories as well as in databases. From simple geo imagery services up to complex analytics,
rasdaman provides the whole spectrum of functionality on spatio-temporal raster data - both regular and irregular grids. And it does so with an unprecedented
performance and scalability, as recent scientific benchmarks show.
</p>

<p>
<a href="/dokuwiki/lib/exe/fetch.php?tok=31e9a4&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Frasdaman-collage.png" class="media" title="http://rasdaman.flanche.net/img/rasdaman-collage.png"><img src="/dokuwiki/lib/exe/fetch.php?tok=31e9a4&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Frasdaman-collage.png" class="media" title="Rasdaman Image" alt="Rasdaman Image" /></a>
</p>

</div>
<!-- EDIT2 SECTION "What is rasdaman?" [276-1380] -->
<h1 class="sectionedit3" id="why_rasdaman">Why rasdaman?</h1>
<div class="level1">

<p>
Often, especially in the fields of remote sensing and geomatics, Big Data
is synonym of Big Rasters: huge space-borne, air-borne, hyper-spectral images
are literally creating a deluge of bytes.
</p>

<p>
<a href="/dokuwiki/lib/exe/fetch.php?tok=bd2626&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fgrid.png" class="media" title="http://rasdaman.flanche.net/img/grid.png"><img src="/dokuwiki/lib/exe/fetch.php?tok=bd2626&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fgrid.png" class="media" title="Rasdaman Temporal Grid" alt="Rasdaman Temporal Grid" /></a>
</p>

<p>
A first key feature is being open and standard. Data access and curation services are
moving towards web GIS platforms, from simple visualization and download, to more advanced
computations: it is a clear advantage when every service speaks the same language, and this
language is usually defined by the Open Geospatial Consortium.
</p>

<p>
rasdaman is the reference implementation of the OGC Web Coverage Service (WCS)
and its team is actively participating in the evolution of the standards within OGC, especially
for everything that surrounds the so-called coverages.
</p>

<p>
<a href="/dokuwiki/lib/exe/fetch.php?tok=604f4d&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fcopernicus.png" class="media" title="http://rasdaman.flanche.net/img/copernicus.png"><img src="/dokuwiki/lib/exe/fetch.php?tok=604f4d&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fcopernicus.png" class="media" title="Copernicus Awards" alt="Copernicus Awards" /></a>
</p>

<p>
Aside of that, rasdaman is the reference (and only available implementation) of the most
exciting extension of the WCS service: the Processing Extension. This key feature lets you
exploit the flexibility of a full query language for coverages to request ad-hoc processing to the server,
so that you can minimize bandwidth usage on data transfer and indeed: move the processing to the data.
</p>

<p>
Underneath it all, the rasdaman Array DBMS ensures ad-hoc optimizations for the access and
elaboration of multi-dimensional arrays, being especially prone to the storage of time-series or — more
generally — hypercubes of images and gridded datasets.
</p>

<p>
In the next subsections we will cover all these concepts in more detail: rasdaman and its
RasQL query language will be described in Section 1;
the OGC coverage model (GMLCOV) is explained in Section 2;
finally Section 3 will talk about the OGC web services for coverages available with rasdaman.
</p>

</div>
<!-- EDIT3 SECTION "Why rasdaman?" [1381-3281] -->
<h1 class="sectionedit4" id="rasdaman_and_rasql">Rasdaman and Rasql</h1>
<div class="level1">

</div>
<!-- EDIT4 SECTION "Rasdaman and Rasql" [3282-3304] -->
<h2 class="sectionedit5" id="installation">Installation</h2>
<div class="level2">

<p>
Rasdaman supports multiple installation methods, from a simple deb / rpm package install to a more flexible installer 
that allows you to select specific components to install and enable support for more “exotic” formats.
</p>

<p>
To install from a debian package just add the rasdaman apt repository to your sources.list and then install rasdaman as any other package.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=0" title="Download Snippet" class="mediafile mf_bash">snippet.bash</a></dt>
<dd><pre class="code file bash"><span class="co0"># Adding the repository on a ubuntu host</span>
<span class="kw3">echo</span> <span class="st0">&quot;deb [arch=amd64] http://download.rasdaman.org/packages/ubuntu trusty nightly&quot;</span> \
<span class="sy0">|</span> <span class="kw2">sudo</span> <span class="kw2">tee</span> <span class="sy0">/</span>etc<span class="sy0">/</span>apt<span class="sy0">/</span>sources.list.d<span class="sy0">/</span>rasdaman.list
&nbsp;
<span class="co0"># Installing rasdaman</span>
<span class="kw2">sudo</span> <span class="kw2">apt-get update</span>
<span class="kw2">sudo</span> <span class="kw2">apt-get install</span> rasdaman</pre>
</dd></dl>

<p>
You can also do the same for an RPM based distribution (e.g. CentOS or Fedora) by following the instructions
on this <a href="http://rasdaman.org/wiki/InstallFromRPM" class="urlextern" target="blanc" title="http://rasdaman.org/wiki/InstallFromRPM" rel="nofollow noopener">page</a>.
</p>

<p>
Finally, if you want to customize your installation, try the rasdaman installer following the instructions
found on this <a href="http://rasdaman.org/wiki/Installer" class="urlextern" target="blanc" title="http://rasdaman.org/wiki/Installer" rel="nofollow noopener">page</a>.
</p>

<p>
Once you have installed rasdaman, make sure it is working properly by issuing a simple query from the command-line.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=1" title="Download Snippet" class="mediafile mf_bash">snippet.bash</a></dt>
<dd><pre class="code file bash"><span class="co0"># Make sure rasql is in your path</span>
<span class="kw3">source</span> <span class="sy0">/</span>etc<span class="sy0">/</span>profile.d<span class="sy0">/</span>rasdaman
<span class="co0"># Run the query</span>
rasql <span class="re5">-q</span> <span class="st_h">'SELECT m FROM RAS_COLLECTIONNAMES as m&quot; --out string</span></pre>
</dd></dl>

</div>
<!-- EDIT5 SECTION "Installation" [3305-4551] -->
<h2 class="sectionedit6" id="conceptual_model">Conceptual model</h2>
<div class="level2">

<p>
Now that we have a working rasdaman installation, let&#039;s explore the conceptual model behind it through some simple examples.
</p>

<p>
Internally and invisible to the application, arrays are decomposed into smaller units by
means of customizable tiling strategies, which are then maintained either directly on disk (for increased performance) 
or in a conventional DBMS (for datacenter integration).
</p>

</div>
<!-- EDIT6 SECTION "Conceptual model" [4552-4965] -->
<h3 class="sectionedit7" id="what_exactly_is_an_array">What exactly is an array?</h3>
<div class="level3">

<p>
<a href="/dokuwiki/lib/exe/fetch.php?tok=f8ed73&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fmarray.png" class="media" title="http://rasdaman.flanche.net/img/marray.png"><img src="/dokuwiki/lib/exe/fetch.php?tok=f8ed73&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fmarray.png" class="media" title="Array concept" alt="Array concept" /></a>
</p>

<p>
A multidimensional array is a set of elements which are ordered in space.
The space considered here is discretized, i.e., only integer coordinates are admitted.
</p>

<p>
The number of integers needed to identify a particular position in this
space is called the <em>dimension</em> (sometimes also referred to as
<em>dimensionality</em>. Each array element, which is referred to as cell, is
positioned in space through its coordinates.
</p>

<p>
A cell can contain a single value (such as an intensity value in case of
grayscale images) or a composite value (such as integer triples for the
red, green, and blue components of a true-color image). All cells share the
same structure which is referred to as the array cell type array base type.
</p>

<p>
In rasdaman databases, arrays are grouped into collections. All elements of a collection share the same array type definition. 
Collections form the basis for array handling, just as tables do in relational database technology. All operations applied to 
a collection are applied in term to each of the array in the collection.
</p>

</div>
<!-- EDIT7 SECTION "What exactly is an array?" [4966-6115] -->
<h2 class="sectionedit8" id="querying_the_data">Querying the data</h2>
<div class="level2">

<p>
rasql provides declarative query functionality on collections (i.e., sets) of MDD stored in a rasdaman database. 
The query language is based on the SQL-92 standard and the basis for the upcoming SQL/MDA standard. It extends the language with high-level 
multidimensional operators.
The general query structure is best explained by means of an example. Consider the following query: in the from clause, 
mr is specified as the working collection on which all evaluation will take place. 
This name, which serves as an “iterator variable” over this collection, can be used in other parts of the query for referencing 
the particular collection element under inspection.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=2" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Basic example</span>
<span class="kw1">SELECT</span> mr<span class="br0">&#91;</span><span class="nu0">100</span>:<span class="nu0">150</span><span class="sy0">,</span><span class="nu0">40</span>:<span class="nu0">80</span><span class="br0">&#93;</span> <span class="sy0">/</span> <span class="nu0">2</span>
<span class="kw1">FROM</span>   mr
<span class="kw1">WHERE</span>  some_cells<span class="br0">&#40;</span> mr<span class="br0">&#91;</span><span class="nu0">120</span>:<span class="nu0">160</span><span class="sy0">,</span> <span class="nu0">55</span>:<span class="nu0">75</span><span class="br0">&#93;</span> <span class="sy0">&gt;</span> <span class="nu0">250</span> <span class="br0">&#41;</span>
&nbsp;
<span class="co1">-- Using an alias</span>
<span class="co1">-- Remember operations are applied to each array in the collection</span>
<span class="kw1">SELECT</span> <span class="br0">&#40;</span>m <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy0">*</span> <span class="nu0">2</span> <span class="kw1">FROM</span> mr <span class="kw1">AS</span> m</pre>
</dd></dl>

<p>
Optionally, an alias name can be given to the collection (see syntax below) – however, in most cases this is not necessary.
In the where clause, a condition is phrased. Each collection element in turn is probed, and upon fulfillment of the condition the 
item is added to the query result set. In the example query, part of the image is tested against a threshold value.
Elements in the query result set, finally, can be “post-processed” in the select clause by applying further operations. In the case 
on hand, a spatial extraction is done combined with an intensity reduction on the extracted image part.
In summary, a rasql query returns a set fulfilling some search condition just as is the case with conventional SQL and OQL. 
The difference lies in the operations which are available in the select and where clause: SQL does not support expressions containing 
multidimensional operators, whereas rasql does.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=3" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
<span class="kw1">SELECT</span> resultList
<span class="kw1">FROM</span>   collName <span class="br0">&#91;</span> <span class="kw1">AS</span> collAlias <span class="br0">&#93;</span>
       <span class="br0">&#91;</span><span class="sy0">,</span> collName <span class="br0">&#91;</span> <span class="kw1">AS</span> collAlias <span class="br0">&#93;</span> <span class="br0">&#93;</span> <span class="sy0">...</span>
<span class="br0">&#91;</span> <span class="kw1">WHERE</span>  booleanExp <span class="br0">&#93;</span></pre>
</dd></dl>

</div>
<!-- EDIT8 SECTION "Querying the data" [6116-8099] -->
<h3 class="sectionedit9" id="possible_result_types">Possible result types</h3>
<div class="level3">

<p>
Type and format of the query result are specified in the select part of the query. The query result type can be multidimensional, 
a struct, or atomic (i.e., scalar). The select clause can reference the collection iteration variable defined in the from clause; 
each array in the collection will be assigned to this iteration variable successively.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=4" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Selecting one atomic scalar value</span>
<span class="kw1">SELECT</span> m<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">FROM</span> Values1D <span class="kw1">AS</span> m
&nbsp;
<span class="co1">-- Selecting one composite scalar value</span>
<span class="kw1">SELECT</span> m<span class="br0">&#91;</span><span class="nu0">0</span>;<span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">FROM</span> rgb <span class="kw1">AS</span> m
&nbsp;
<span class="co1">-- Selecting a mdd value </span>
<span class="kw1">SELECT</span> m<span class="br0">&#91;</span><span class="nu0">0</span>:<span class="nu0">10</span><span class="br0">&#93;</span> <span class="kw1">FROM</span> Values1D <span class="kw1">AS</span> m
<span class="kw1">SELECT</span> m<span class="br0">&#91;</span><span class="nu0">0</span>:<span class="nu0">10</span>;<span class="nu0">0</span>:<span class="nu0">10</span><span class="br0">&#93;</span> <span class="kw1">FROM</span> mr <span class="kw1">AS</span> m</pre>
</dd></dl>

</div>
<!-- EDIT9 SECTION "Possible result types" [8100-8720] -->
<h3 class="sectionedit10" id="specifying_the_inputthe_from_clause">Specifying the input: the From Clause</h3>
<div class="level3">

<p>
In the from clause, the list of collections to be inspected is specified, optionally together with a 
variable name which is associated to each collection. For query evaluation the cross product between 
all participating collections is built which means that every possible combination of elements from all 
collections is evaluated. For instance in case of two collections, each MDD of the first collection is 
combined with each MDD of the second collection. Hence, combining a collection with n elements with a 
collection containing m elements results in n*m combinations. This is important for estimating query response time.
The following example subtracts each MDD of collection mr2 from each MDD of collection mr. 
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=5" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="kw1">SELECT</span> mr – mr2
<span class="kw1">FROM</span>   mr<span class="sy0">,</span> mr2</pre>
</dd></dl>

</div>
<!-- EDIT10 SECTION "Specifying the input: the From Clause" [8721-9533] -->
<h3 class="sectionedit11" id="filtering_the_inputthe_where_clause">Filtering the input: the Where Clause</h3>
<div class="level3">

<p>
In the where clause, conditions are specified which members of the query result set must fulfil. 
Like in SQL, predicates are built as boolean expressions using comparison, parenthesis, functions, etc. 
Unlike SQL, however, rasql offers mechanisms to express selection criteria on multidimensional items.
We can for example restrict the input of the query to those images where at least one difference pixel value is greater than 50
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=6" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="kw1">SELECT</span> mr – mr2
<span class="kw1">FROM</span>  mr<span class="sy0">,</span> mr2
<span class="kw1">WHERE</span>  some_cells<span class="br0">&#40;</span> mr – mr2 <span class="sy0">&gt;</span> <span class="nu0">50</span> <span class="br0">&#41;</span></pre>
</dd></dl>

</div>
<!-- EDIT11 SECTION "Filtering the input: the Where Clause" [9534-10090] -->
<h3 class="sectionedit12" id="describing_the_outputthe_select_clause">Describing the output: the Select Clause</h3>
<div class="level3">

<p>
Type and format of the query result are specified in the select part of the query. 
The query result type can be multidimensional, a struct, or atomic (i.e., scalar). 
The select clause can reference the collection iteration variable defined in the from clause; 
each array in the collection will be assigned to this iteration variable successively.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=7" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Selecting the mr image with the pixel intensity reduces by a factor of 2</span>
<span class="kw1">SELECT</span> mr <span class="sy0">/</span> <span class="nu0">2</span>
<span class="kw1">FROM</span>   mr</pre>
</dd></dl>

</div>

<h4 id="constants">Constants</h4>
<div class="level4">

<p>
Atomic constants are written in standard C/C++ style. If necessary constants are augmented with a 
one or two letter postfix to un­ambiguously determine its data type.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=8" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql">25c
<span class="sy0">-</span>1700L
<span class="sy0">.</span>4e<span class="sy0">-</span>5D</pre>
</dd></dl>

</div>

<h4 id="composite_constants">Composite Constants</h4>
<div class="level4">

<p>
Composite constants resemble records (“structs”) over atomic con­stants or other records. Notation is as follows.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=9" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
<span class="br0">&#123;</span> const_0<span class="sy0">,</span>
     <span class="sy0">...</span>
  const_n
<span class="br0">&#125;</span>
<span class="co1">-- Example for a composite value with 3 bands</span>
<span class="kw1">SELECT</span> <span class="br0">&#123;</span><span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">200</span><span class="sy0">,</span> <span class="nu0">128</span><span class="br0">&#125;</span></pre>
</dd></dl>

</div>

<h4 id="complex_numbers">Complex numbers</h4>
<div class="level4">

<p>
Special built-in structs are complex and complexd for single and double precision complex numbers, resp.
The resulting complex constant is of type
complexd if at least one of the constituent expressions is double precision, otherwise the result is of type complex.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=10" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
complex<span class="br0">&#40;</span>re<span class="sy0">,</span> im<span class="br0">&#41;</span>
&nbsp;
<span class="co1">-- Example returning equivalent of math 2 + 3i</span>
<span class="kw1">SELECT</span> complex<span class="br0">&#40;</span><span class="nu0">2</span><span class="sy0">,</span> <span class="nu0">3</span><span class="br0">&#41;</span></pre>
</dd></dl>

</div>

<h4 id="array_constants">Array Constants</h4>
<div class="level4">

<p>
Small array constants can be indicated literally. 
An array constant consists of the spatial domain specification followed by the cell values whereby 
value sequencing is as follow. The array is linearized in a way that the lowest dimension1 is the “outermost”
dimension and the highest dimension2 is the “innermost” one. Within each dimension, elements are listed sequentially, 
starting with the lower bound and proceeding until the upper bound. List elements for the innermost dimension are 
separated by comma “,”, all others by semicolon “;”.
The exact number of values as specified in the leading spatial domain expression must be provided. 
All constants must have the same type; this will be the result array&#039;s base type.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=11" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
<span class="sy0">&lt;</span> mintervalExp
  scalarList_0 ;
  <span class="sy0">...</span> ;
  scalarList_n ;
<span class="sy0">&gt;</span>
<span class="co1">-- Example of a 3 by 5 matrix</span>
<span class="kw1">SELECT</span> <span class="sy0">&lt;</span> <span class="br0">&#91;</span><span class="sy0">-</span><span class="nu0">1</span>:<span class="nu0">1</span><span class="sy0">,-</span><span class="nu0">2</span>:<span class="nu0">2</span><span class="br0">&#93;</span> <span class="nu0">0</span><span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">2</span><span class="sy0">,</span> <span class="nu0">3</span><span class="sy0">,</span> <span class="nu0">4</span>; <span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">2</span><span class="sy0">,</span> <span class="nu0">3</span><span class="sy0">,</span> <span class="nu0">4</span><span class="sy0">,</span> <span class="nu0">5</span>; <span class="nu0">2</span><span class="sy0">,</span> <span class="nu0">3</span><span class="sy0">,</span> <span class="nu0">4</span><span class="sy0">,</span> <span class="nu0">5</span><span class="sy0">,</span> <span class="nu0">6</span> <span class="sy0">&gt;</span></pre>
</dd></dl>

</div>

<h4 id="spatial_domain">Spatial Domain</h4>
<div class="level4">

<p>
The m-interval covered by an array is called the array&#039;s spatial domain. Function sdom() allows to 
retrieve an array&#039;s current spatial domain. The current domain of an array is the minimal 
axis-parallel bounding box containing all currently defined cells.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=12" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
sdom<span class="br0">&#40;</span>mddExpression<span class="br0">&#41;</span>
&nbsp;
<span class="co1">-- Returning the sdom of mr</span>
<span class="kw1">SELECT</span> sdom<span class="br0">&#40;</span>mr<span class="br0">&#41;</span> <span class="kw1">FROM</span> mr <span class="co1">-- Result: [0:255;0:210]</span>
<span class="kw1">SELECT</span> sdom<span class="br0">&#40;</span>mr<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">FROM</span> mr <span class="co1">-- Result: [0:255]</span>
<span class="kw1">SELECT</span> sdom<span class="br0">&#40;</span>mr<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">.</span>lo <span class="kw1">FROM</span> mr <span class="co1">-- Result: [0]</span>
<span class="kw1">SELECT</span> sdom<span class="br0">&#40;</span>mr<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">.</span>hi <span class="kw1">FROM</span> mr <span class="co1">-- Result: [255]</span></pre>
</dd></dl>

</div>

<h4 id="trimming">Trimming</h4>
<div class="level4">

<p>
Reducing the spatial domain of an array while leaving the cell values unchanged is called trimming. Array dimension remains unchanged.
The generalized trim operator allows restriction, extension, and a combination of both operations in a shorthand syntax. This operator does not check for proper subsetting or supersetting of the domain modifier.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=13" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
mddExpression<span class="br0">&#91;</span>mintervalExpression<span class="br0">&#93;</span>
&nbsp;
<span class="co1">-- Returning a cutout on x axis from pixel 120 to  pixel 160 and on y axis from 55 to 75</span>
<span class="kw1">SELECT</span> mr<span class="br0">&#91;</span> <span class="nu0">120</span>:<span class="nu0">160</span><span class="sy0">,</span> <span class="nu0">55</span>:<span class="nu0">75</span> <span class="br0">&#93;</span>
<span class="kw1">FROM</span> mr</pre>
</dd></dl>

</div>

<h4 id="section">Section</h4>
<div class="level4">

<p>
A section allows to extract lower-dimen­sional layers (“slices”) from an array.
A section is accomplished through a trim expression by indicating the slicing position rather than a selection interval.
A section can be made in any dimension within a trim expression. Each section reduces the dimension by one.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=14" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
mddExp <span class="br0">&#91;</span> integerExp_0<span class="sy0">,</span> <span class="sy0">...,</span> integerExp_n <span class="br0">&#93;</span>
<span class="co1">-- Selecting one slice out of a 3D cube</span>
<span class="kw1">SELECT</span> m<span class="br0">&#91;</span><span class="nu0">0</span>:<span class="nu0">720</span>;<span class="nu0">0</span>:<span class="nu0">360</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">FROM</span> AvgLandTemp m</pre>
</dd></dl>

</div>

<h4 id="induced_operations">Induced Operations</h4>
<div class="level4">

<p>
Induced operations allow to simultaneously apply a function originally working on a single cell value to 
all cells of an MDD. The result MDD has the same spatial domain, but can change its base type.
</p>

<p>
Unary induction means that only one array operand is involved in the expression. Two situations can occur:
Either the operation is unary by nature (such as boolean not); then, this operation is applied to each array cell.
Or the induce operation combines a single value (scalar) with the array; then, the contents of each cell is 
combined with the scalar value.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=15" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">--Syntax</span>
mddExp op mddExp
&nbsp;
<span class="co1">-- Example adding two arrays and multiplying with a scalar</span>
<span class="kw1">SELECT</span> m <span class="sy0">*</span> m <span class="sy0">+</span> <span class="nu0">2</span> <span class="sy0">*</span> m <span class="sy0">+</span> <span class="nu0">1</span> <span class="kw1">FROM</span> mr <span class="kw1">AS</span> m
&nbsp;
<span class="kw1">SELECT</span> <span class="kw1">NOT</span><span class="br0">&#40;</span>mr <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">FROM</span> mr
&nbsp;
<span class="kw1">SELECT</span> mr <span class="sy0">*</span> <span class="br0">&#40;</span>mr <span class="sy0">&gt;</span> <span class="nu0">255</span><span class="br0">&#41;</span> <span class="kw1">FROM</span> mr</pre>
</dd></dl>

</div>

<h4 id="arithmetic_trigonometric_and_exponential_functions">Arithmetic, trigonometric, and exponential functions</h4>
<div class="level4">

<p>
The following advanced arithmetic functions are available with the obvious meaning, each of them accepting an MDD object:
abs() sqrt() exp() log() ln() pow() power() sin() cos() tan() sinh() cosh() tanh() arcsin() arccos() arctan()
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=16" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">--Syntax</span>
op<span class="br0">&#40;</span>mddExpr<span class="br0">&#41;</span>
&nbsp;
<span class="co1">-- Example</span>
<span class="kw1">SELECT</span> ln<span class="br0">&#40;</span>m <span class="sy0">*</span> m <span class="sy0">+</span> <span class="nu0">2</span> <span class="sy0">*</span> m <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">FROM</span> mr <span class="kw1">AS</span> m</pre>
</dd></dl>

</div>

<h4 id="cast_operation">Cast operation</h4>
<div class="level4">

<p>
Sometimes the desired ultimate scalar type or MDD cell type is different from what the
 MDD expression would suggest. To this end, the result type can be enforced explicitly through the cast operator.
</p>

<p>
<code>sql
-- Syntax
(newType) mddExpression

-- Example casting the result as an integer before summing elements to avoid overflow
SELECT sum((long) mr) FROM mr
</code>
</p>

</div>

<h4 id="composite_value_component_selection">Composite Value Component Selection</h4>
<div class="level4">

<p>
Component selection from a composite value is done with the dot operator well-known from programming languages. 
The argument can either be a number (starting with 0) or the struct element name. Both statements of the following 
example would select the green plane of the sample RGB image.
This is a special case of a unary induced operator.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=17" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">--Syntax</span>
mddExp<span class="sy0">.</span>componentName
&nbsp;
<span class="co1">-- Extracting the red channel from the rgb image</span>
<span class="kw1">SELECT</span> rgb<span class="sy0">.</span>red <span class="kw1">FROM</span> rgb
&nbsp;
<span class="co1">-- Component reorganization, red-green-blue image becomes blue-green-image</span>
<span class="kw1">SELECT</span> <span class="br0">&#123;</span>rgb<span class="sy0">.</span>blue<span class="sy0">,</span> rgb<span class="sy0">.</span>green<span class="sy0">,</span> rgb<span class="sy0">.</span>red<span class="br0">&#125;</span> <span class="kw1">FROM</span> rgb</pre>
</dd></dl>

</div>

<h4 id="case_statement">Case statement</h4>
<div class="level4">

<p>
The rasdaman case statement serves to model n-fold case distinctions based on the SQL92 CASE statement
 which essentially represents a list of IF-THEN statements evaluated sequentially until either a condition 
 fires and delivers the corresponding result or the (mandatory) ELSE alternative is returned.
In the simplest form, the case statement looks at a variable and compares it to different alternatives for 
finding out what to deliver. The more involved version allows general predicates in the condition.
This functionality is implemented in rasdaman on both scalars (where it resembles SQL) and on MDD objects 
(where it establishes an induced operation). Due to the construction of the rasql syntax, the distinction between scalar 
and induced operations is not reflected explicitly in the syntax, making query writing simpler.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=18" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
<span class="kw1">CASE</span>
<span class="kw1">WHEN</span> booleanExp <span class="kw1">THEN</span> generalExp
<span class="sy0">...</span>
<span class="kw1">ELSE</span> generalExp
<span class="kw1">END</span>
&nbsp;
<span class="co1">-- Traffic light classification</span>
<span class="kw1">SELECT</span>
  <span class="kw1">CASE</span>
  <span class="kw1">WHEN</span> mr <span class="sy0">&gt;</span> <span class="nu0">150</span> <span class="kw1">THEN</span> <span class="br0">&#123;</span> 255c<span class="sy0">,</span>   0c<span class="sy0">,</span>   0c <span class="br0">&#125;</span>
  <span class="kw1">WHEN</span> mr <span class="sy0">&gt;</span> <span class="nu0">100</span> <span class="kw1">THEN</span> <span class="br0">&#123;</span>   0c<span class="sy0">,</span> 255c<span class="sy0">,</span>   0c <span class="br0">&#125;</span>
  <span class="kw1">ELSE</span>               <span class="br0">&#123;</span>   0c<span class="sy0">,</span>   0c<span class="sy0">,</span> 255c <span class="br0">&#125;</span>
  <span class="kw1">END</span>
<span class="kw1">FROM</span> mr</pre>
</dd></dl>

</div>

<h4 id="scale_statement">Scale Statement</h4>
<div class="level4">

<p>
Shorthand functions are available to scale multidimensional objects. They receive an array as parameter, 
plus a scale indicator. In the most common case, the scaling factor is an integer or float number. This factor then is 
applied to all dimensions homogeneously. For a scaling with individual factors for each dimension, a scaling vector can be 
supplied which, for each dimension, contains the resp. scale factor. Alternatively, a target domain can be specified to 
which the object gets scaled.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=19" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
scale<span class="br0">&#40;</span> mddExp<span class="sy0">,</span> intExp <span class="br0">&#41;</span>
scale<span class="br0">&#40;</span> mddExp<span class="sy0">,</span> floatExp <span class="br0">&#41;</span>
scale<span class="br0">&#40;</span> mddExp<span class="sy0">,</span> intVector <span class="br0">&#41;</span>
scale<span class="br0">&#40;</span> mddExp<span class="sy0">,</span> mintervalExp <span class="br0">&#41;</span>
&nbsp;
<span class="co1">-- Scaling downwards by a factor of 2</span>
<span class="kw1">SELECT</span> scale<span class="br0">&#40;</span> mr<span class="sy0">,</span> <span class="nu0">0.5</span> <span class="br0">&#41;</span> <span class="kw1">FROM</span> mr
&nbsp;
<span class="co1">-- Scaling by 4 on the first dimension 3 on the second</span>
<span class="kw1">SELECT</span> scale<span class="br0">&#40;</span> mr<span class="sy0">,</span> <span class="br0">&#91;</span> <span class="nu0">4</span><span class="sy0">,</span> <span class="nu0">3</span> <span class="br0">&#93;</span> <span class="kw1">FROM</span> mr
&nbsp;
<span class="co1">-- Scaling to an extent of 100 by 100</span>
<span class="kw1">SELECT</span> scale<span class="br0">&#40;</span> mr<span class="sy0">,</span> <span class="br0">&#91;</span> <span class="nu0">0</span>:<span class="nu0">99</span><span class="sy0">,</span> <span class="nu0">0</span>:<span class="nu0">99</span> <span class="br0">&#93;</span> <span class="br0">&#41;</span> <span class="kw1">FROM</span> mr</pre>
</dd></dl>

</div>

<h4 id="concat_statement">Concat Statement</h4>
<div class="level4">

<p>
Concatenation of two arrays “glues” together arrays by lining them up along an axis.
This can be achieved with a shorthand function, concat, which for convenience is implemented as an n-ary operator accepting 
an unlimited number of arrays. The operator takes the input arrays, lines them up along the concatenation dimension specified 
in the request, and outputs one result array. To this end, each input array is shifted to the appropriate position, with the 
first array’s position remaining unchanged; therefore, it is irrelevant whether array extents, along the concatenation dimension, 
are disjoint, overlapping, or containing each other.
The resulting array’s dimensionality is equal to the input array dimensionality.
The resulting array extent is the sum of all extents along the con­cat­en­ation dimension, and the extent of the input arrays in all other dimensions.
The resulting array cell type is the largest type covering all input array cell types (type coercion).
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=20" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
concat mddExp <span class="kw1">WITH</span> mddExp <span class="sy0">...</span> <span class="kw1">WITH</span> mddExp along <span class="kw1">INTEGER</span>
&nbsp;
<span class="co1">-- Concatenating two images along the first dimension</span>
<span class="kw1">SELECT</span> CONCAT mr <span class="kw1">WITH</span> mr ALONG <span class="nu0">0</span> <span class="kw1">FROM</span> mr
&nbsp;
<span class="co1">-- Arangement of 2 x 2 mr images</span>
<span class="kw1">SELECT</span> CONCAT <span class="br0">&#40;</span>CONCAT mr <span class="kw1">WITH</span> mr ALONG <span class="nu0">0</span><span class="br0">&#41;</span>
       <span class="kw1">WITH</span>   <span class="br0">&#40;</span>CONCAT mr <span class="kw1">WITH</span> mr ALONG <span class="nu0">0</span><span class="br0">&#41;</span>
       ALONG <span class="nu0">1</span>
<span class="kw1">FROM</span> mr</pre>
</dd></dl>

</div>

<h4 id="condensers">Condensers</h4>
<div class="level4">

<p>
Frequently summary information of some kind is required about some array, such as sum or average of cell values. 
To accomplish this, rasql provides the concept of condensers.
A condense operation (or short: condenser) takes an array and summarizes its values using a summarization function, 
either to a scalar value (e.g. computing the sum of all its cells), or to another array (e.g. summarizing a 3-D cube
into a 2-D image by adding all the horizontal slices that the cube is composed of).
A number of condensers is provided as rasql built-in function. For numeric arrays, add<em>cells() delivers the 
sum and avg</em>cells() the average of all cell values. Operators min<em>cells() and max</em>cells() return the minimum 
and maximum, resp., of all cell values in the argument array. For boolean arrays, the condenser count<em>cells() 
counts the cells containing true. Finally, the some</em>cells() operation returns true if at least one cell of the boolean 
MDD is true, all_cells() returns true if all of the MDD cells contain true as value. 
Please keep in mind that, depending on their nature, operations take a boolean, numeric, or arbitrary mddExp as argument.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=21" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
count_cells<span class="br0">&#40;</span> mddExp <span class="br0">&#41;</span>
add_cells<span class="br0">&#40;</span> mddExp <span class="br0">&#41;</span>
avg_cells<span class="br0">&#40;</span> mddExp <span class="br0">&#41;</span>
min_cells<span class="br0">&#40;</span> mddExp <span class="br0">&#41;</span>
max_cells<span class="br0">&#40;</span> mddExp <span class="br0">&#41;</span>
some_cells<span class="br0">&#40;</span> mddExp <span class="br0">&#41;</span>
all_cells<span class="br0">&#40;</span> mddExp <span class="br0">&#41;</span>
&nbsp;
<span class="co1">-- Returning all the images of collection mr where all pixel values are greater than 20</span>
<span class="kw1">SELECT</span> mr <span class="kw1">FROM</span> mr <span class="kw1">WHERE</span> all_cells<span class="br0">&#40;</span> mr <span class="sy0">&gt;</span> <span class="nu0">20</span> <span class="br0">&#41;</span>
&nbsp;
<span class="co1">-- Returning the average of a 1d collection</span>
<span class="kw1">SELECT</span> avg_cells<span class="br0">&#40;</span>m<span class="br0">&#41;</span> <span class="kw1">FROM</span> Values1D <span class="kw1">AS</span> m</pre>
</dd></dl>

</div>

<h4 id="general_array_condenser">General Array Condenser</h4>
<div class="level4">

<p>
All the condensers introduced above are special cases of a general principle which is represented by the general condenser statement.
The general condense operation consolidates cell values of a multidimensional array to a scalar value based on the condensing operation indicated. 
It iterates over a spatial domain while combining the result values of the cellExps through the condenserFunction indicated.
The general condense operation consolidates cell values of a multidimensional array to a scalar value or an array, based on the condensing operation indicated.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=22" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
CONDENSE condenserOp
<span class="kw1">OVER</span>     var <span class="kw1">IN</span> mintervalExp
<span class="kw1">WHERE</span>    booleanExp
<span class="kw1">USING</span>    cellExp
&nbsp;
<span class="co1">-- Returning a scalar representing the sum of all array values, multiplied by 2</span>
CONDENSE <span class="sy0">+</span>
<span class="kw1">OVER</span>     x <span class="kw1">IN</span> sdom<span class="br0">&#40;</span>a<span class="br0">&#41;</span>
<span class="kw1">USING</span>    <span class="nu0">2</span> <span class="sy0">*</span> a<span class="br0">&#91;</span> x <span class="br0">&#93;</span></pre>
</dd></dl>

</div>

<h4 id="general_array_constructor">General Array Constructor</h4>
<div class="level4">

<p>
The marray constructor allows to create n-dimensional arrays with their content defined by a general expression. This is useful: 
</p>
<ul>
<li class="level1"><div class="li">whenever the array is too large to be described as a constant (see Section 8.3) or </div>
</li>
<li class="level1"><div class="li">when the array&#039;s cell values are derived from some other source, e.g., for a histogram computation (see examples below).
<p>
First, the constructor allocates an array in the server with the spatial domain defined by the cross product of all mintervalExp. In the second step, 
the constructor iterates over the spatial domain defined as described, successively evaluating cellExp for each variable combination; 
the result value is assigned to the cell with the coordinate currently under evaluation. To this end, cellExp can contain arbitrary occurrences of var.
The cellExp must evaluate to a scalar (i.e., a single or composite value, as opposed to an array)
</p>
</div>
</li>
</ul>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=23" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
MARRAY var <span class="kw1">IN</span> mintervalExp <span class="br0">&#91;</span><span class="sy0">,</span> var <span class="kw1">IN</span> mintervalExp<span class="br0">&#93;</span>
<span class="kw1">VALUES</span> cellExp
&nbsp;
<span class="co1">-- Creating an array of domain [ 1:100, -50:200 ] with values 1</span>
<span class="kw1">SELECT</span> MARRAY x <span class="kw1">IN</span> <span class="br0">&#91;</span> <span class="nu0">1</span>:<span class="nu0">100</span><span class="sy0">,</span> <span class="sy0">-</span><span class="nu0">50</span>:<span class="nu0">200</span> <span class="br0">&#93;</span> <span class="kw1">VALUES</span> 1c
&nbsp;
<span class="co1">-- Creating an array of 256 X 101 with the value in each cell equal to the number of the row</span>
<span class="kw1">SELECT</span> MARRAY x <span class="kw1">IN</span> <span class="br0">&#91;</span> <span class="nu0">0</span>:<span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">0</span>:<span class="nu0">100</span> <span class="br0">&#93;</span> <span class="kw1">VALUES</span> x<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>
&nbsp;
<span class="co1">-- Creating a histogram of values ranging 0 to 9 in the mr array</span>
<span class="kw1">SELECT</span> MARRAY v <span class="kw1">IN</span> <span class="br0">&#91;</span> <span class="nu0">0</span> : <span class="nu0">9</span> <span class="br0">&#93;</span>
       <span class="kw1">VALUES</span> CONDENSE <span class="sy0">+</span>
              <span class="kw1">OVER</span>  x <span class="kw1">IN</span> sdom<span class="br0">&#40;</span>mr<span class="br0">&#41;</span>
              <span class="kw1">WHERE</span> mr<span class="br0">&#91;</span>x<span class="br0">&#93;</span> <span class="sy0">=</span> v<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>
              <span class="kw1">USING</span> <span class="nu0">1</span>
<span class="kw1">FROM</span> mr</pre>
</dd></dl>

</div>

<h4 id="data_format_conversion">Data format conversion</h4>
<div class="level4">

<p>
Without further indication, arrays are accepted and delivered in the client&#039;s main memory format, regardless of the client and server architecture. 
Sometimes, however, it is desirable to use some data exchange format - be it because some device provides a data stream to
be inserted in to the database in a particular format, or be it a Web application where particular output formats
have to be used to conform with the respective standards.
To this end, rasql provides two families of operations:
</p>
<ul>
<li class="level1"><div class="li">encode() for encoding an MDD in a particular data format repre­sent­at­ion; formally, the result will be a 1D byte array.</div>
</li>
<li class="level1"><div class="li">decode() for decoding a byte stream (such as a query input parameter during insert – see examples below) into an actionable MDD.</div>
</li>
</ul>

<p>
Implementation of these functions is based on GDAL and, hence, supports all GDAL formats.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=24" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
encode<span class="br0">&#40;</span> mddExp<span class="sy0">,</span> formatidentifier <span class="br0">&#41;</span>
encode<span class="br0">&#40;</span> mddExp<span class="sy0">,</span> formatidentifier<span class="sy0">,</span> formatParams <span class="br0">&#41;</span>
decode<span class="br0">&#40;</span> mddExp <span class="br0">&#41;</span>
decode<span class="br0">&#40;</span> mddExp<span class="sy0">,</span> formatParams <span class="br0">&#41;</span>
&nbsp;
<span class="co1">-- Insert a file in the database and let the decode function figure out the type</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> rgb <span class="kw1">VALUES</span> decode<span class="br0">&#40;</span> $1 <span class="br0">&#41;</span>
<span class="co1">-- Get it out as png</span>
<span class="kw1">SELECT</span> encode<span class="br0">&#40;</span> rgb<span class="sy0">,</span> “png” <span class="br0">&#41;</span> <span class="kw1">FROM</span> rgb</pre>
</dd></dl>

</div>
<!-- EDIT12 SECTION "Describing the output: the Select Clause" [10091-24579] -->
<h2 class="sectionedit13" id="creating_data">Creating data</h2>
<div class="level2">

</div>
<!-- EDIT13 SECTION "Creating data" [24580-24597] -->
<h3 class="sectionedit14" id="create_a_collection">Create a collection</h3>
<div class="level3">

<p>
The create collection statement is used to create a new, empty MDD collection by specifying its name and type. 
The type must exist in the database schema. There must not be another collection in this database bearing the name indicated.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=25" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
<span class="kw1">CREATE</span> COLLECTION collName typeName
&nbsp;
<span class="co1">-- Creating a collection called mr of type GreySet (i.e. 2 dimensions, char as base type)</span>
<span class="kw1">CREATE</span> COLLECTION mr GreySet</pre>
</dd></dl>

</div>
<!-- EDIT14 SECTION "Create a collection" [24598-25038] -->
<h3 class="sectionedit15" id="dropping_a_collection">Dropping a collection</h3>
<div class="level3">

<p>
A database collection can be deleted using the drop collection statement.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=26" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
<span class="kw1">DROP</span> COLLECTION collName 
<span class="co1">-- Example</span>
<span class="kw1">DROP</span> COLLECTION mr </pre>
</dd></dl>

</div>
<!-- EDIT15 SECTION "Dropping a collection" [25039-25217] -->
<h3 class="sectionedit16" id="inserting_an_array">Inserting an array</h3>
<div class="level3">

<p>
MDD objects can be inserted into database collections using the insert statement. 
The array to be inserted must conform with the collection&#039;s type definition concerning 
both cell type and spatial domain. One or more variable bounds in the collection&#039;s array 
type definition allow degrees of freedom for the array to be inserted. Hence, the resulting 
collection in this case can contain arrays with different spatial domain.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=27" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> collName
<span class="kw1">VALUES</span> mddExp
&nbsp;
<span class="co1">-- Inserting a black image to the mr1 collection</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> mr
<span class="kw1">VALUES</span> MARRAY x <span class="kw1">IN</span> <span class="br0">&#91;</span> <span class="nu0">0</span>:<span class="nu0">255</span><span class="sy0">,</span> <span class="nu0">0</span>:<span class="nu0">210</span> <span class="br0">&#93;</span>
       <span class="kw1">VALUES</span> 0c</pre>
</dd></dl>

</div>
<!-- EDIT16 SECTION "Inserting an array" [25218-25844] -->
<h3 class="sectionedit17" id="updating_an_array">Updating an array</h3>
<div class="level3">

<p>
The update statement allows to manipulate arrays of a collection. Which elements of the collection 
are affected can be determined with the where clause; by indicating a particular OID, single arrays can be updated.
An update can be complete in that the whole array is replaced or partial, i.e., only part of the database array is changed. 
Only those array cells are affected the spatial domain of the replacement expression on the right-hand side of the set clause.
Pixel locations are matched pairwise according to the arrays&#039; spatial domains. Therefore, to appropriately position the 
replacement array, application of the shift() function can be necessary.
As a rule, the spatial domain of the righthand side expression must be equal to or a subset of the database array&#039;s spatial domain.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=28" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
<span class="kw1">UPDATE</span> collName <span class="kw1">AS</span> collIterator
<span class="kw1">SET</span>    updateSpec ASSIGN mddExp
<span class="kw1">WHERE</span>  booleanExp
&nbsp;
<span class="co1">-- Make the mr picture a bit brighter in the 0:50;0:50 area</span>
<span class="kw1">UPDATE</span> mr <span class="kw1">AS</span> a
<span class="kw1">SET</span>    a<span class="br0">&#91;</span><span class="nu0">0</span>:<span class="nu0">50</span>;<span class="nu0">0</span>:<span class="nu0">50</span><span class="br0">&#93;</span> ASSING a<span class="br0">&#91;</span><span class="nu0">0</span>:<span class="nu0">50</span>; <span class="nu0">0</span>:<span class="nu0">50</span><span class="br0">&#93;</span> <span class="sy0">*</span> <span class="nu0">2</span></pre>
</dd></dl>

</div>
<!-- EDIT17 SECTION "Updating an array" [25845-26887] -->
<h3 class="sectionedit18" id="delete">Delete</h3>
<div class="level3">

<p>
Arrays are deleted from a database collection using the delete statement. The arrays to be 
removed from a collection can be further characterized in an optional where clause. If the condition
is omitted, all elements will be deleted so that the collection will be empty afterwards.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=29" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="co1">-- Syntax</span>
<span class="kw1">DELETE</span> <span class="kw1">FROM</span> collName <span class="br0">&#91;</span> <span class="kw1">AS</span> collIterator <span class="br0">&#93;</span>
<span class="br0">&#91;</span> <span class="kw1">WHERE</span>  booleanExp <span class="br0">&#93;</span>
&nbsp;
<span class="co1">-- Deleting the array from collection containing too many black pixels</span>
<span class="kw1">DELETE</span> <span class="kw1">FROM</span> mr <span class="kw1">AS</span> a
<span class="kw1">WHERE</span> all_cells<span class="br0">&#40;</span> a <span class="sy0">&lt;</span> <span class="nu0">30</span> <span class="br0">&#41;</span></pre>
</dd></dl>

<p>
## Misc
</p>

<p>
To check the list of collection that are available in the database you can select
the special RAS_COLLECTIONNAMES collection.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=30" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="kw1">SELECT</span> m <span class="kw1">FROM</span> RAS_COLLECTIONNAMES <span class="kw1">AS</span> m</pre>
</dd></dl>

<p>
To find out the type, tiling and other metadata information about each collection,
we can use the dbinfo operation.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=31" title="Download Snippet" class="mediafile mf_sql">snippet.sql</a></dt>
<dd><pre class="code file sql"><span class="kw1">SELECT</span> dbinfo<span class="br0">&#40;</span>m<span class="br0">&#41;</span> <span class="kw1">FROM</span> mr <span class="kw1">AS</span> m</pre>
</dd></dl>

</div>
<!-- EDIT18 SECTION "Delete" [26888-27734] -->
<h1 class="sectionedit19" id="ogc_web_services">OGC Web Services</h1>
<div class="level1">

</div>
<!-- EDIT19 SECTION "OGC Web Services" [27735-27755] -->
<h2 class="sectionedit20" id="coverage_model">Coverage Model</h2>
<div class="level2">

<p>
The term “coverage” refers to any data representation that assigns values directly to spatial position:
a coverage is a function from a spatial, temporal or spatiotemporal domain to an attribute range, as
depicted in Figure 1.3. Coverages can include rasters, triangulated irregular networks, point clouds
and polygon coverages, and they are the prevailing data structures in a number of application areas,
such as remote sensing, meteorology and mapping of bathymetry, elevation, soil and vegetation.
</p>

<p>
<a href="/dokuwiki/lib/exe/fetch.php?tok=e84e33&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fcoverage_concept_model.png" class="media" title="http://rasdaman.flanche.net/img/coverage_concept_model.png"><img src="/dokuwiki/lib/exe/fetch.php?tok=e84e33&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fcoverage_concept_model.png" class="media" title="Coverage Idea" alt="Coverage Idea" /></a>
</p>

<p>
A coverage domain consists of a collection of direct positions in a coordinate space that may be
defined in terms of up to three spatial dimensions as well as one (or more, Baumann et al. 2012)
temporal dimensions. A coverage range is the set of feature attribute values associated by a function
with the elements of the domain.
</p>

<p>
In this document we will consider the so-called GMLCOV coverage model, which
is an extension to the core GML coverage model and which provides richer coverages by means of
two additional elements:
</p>
<ul>
<li class="level1"><div class="li">the rangeType element, which describes the coverage’s range set data structure.</div>
</li>
<li class="level1"><div class="li">the metadata element, to define concrete metadata structures and their semantics in extensions
or application profiles.</div>
</li>
</ul>

<p>
<a href="/dokuwiki/lib/exe/fetch.php?tok=922d71&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fcoverage_uml.png" class="media" title="http://rasdaman.flanche.net/img/coverage_uml.png"><img src="/dokuwiki/lib/exe/fetch.php?tok=922d71&amp;media=http%3A%2F%2Frasdaman.flanche.net%2Fimg%2Fcoverage_uml.png" class="media" title="Coverage UML" alt="Coverage UML" /></a>
</p>

<p>
Indeed, a range value often consists of one or more fields (in remote sensing also referred to as
bands or channels), however, much more general definitions are possible. The rangeType additional
element thus describes range value structure based on the comprehensive SWE Common DataRecord
model. A UML model of the GMLCOV coverage structure is reported in the figure below.
</p>

<p>
So how are rasters represented in the coverage model? There are mainly two kinds of coverage that
relate to rasdaman more closely:
</p>

<p>
<em>RectifiedGridCoverage</em> Coverage whose geometry is represented by a rectified grid. A grid is
(geo)rectified when the transformation between grid coordinates and the external CRS is
affine, like shifts, rotations and shearings; we also call them rectilinear aligned, or rectilinear
non-aligned grids.
</p>

<p>
<em>ReferenceableGridCoverage</em> Coverage whose geometry is represented by a referenceable grid. A
grid is (geo)referenceable when there is a non-affine transformation between the grid coordinates
and the external CRS; this can be the case of rectilinear irreguarly-spaced grids, or
curvilinear (“warped”) grids.
</p>

<p>
Indeed, while we traditionally think of a grid as a classical aligned and orthogonal set of rectilinear
lines (as in the example of Figure 1.5), the formal definition says it is a network of curves
(grid lines) intersecting in a systematic way, forming grid points — at the intersections —
and grid cells — at the interstices. This means that grid lines need not be straight and orthogonal.
In GML, there is a third type of grid which acts as the internal representation of any
(geo)rectified or referenceable geometric grid, simply called Grid: in this case we have no external 
CRS coordinates, but integer indexing of the grid points along the orthogonal grid lines.
Grids are strictly related to the concept of marrays in rasdaman, which indeed are the internal
representation of the geo-coverages exposed to the WCS service.
</p>

<p>
rasdaman supports the storage of rectified grids whose grid lines (or in this case grid axes) are aligned
with the axes of the external cartesian coordinate system. However, when stacking rectified grids
together in a same marray for building a spatial cube, or time series of images and cubes, irregular
spacing is permitted so that the overall coverage becomes referenceable (rectilinear, aligned and irregularly spaced).
</p>

<p>
Time is embedded in the geometry of a coverage by i) encoding time information through a temporal
CRS which defines the epcoh time and the time step and ii) composing it with the usual geospatial
projections.
A last important point of discussion concerns the sample space of grid points (which must not be
confused with the grid cells between the grid interstices). The feature attribute values associated
with a grid point represent characteristics of the real world measured within a small space surrounding
a sample point: the sample space. The representation of a sample space in a CRS is
called footprint. When dealing with gridded data, it is usually assumed (like we do) that the sample
cells equally divided among the sample points so that they are represented by a second set of cells
congruent to the grid cells but offset so that each has a grid point at its center.
</p>

<p>
For more on coverages and grids, you can refer to the cited OGC normatives, 
for our usage of grids when building spatio-temporal coverages. In the next section we will
describe the main features of the de-facto OGC standard for web services of coverages: the Web
Coverage Service.
</p>

</div>
<!-- EDIT20 SECTION "Coverage Model" [27756-32742] -->
<h2 class="sectionedit21" id="web_coverage_service">Web Coverage Service</h2>
<div class="level2">

<p>
The reference OGC standard for publishing multi-dimensional coverages is the Web Coverage Service
(WCS, <a href="http://www.opengeospatial.org/standards/wcs" class="urlextern" target="blanc" title="http://www.opengeospatial.org/standards/wcs" rel="nofollow noopener">http://www.opengeospatial.org/standards/wcs</a>).
In the recent years, WCS has been completely overhauled to fulfill a more modular structure based
on a core set of minimum requirements that a WCS-compliant service must adhere to, plus a plethora
of extensions for additional service features, protocol bindings, format extensions and application
profiles. This refactoring ended up in version 2.0 of the interface standard, the current version being
2.0.1.
</p>

<p>
WCS 2.0 offers several advantages over previous versions, like support for general n-D raster data
and non-raster coverage types. It is also harmonized with GML and Sensor Web Enablement (SWE)
models.
</p>

<p>
What are these cornerstone WCS functionalities then? As specifed in the WCS core standard, there
are three kinds of request that can be sent to a WCS service:
</p>

<p>
<em>GetCapabilities</em> - this operation allows a client to request information about the server’s capabilities
and as well summary information on the offered coverages.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=32" title="Download Snippet" class="mediafile mf_http">snippet.http</a></dt>
<dd><pre class="code file http">GET http://ows.rasdaman.org/rasdaman/ows?service=WCS&amp;version=2.0.1&amp;request=GetCapabilities
``` 
&nbsp;
*DescribeCoverage* - this operation allows a client to request a much more detailed description on
the selected coverages, in particular their domain and range characteristics.
GET http://ows.rasdaman.org/rasdaman/ows?service=WCS&amp;version=2.0.1&amp;request=DescribeCoverage&amp;coverageId=AvgLandTemp</pre>
</dd></dl>

<p>
<em>GetCoverage</em> - this operation allows a client to request a coverage data, usually expetided together
with some of its metadata, depending on the selected output format
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=33" title="Download Snippet" class="mediafile mf_http">snippet.http</a></dt>
<dd><pre class="code file http">GET http://ows.rasdaman.org/rasdaman/ows?service=WCS&amp;version=2.0.1&amp;request=GetCoverage&amp;coverageId=AvgLandTemp</pre>
</dd></dl>

<p>
As said before, many extensions can be plugged in a WCS service to add more interoperability and
functionalities. The most interesting (recently accepted) extensions are the following:
</p>
<ul>
<li class="level1"><div class="li"><em>Range Subsetting</em> — this extensions enables the selection of one or more
attributes defined in the range of a coverage (e.g. extract arbitrary bands from an hyperspectral
dataset).</div>
</li>
<li class="level1"><div class="li"><em>Scaling</em> — this extension makes it possible to upscale and downscale coverages via WCS requests.</div>
</li>
<li class="level1"><div class="li"><em>Interpolation</em> — the companion of the Scaling extension, it allows to
declare the interpolation methods used when scaling (or when reprojecting, see CRS extension)
and of course it allows to select a preferred interpolation in a GetCoverage request</div>
</li>
<li class="level1"><div class="li"><em>Processing</em> - the gate to the WCPS query language: this extension lets the user write arbitrary 
linear algebra expressions to be applied on coverages served by the WCS service.</div>
</li>
<li class="level1"><div class="li"><em>Transaction</em> - this extension allows users to ingest and update coverages through the normal
 web service</div>
</li>
<li class="level1"><div class="li"><em>CRS Reprojection</em> — this extension allows reprojection of both input WCS subsets — especially 
useful to let you subset a projected coverage via latitude/longitude degrees — and output coverage maps.
In the next chapter you will see many of these extensions in action. </div>
</li>
</ul>

</div>
<!-- EDIT21 SECTION "Web Coverage Service" [32743-35861] -->
<h2 class="sectionedit22" id="web_coverage_processing_service">Web Coverage Processing Service</h2>
<div class="level2">

<p>
As mentioned in the beginning of this chapter, there is an other important standard related
to coverages: the Web Coverage Processing Service (WCPS, <a href="http://www.opengeospatial.org/standards/wcps" class="urlextern" target="blanc" title="http://www.opengeospatial.org/standards/wcps" rel="nofollow noopener">http://www.opengeospatial.org/standards/wcps</a>).
</p>

<p>
The general structure of a WCPS requests is based on xQuery: the so-called “processing expression”
is applied on each of the coverages specified in the given list (<em>coverageList</em>), given that the
optional boolean expression returns true when evaluated on the coverage. Each coverage is referred
to in the query by the correspondent identifier <em>variableName</em> in the processing expression.
A processing expression branches down to a miscellanea of possible sub-expressions that are able to 
return either scalars (scalar expressions) or encoded marrays (coverage expressions) and operate on both the 
data and metadata of a coverage.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=34" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for myCoverage in ( coverage1, coverage2 )
where avg(myCoverage) &gt; 10
return avg(myCoverage)</pre>
</dd></dl>

</div>
<!-- EDIT22 SECTION "Web Coverage Processing Service" [35862-36837] -->
<h2 class="sectionedit23" id="web_map_service">Web Map Service</h2>
<div class="level2">

<p>
Web Map Service (WMS) is a standard protocol for serving (over the Internet) georeferenced map images 
which a map server generates using data from a GIS database.
</p>

<p>
WMS specifies a number of different request types, two of which are required by any WMS server:
</p>

<p>
<em>GetCapabilities</em> - returns parameters about the WMS (such as map image format and WMS version compatibility) 
 and the available layers (map bounding box, coordinate reference systems, <abbr title="Uniform Resource Identifier">URI</abbr> of the data and whether the layer is mostly opaque or not)
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=35" title="Download Snippet" class="mediafile mf_http">snippet.http</a></dt>
<dd><pre class="code file http">GET http://ows.rasdaman.org/rasdaman/ows?service=WMS&amp;version=1.3.0&amp;request=GetCapabilities
``` 
&nbsp;
*GetMap* - returns a map image. Parameters include: width and height of the map, coordinate reference system, rendering style, image format
GET http://example.org/rasdaman/ows?service=WMS&amp;version=1.3.0&amp;request=GetMap
    &amp;layers=MyLayer
    &amp;bbox=618885.0,3228195.0,690885.0,3300195.0
    &amp;crs=EPSG:32615
    &amp;width=600
    &amp;height=600
    &amp;format=image/png</pre>
</dd></dl>

</div>
<!-- EDIT23 SECTION "Web Map Service" [36838-37843] -->
<h3 class="sectionedit24" id="style_creation">Style creation</h3>
<div class="level3">

<p>
Styles can be created for layers using rasql query fragments. This allows users to define several visualization 
options for the same dataset in a flexible way. Examples of such options would be color classification, NDVI detection etc. 
The following HTTP request will create a style with the name, abstract and layer provided in the KVP parameters below
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=36" title="Download Snippet" class="mediafile mf_http">snippet.http</a></dt>
<dd><pre class="code file http">GET http://example.org/rasdaman/ows?service=WMS&amp;version=1.3.0&amp;request=InsertStyle
    &amp;name=FireMarkup
    &amp;layer=dessert_area
    &amp;abstract=This style marks the areas where fires are in progress with the color red
    &amp;rasqlTransformFragment=case $Iterator when ($Iterator + 2) &gt; 200 then {255, 0, 0} else $Iterator</pre>
</dd></dl>

</div>
<!-- EDIT24 SECTION "Style creation" [37844-38549] -->
<h2 class="sectionedit25" id="wcst_import">WCST Import</h2>
<div class="level2">

<p>
WCSTImport is a utility application in the rasdaman software suite that allows importing of georeferenced datasets 
into a WCS service supporting the Transaction Extension. 
</p>

<p>
Its primary functionality is allowing the ingestion of archives of georeferenced files. This utility introduces two concepts:
</p>
<ul>
<li class="level1"><div class="li"><em>Recipe</em> - a recipe is a class implementing the BaseRecipe that based on a set of parameters (ingredients) 
 can import a set of files into WCS forming a well defined structure (image, regular timeseries, irregular timeseries etc)</div>
</li>
<li class="level1"><div class="li"><em>Ingredients</em> - an ingredients file is a json file containing a set of parameters that define 
 how the recipe should behave (e.g. the WCS endpoint, the CRS resolver etc are all ingredients)</div>
</li>
</ul>

<p>
As of now, three recipes are in the codebase:
</p>
<ul>
<li class="level1"><div class="li">Mosaic Map</div>
</li>
<li class="level1"><div class="li">Regular Timeseries</div>
</li>
<li class="level1"><div class="li">Irregular Timeseries
For each one of them there is an ingredients file under the ingredients folder, which contain an example of what parameters 
are available. </div>
</li>
</ul>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=37" title="Download Snippet" class="mediafile mf_json">snippet.json</a></dt>
<dd><pre class="code file json">{
  &quot;config&quot;: {
//The endpoint of the WCS service with the WCST extension enabled
    &quot;service_url&quot;: &quot;http://localhost:8080/rasdaman/ows&quot;,
//A directory where to store the intermediate results
    &quot;tmp_directory&quot;: &quot;/tmp/&quot;,
//A link to the crs resolver to be used, best to use one that is frequently updated
    &quot;crs_resolver&quot;: &quot;http://opengis.net/def/&quot;,
//A default 2D crs to be used when the given files do not have one
    &quot;default_crs&quot;: &quot;http://opengis.net/def/OGC/0/Index2D&quot;,
//If set to true, it will print the WCST requests and will not execute them. To actually execute them set it to false
    &quot;mock&quot;: true,
//If set to true, the process will not require any user confirmation, use with care, useful for production environments when deployment is automated
    &quot;automated&quot;: false
  },
  &quot;input&quot;: {
//The name of the coverage, if the coverage already exists, we will update it with the new files
    &quot;coverage_id&quot;: &quot;MyCoverage&quot;,
    &quot;paths&quot;: [
//Any normal full (or relative to the ingredients file) path or regex that would work with the ls command. You can add as many as you wish, separated by commas
      &quot;/var/data/*&quot;
    ]
  },
  &quot;recipe&quot;: {
//The name of the recipe
    &quot;name&quot;: &quot;map_mosaic&quot;,
    &quot;options&quot;: {
//The tiling that you want to be done in rasdaman
      &quot;tiling&quot;: &quot;ALIGNED [0:500, 0:500]&quot;
    }
  }
}</pre>
</dd></dl>

</div>
<!-- EDIT25 SECTION "WCST Import" [38550-40887] -->
<h1 class="sectionedit26" id="exercises">Exercises</h1>
<div class="level1">

</div>
<!-- EDIT26 SECTION "Exercises" [40888-40900] -->
<h2 class="sectionedit27" id="exercise_1">Exercise 1</h2>
<div class="level2">

<p>
In this exercise we will start by storing and querying a single rectified 2D image in rasdaman. After
describing and analyzing the dataset, we will use WCSTImport to ingest it, then we will show how to use WCS and WCPS to play with it 
The Landsat program offers the longest continuous global record of the Earth’s surface since 1972.
It has moderate spatial resolution, can be used to many research area like disaster recovery, flood,
city growth, etc. As a joint program of NASA and USGS, the Landsat archive is free available to
everyone on everywhere on the Earth. This sample RGB image — which we will call Multiband —
has been downloaded from USGS (<a href="https://landsat.usgs.gov/" class="urlextern" target="blanc" title="https://landsat.usgs.gov/" rel="nofollow noopener">https://landsat.usgs.gov/</a>) and was taken by the Enhanced
Thematic Mapper (ETM) sensor onboard Landsat7. It covers part of the North of Germany and
Nord Sea, and was acquired from 2000 to 2001.
</p>

</div>
<!-- EDIT27 SECTION "Exercise 1" [40901-41770] -->
<h3 class="sectionedit28" id="ingestion">Ingestion</h3>
<div class="level3">

<p>
Before importing the image, we need to know about its metadata: Listing 6 shows some relevant
information about the structure and geometry of this dataset.
We can see that this is a 4657 × 4923 32N-UTM projected (EPSG:32632) RGB image, with
resolution around 57 meters on both easting and northing directions, and origin in the upper-left
corner.
Let’s see now how to achieve a correct insertion of this image into rasdaman.
</p>

<p>
First let&#039;s create a new directory and copy the map mosaic ingredients from the WCSTImport
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=38" title="Download Snippet" class="mediafile mf_bash">snippet.bash</a></dt>
<dd><pre class="code file bash"><span class="kw3">cd</span> <span class="sy0">/</span>tmp <span class="sy0">&amp;&amp;</span> <span class="kw2">mkdir</span> landsat <span class="sy0">&amp;&amp;</span> <span class="kw3">cd</span> landsat;
<span class="kw2">cp</span> <span class="sy0">/</span>opt<span class="sy0">/</span>rasdaman<span class="sy0">/</span>share<span class="sy0">/</span>wcst_import<span class="sy0">/</span>ingredients<span class="sy0">/</span>map_mosaic.json landsat.json</pre>
</dd></dl>

<p>
Now we should edit this file and name the coverage to our liking and specify the path to our files:
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=39" title="Download Snippet" class="mediafile mf_json">snippet.json</a></dt>
<dd><pre class="code file json">...
    &quot;coverage_id&quot;: &quot;LandsatMultiBand&quot;,
    &quot;paths&quot;: [
      &quot;/var/geodata/LandsatMultiBand/*.tif&quot;
    ]
...</pre>
</dd></dl>

<p>
And now we can import into our WCS service by calling wcst_import:
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=40" title="Download Snippet" class="mediafile mf_bash">snippet.bash</a></dt>
<dd><pre class="code file bash">wcst_import.sh landsat.json</pre>
</dd></dl>

</div>
<!-- EDIT28 SECTION "Ingestion" [41771-42768] -->
<h3 class="sectionedit29" id="selection">Selection</h3>
<div class="level3">

<p>
We can first verify that the image was correctly imported into WCS by issuing a DescribeCoverage
request. 
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=41" title="Download Snippet" class="mediafile mf_http">snippet.http</a></dt>
<dd><pre class="code file http">GET http://ows.rasdaman.org/rasdaman/ows?service=WCS&amp;version=2.0.1&amp;request=DescribeCoverage&amp;coverageId=LansdatMultiBand</pre>
</dd></dl>

<p>
Now we can start sending some GetCoverage request to our server.
As a first basic example, we might just want to retrieve a spatial cutout of the coverage by using
subset KV-pair. As you see, we were able to specify our region of interest by specifying intervals on separate CRS
axes. The labels that we used to identify a subset dimension are strictly equal to the labels
(gml:axisAbbrev) declared in the definition of the CRS.
When a single direct position is specified in a subset, then the coordinate is usually referred to as
slicing position, and the subset is called a slice; otherwise the subsetting operation is also called
trimming: 
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=42" title="Download Snippet" class="mediafile mf_http">snippet.http</a></dt>
<dd><pre class="code file http">http://ows.rasdaman.org/rasdaman/ows?
service=WCS&amp;
version=2.0.1&amp;
request=GetCoverage&amp;
coverageId=LandsatMultiBand&amp;
subset=E(300000 ,370000)&amp;
subset=N(5800000 ,5850000)&amp;
format=image / tiff</pre>
</dd></dl>

<p>
As a second example, we can now use the Range Subsetting WCS extension to extract a single band
from the RGB coverage. This can be achieved by adding a rangesubset KV-pair in the request.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=43" title="Download Snippet" class="mediafile mf_http">snippet.http</a></dt>
<dd><pre class="code file http">http://ows.rasdaman.org/rasdaman/ows?
service =WCS&amp;
version = 2.0.1&amp;
request = GetCoverage&amp;
coverageId = LandsatMultiBand&amp;
subset =E (300000 ,370000)&amp;
subset =N (5800000 ,5850000)&amp;
rangesubset =b1&amp;
format = &quot;image / tiff&quot;</pre>
</dd></dl>

</div>
<!-- EDIT29 SECTION "Selection" [42769-44294] -->
<h3 class="sectionedit30" id="processing">Processing</h3>
<div class="level3">

<p>
While WCS is much about raw data access, you can go beyond simple read operations with the
WCPS query language.
Spectral indexes like NDVI and the like are usually the very first example of things that WCPS can
do quite easily. Range subsetting is natively available in WCPS by means of a dot ‘.’ notation;
trimmings and slicings are — of course — available too, but beware that the coordinates separator
for a trim subset is here the colon ‘:’ (and not the comma ‘,’ as in a WCS subset).
In the following example we retrieve a simple spectral index given by the average of
the blue and the red bands.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=44" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for cov in ( LandsatMultiBand )
return encode (
(( cov.b3+ cov .b1 )/2)[ E (490000:492000) , N (6000000)] ,
&quot;csv&quot;)</pre>
</dd></dl>

<p>
An other useful application of WCPS is to build false-color images from a multi- or hyper-spectral
image. Although our sample image has only three channels, we can show how to build the proper
query by, for instance, changing the order of the RGB channels:
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=45" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for cov in ( Multiband )
return encode ({
red : cov.b3;
green : cov .b1;
blue : cov .b2
}[E (300000:370000) , N (5800000:5850000)] ,
&quot; tiff &quot;)</pre>
</dd></dl>

<p>
By using the proposed RGB WCPS constructor you can also specify a pixel-wise transparency by
assigning an additional ‘alpha’ channel to some other coverage field or maybe some predefined mask
coverage you can add in the input coverage list. Try it for yourself!
</p>

</div>
<!-- EDIT30 SECTION "Processing" [44295-45737] -->
<h2 class="sectionedit31" id="exercise_2">Exercise 2</h2>
<div class="level2">

<p>
In this exercise we will create and query a coverage representing a 3D cube of average monthly temperatures measured durying the day,
over the entire globe,
from February 2002 until June 2015. The dataset consists of several tiff images, each containing average temperatures corresponding
to 1 timestamp. The temperature values are floating point numbers and represent Celsius degrees. The spatial resolution of
the dataset is 0.1 x 0.1 degrees / value.
</p>

</div>
<!-- EDIT31 SECTION "Exercise 2" [45738-46207] -->
<h3 class="sectionedit32" id="ingestion1">Ingestion</h3>
<div class="level3">

<p>
The dataset is available for download <a href="http://flanche.net/geodata/AverageTemperatureFloat.tar.gz/" class="urlextern" target="blanc" title="http://flanche.net/geodata/AverageTemperatureFloat.tar.gz/" rel="nofollow noopener">here</a>. It contains an ingredient
file called avg-temp.json which can be adjusted to match non-default local configurations. In its current form, the ingredient
creates a coverage named “AvgLandTemp”, of type RefereceableGridCoverage. The CRS and axes information for Latitude and Longitude
are read from the files, while for the time axis the AnsiDate CRS is used, and the timestamp corresponding to each file is
read from the file name. The cube will internally be split in tiles of size 1000 x 1000 x 20 values.
</p>

<p>
We can import the dataset by navigating in the bin directory of our rasdaman installation, and executing:
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=46" title="Download Snippet" class="mediafile mf_bash">snippet.bash</a></dt>
<dd><pre class="code file bash">wcst_import.sh avg-temp.json</pre>
</dd></dl>

</div>
<!-- EDIT32 SECTION "Ingestion" [46208-46984] -->
<h3 class="sectionedit33" id="selection1">Selection</h3>
<div class="level3">

<p>
We can first verify that the image was correctly imported into WCS by issuing a DescribeCoverage
request.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=47" title="Download Snippet" class="mediafile mf_http">snippet.http</a></dt>
<dd><pre class="code file http">GET http://ows.rasdaman.org/rasdaman/ows?
service=WCS&amp;
version=2.0.1&amp;
request=DescribeCoverage&amp;
coverageId=AvgLandTemp</pre>
</dd></dl>

<p>
Further, we can request a subset of the coverage using a WCS GetCoverage request. For example, we can find out which was the
average temperature measured during the day around Matera, in June 2015, using the following request:
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=48" title="Download Snippet" class="mediafile mf_http">snippet.http</a></dt>
<dd><pre class="code file http">GET http://ows.rasdaman.org/rasdaman/ows?
service=WCS&amp;
version=2.0.1&amp;
request=GetCoverage&amp;
coverageId=AvgLandTemp&amp;
subset=Lat(40.6)&amp;
subset=Long(16.6)&amp;
subset=ansi(&quot;2015-06&quot;)</pre>
</dd></dl>

</div>
<!-- EDIT33 SECTION "Selection" [46985-47652] -->
<h3 class="sectionedit34" id="processing1">Processing</h3>
<div class="level3">

<p>
We can use WCPS to do to on-the-fly processing on our cube. A list of example questions that the cube can answer via WCPS
is presented below.
</p>

<p>
What was the average monthly temperature measured during the day, around Matera, in June 2015? (achievs the same result as the WCS request above)
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=49" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp )
return encode(
c[Lat(40.6), Long(16.6), ansi(&quot;2014-07&quot;)],
&quot;csv&quot;)</pre>
</dd></dl>

<p>
How did the average monthly temperature measured during the day evolve in Matera, from January 2014 until December 2014?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=50" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp )
return encode(c[Lat(40.6), Long(16.6), ansi(&quot;2014-01&quot;:&quot;2014-12&quot;)],
&quot;csv&quot;)</pre>
</dd></dl>

<p>
How did the average monthly temperature measured during the day evolve in Matera, from January 2014 until December 2014, in Kelvin?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=51" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp )
return encode(c[Lat(40.6), Long(16.6), ansi(&quot;2014-01&quot;:&quot;2014-12&quot;)] + 273.15,
&quot;csv&quot;)</pre>
</dd></dl>

<p>
How did the map of world temperatures look like in July 2014?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=52" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp )
return encode(
c[ansi(&quot;2014-07&quot;)],
&quot;png&quot;)</pre>
</dd></dl>

<p>
What was the minimum average monthly temperature measured during the day, in Matera, in the interval Januray 2001 - December 2010?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=53" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in (AvgLandTemp)
return encode(min(c[Lat(40.6), Long(16.6), ansi(&quot;2001-01&quot;:&quot;2010-12&quot;)]),
&quot;csv&quot;)</pre>
</dd></dl>

<p>
What was the maximum average monthly temperature measured during the day, in Matera, in the interval Januray 2001 - December 2010?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=54" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in (AvgLandTemp)
return encode(max(c[Lat(40.6), Long(16.6), ansi(&quot;2001-01&quot;:&quot;2010-12&quot;)]),
&quot;csv&quot;)</pre>
</dd></dl>

<p>
What was the average temperature measured during the day, in Matera, in the interval Januray 2001 - December 2010?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=55" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in (AvgLandTemp)
return encode(avg(c[Lat(40.6), Long(16.6), ansi(&quot;2001-01&quot;:&quot;2010-12&quot;)]),
&quot;csv&quot;)</pre>
</dd></dl>

<p>
In how many months in 2014 was the average temperature during the day in Matera more than 20?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=56" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in (AvgLandTemp)
return encode(count(c[Lat(40.6), Long(16.6), ansi(&quot;2014-01&quot;:&quot;2014-12&quot;)] &gt; 20),
&quot;csv&quot;)</pre>
</dd></dl>

<p>
How did a recolored map of average temperatures look like in Europe in June 2015? Use blue for temperatures less than 18, yellow for
 temperatures between 18 and 23, orange for temperatures between 23 and 30 and red for temperatures above 30.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=57" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp ) return encode(switch
 case c[ansi(&quot;2015-06&quot;), Lat(35:75), Long(-20:40)] = 99999
 return {red: 255; green: 255; blue: 255}
 case 18 &gt; c[ansi(&quot;2015-06&quot;), Lat(35:75), Long(-20:40)]
  return {red: 0; green: 0; blue: 255}
 case 23 &gt; c[ansi(&quot;2015-06&quot;), Lat(35:75), Long(-20:40)]
 return {red: 255; green: 255; blue: 0}
 case 30 &gt; c[ansi(&quot;2015-06&quot;), Lat(35:75), Long(-20:40)]
 return {red: 255; green: 140; blue: 0}
 default return {red: 255; green: 0; blue: 0}  , &quot;png&quot;)</pre>
</dd></dl>

<p>
What did the temperature evolve in Oslo in 2014, on a logarithmic scale?
</p>

<p>
We can observe that in some months the temperature was negative, so outside of the definition domain of the logarithm function:
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=58" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp ) return encode(
c[Lat(59.9), Long(10.7), ansi(&quot;2014-01&quot;:&quot;2014-12&quot;)], &quot;csv&quot;)</pre>
</dd></dl>

<p>
We can use the sitch statement to filter these values out:
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=59" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp ) return encode(
switch case c[Lat(59.9), Long(10.7), ansi(&quot;2014-01&quot;:&quot;2014-12&quot;)] &gt; 0
  return log(c[Lat(59.9), Long(10.7), ansi(&quot;2014-01&quot;:&quot;2014-12&quot;)])
  default return 0, &quot;csv&quot;)</pre>
</dd></dl>

</div>
<!-- EDIT34 SECTION "Processing" [47653-50971] -->
<h2 class="sectionedit35" id="exercise_3">Exercise 3</h2>
<div class="level2">

<p>
This exercise focuses on the coverage constructor and coverage condenser operations. The datasets used are the ones from
the previous exercises.
</p>

<p>
Create a new 1d Coverage, with domain 0:100, with cell value i at index i.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=60" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp ) return encode(
coverage myCoverage over $p x(0:100) values $p,
&quot;csv&quot;)</pre>
</dd></dl>

<p>
How does the July temperature evolve in Matera, from 2001 to 2011?
</p>

<p>
For answering this question we must first understand that the coverage constructor iterator iterates over grid coordinates, not geo coordinates. So if we have an axis with 10 grid points, but 100 degrees,
to iterate through all the points we must iterate from 0 to 10, not from 0 to 100.
Now we want to select the temperature in July in each year and for this we must find the grid points to iterate through. What we want to do, if you mentally visualise the cube with the temperature, is to set the iterator on the month of July in 2001, then jump from 12 slices (corresponding to 12 months), at every step.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=61" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp ) return encode(
coverage myCoverage over $p year(1:10) values
c[Lat(40.6), Long(16.6), ansi($p*12 + 5)],
&quot;csv&quot;)</pre>
</dd></dl>

<p>
How about June?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=62" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp ) return encode(
coverage myCoverage over $p year(1:10) values
c[Lat(40.6), Long(16.6), ansi($p*12 + 4)],
&quot;csv&quot;)</pre>
</dd></dl>

<p>
How about 2005 to 2010, January?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=63" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp ) return encode(
coverage myCoverage over $p year(5:10) values
c[Lat(40.6), Long(16.6), ansi($p*12 - 1)],
&quot;csv&quot;)</pre>
</dd></dl>

<p>
General condenser: How many data points are there between January and Dec 2001?
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=64" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp ) return encode(
condense +
over $t ansi(imageCrsDomain(c[ansi(&quot;2001-01&quot;:&quot;2001-12&quot;)], ansi))
using 1, &quot;csv&quot;)</pre>
</dd></dl>

<p>
Select a 2d image where every pixel is the average temperature at its corresponding Lat,Lon for the entire world in 2001.
</p>
<dl class="file">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wiki:rasdaman:rasdahome&amp;codeblock=65" title="Download Snippet" class="mediafile mf_wcps">snippet.wcps</a></dt>
<dd><pre class="code file wcps">for c in ( AvgLandTemp ) return encode(
condense +
over $t ansi(imageCrsDomain(c[ansi(&quot;2001-01&quot;:&quot;2001-12&quot;)], ansi))
using c[ansi($t)], &quot;png&quot;)</pre>
</dd></dl>

</div>
<!-- EDIT35 SECTION "Exercise 3" [50972-] -->