
<h1 class="sectionedit1" id="grappolo_a_supercomputer_in_a_superbox">GRAPPOLO a supercomputer in a superbox</h1>
<div class="level1">

<p>
<strong>Grappolo is a project designed to teach cluster computation.</strong><br/>

We have prototyped and developed a portable micro cluster computer (replicating the functioning of the biggest cluster computer facility in the southwest UK ). This tool is similar to the Raspberry pi cluster developed at Southampton University but is aimed towards teaching Geographic Information Systems methods rather than raw computation, it is very low cost ( ~ £130), portable and a perfect replica of an operating system running on a true high performance cluster computer.<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:20151201-20151201-wt4a9277.jpg" class="media" title="wiki:20151201-20151201-wt4a9277.jpg"><img src="/dokuwiki/lib/exe/fetch.php?w=400&amp;tok=4caf24&amp;media=wiki:20151201-20151201-wt4a9277.jpg" class="media" alt="" width="400" /></a><a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:20151201-20151201-wt4a9294.jpg" class="media" title="wiki:20151201-20151201-wt4a9294.jpg"><img src="/dokuwiki/lib/exe/fetch.php?w=400&amp;tok=2622dc&amp;media=wiki:20151201-20151201-wt4a9294.jpg" class="media" alt="" width="400" /></a><a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:20151201-20151201-wt4a9300.jpg" class="media" title="wiki:20151201-20151201-wt4a9300.jpg"><img src="/dokuwiki/lib/exe/fetch.php?w=400&amp;tok=fd1540&amp;media=wiki:20151201-20151201-wt4a9300.jpg" class="media" alt="" width="400" /></a>
<br/>

</p>
<div class="noteimportant">This is still an an ongoing project! Not finished yet. We are working on the <abbr title="Operating System">OS</abbr>/ software installation and we will update this page as soon as grappolo will work smoothly fine. 

</div>
<p>
<a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:img_20150620_120734512-animation.gif" class="media" title="wiki:img_20150620_120734512-animation.gif"><img src="/dokuwiki/lib/exe/fetch.php?media=wiki:img_20150620_120734512-animation.gif" class="media" alt="" /></a>
</p>

<p>
<a href="https://www.raspberrypi.org/magpi-issues/MagPi46.pdf" class="urlextern" target="blanc" title="https://www.raspberrypi.org/magpi-issues/MagPi46.pdf" rel="nofollow noopener"> Grappolo in press</a> check out the official raspberry pi magazine (issue 46 - 2016) documenting a showcase use of Grappolo.<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:magpi46.png" class="media" title="wiki:magpi46.png"><img src="/dokuwiki/lib/exe/fetch.php?w=300&amp;tok=d1fd36&amp;media=wiki:magpi46.png" class="media" alt="" width="300" /></a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;GRAPPOLO a supercomputer in a superbox&quot;,&quot;hid&quot;:&quot;grappolo_a_supercomputer_in_a_superbox&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-1204&quot;} -->
<h2 class="sectionedit2" id="team">Team</h2>
<div class="level2">

<p>
Project team and collaborators:<br/>

</p>
<ul>
<li class="level1"><div class="li"> Stefano Casalegno, University of Exeter (Project leader)</div>
</li>
<li class="level1"><div class="li"> Andrew Cowley, University of Exeter (brainstorming - software / <abbr title="Operating System">OS</abbr> installation)</div>
</li>
<li class="level1"><div class="li"> Oliver Hatfield, Falmouth University (box design and construction)</div>
</li>
<li class="level1"><div class="li"> Andy Smith, Falmouth University  (software ideas support / cabling)</div>
</li>
<li class="level1"><div class="li"> Victoria O&#039;Brien, Spatial Ecology (software <abbr title="Operating System">OS</abbr> / installation)</div>
</li>
<li class="level1"><div class="li"> Giuseppe Amatulli, Yale University (software applications for teaching)</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Team&quot;,&quot;hid&quot;:&quot;team&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;1205-1688&quot;} -->
<h2 class="sectionedit3" id="goals">Goals</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Build a micro cluster compurer with the same operating system and software of a real HPC (High Performance Computer) for simulating big data processing.</div>
</li>
<li class="level1"><div class="li"> Make it as small as possible so that grappolo can fligh in your hand lugage toghether with your laptop, book, toothbrush and newspaper.</div>
</li>
<li class="level1"><div class="li"> Make it awsome so when you test supercomputing in a pub it will attract people&#039;s attention and they might want to learn more about it.</div>
</li>
<li class="level1"><div class="li"> Make it low cost and open source so that is potentially replicable in schools or by any V2 open minded citizens willing to learn new amazing stuff.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Goals&quot;,&quot;hid&quot;:&quot;goals&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;1689-2299&quot;} -->
<h2 class="sectionedit4" id="list_of_material">List of material</h2>
<div class="level2">

<p>
We used 3 Raspberry pi&#039;s running a light distribution of Linux operating system. Below you can find codings for software installation and hardware assembling. <br/>

For the best box ever conceived in the history of boxes….<br/>

We used an awesome reddish acrylic Perspex and sawed an alluminium squared box section 15&times;15.<br/>

<strong>Shopping list:</strong>
</p>
<ul>
<li class="level1"><div class="li"> 3 raspberry pi model 2 - 1GB RAM 4CPU : <a href="http://cpc.farnell.com/" class="urlextern" target="blanc" title="http://cpc.farnell.com/" rel="nofollow noopener"> : 89.78 £</a></div>
</li>
<li class="level1"><div class="li"> 3 sd card 8GB : <a href="http://www.ebay.co.uk" class="urlextern" target="blanc" title="http://www.ebay.co.uk" rel="nofollow noopener"> : 2.75 £ </a></div>
</li>
<li class="level1"><div class="li"> 1 USB wifi dongle <a href="http://www.maplin.co.uk/p/maplin-single-band-n150-nano-usb-network-adapter-a71lb" class="urlextern" target="blanc" title="http://www.maplin.co.uk/p/maplin-single-band-n150-nano-usb-network-adapter-a71lb" rel="nofollow noopener">  : 9.99 £</a></div>
</li>
<li class="level1"><div class="li"> Ethernet switch (5 port 10/100M Switch) usb powered <a href="http://www.ebay.co.uk/itm/Fast-Ethernet-Efficient-Network-Switch-5-Ports-10-100Mbps-for-Desktop-New-/271843904311?" class="urlextern" target="blanc" title="http://www.ebay.co.uk/itm/Fast-Ethernet-Efficient-Network-Switch-5-Ports-10-100Mbps-for-Desktop-New-/271843904311?" rel="nofollow noopener"> : 5.63£ </a></div>
</li>
<li class="level1"><div class="li"> 3 usb short cables <a href="http://www.ebay.co.uk/itm/Micro-USB-8-20CM-Short-Braided-Data-Sync-Cable-Cord-For-Samsung-Galaxy-S3-S4-/400723720012?pt=LH_DefaultDomain_3&amp;var=670268246685&amp;hash=item5d4cfeb74c" class="urlextern" target="blanc" title="http://www.ebay.co.uk/itm/Micro-USB-8-20CM-Short-Braided-Data-Sync-Cable-Cord-For-Samsung-Galaxy-S3-S4-/400723720012?pt=LH_DefaultDomain_3&amp;var=670268246685&amp;hash=item5d4cfeb74c" rel="nofollow noopener"> 2.97 £</a></div>
</li>
<li class="level1"><div class="li"> 3 ethernet cables  : 0 £ recycled </div>
</li>
<li class="level1"><div class="li"> Hexagonal spacer female/male RS Stock No. 105-8202 <a href="http://uk.rs-online.com/" class="urlextern" target="blanc" title="http://uk.rs-online.com/" rel="nofollow noopener"> : 5.69 £</a></div>
</li>
<li class="level1"><div class="li"> 4 port USB 5V 2.1A / 1A Power supply <a href="http://www.dx.com/p/universal-travel-usb-ac-powered-4-port-hub-with-eu-plug-white-2-round-pin-plug-132107#.VXB-w7w57yx" class="urlextern" target="blanc" title="http://www.dx.com/p/universal-travel-usb-ac-powered-4-port-hub-with-eu-plug-white-2-round-pin-plug-132107#.VXB-w7w57yx" rel="nofollow noopener"> : 6.32 £</a></div>
</li>
<li class="level1"><div class="li"> Aluminium box <a href="http://www.ebay.co.uk/itm/Aluminium-Square-Box-Section-x-12-pre-cut-Sizes-x-8-Lengths-/360941104777?pt=LH_DefaultDomain_3&amp;var=&amp;hash=item5409c42e89" class="urlextern" target="blanc" title="http://www.ebay.co.uk/itm/Aluminium-Square-Box-Section-x-12-pre-cut-Sizes-x-8-Lengths-/360941104777?pt=LH_DefaultDomain_3&amp;var=&amp;hash=item5409c42e89" rel="nofollow noopener"> 8.25 £</a></div>
</li>
<li class="level1"><div class="li"> Perspex <a href="http://www.penrynplasticsacrylic.co.uk/product_info.php?id=124" class="urlextern" target="blanc" title="http://www.penrynplasticsacrylic.co.uk/product_info.php?id=124" rel="nofollow noopener"> 5.37 £</a></div>
</li>
</ul>

<p>
<strong>TOTAL HARDWARE COSTS : 136.75 </strong> shipping and VAT included
</p>

<p>
beside hardware costs, to assemble and install grappolo require much time and effort. If you like us to assemble a grappolo for you, please <a href="mailto:&#x73;&#x74;&#x65;&#x66;&#x61;&#x6e;&#x6f;&#x40;&#x63;&#x61;&#x73;&#x61;&#x6c;&#x65;&#x67;&#x6e;&#x6f;&#x2e;&#x6e;&#x65;&#x74;" class="mail" title="&#x73;&#x74;&#x65;&#x66;&#x61;&#x6e;&#x6f;&#x40;&#x63;&#x61;&#x73;&#x61;&#x6c;&#x65;&#x67;&#x6e;&#x6f;&#x2e;&#x6e;&#x65;&#x74;">contact us</a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;List of material&quot;,&quot;hid&quot;:&quot;list_of_material&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;2300-4144&quot;} -->
<h1 class="sectionedit5" id="template_operating_system">Template operating system</h1>
<div class="level1">

<p>
Grappolo consist of 3 raspberry pi we will call them
</p>
<ol>
<li class="level1"><div class="li"> master (Grid schedler)</div>
</li>
<li class="level1"><div class="li"> node1  (slave or processing node1)</div>
</li>
<li class="level1"><div class="li"> node2  (slave or processing node2)</div>
</li>
</ol>

<p>
Each of these raspi share a template operating system which we will prepare in the following step. Successively,  we will clone the template operating system and in a <a href="/dokuwiki/doku.php?id=wiki:grappolo_ii" class="wikilink1" title="wiki:grappolo_ii"> next step </a> we will guide you through the customization of clones into different master and processing nodes.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Template operating system&quot;,&quot;hid&quot;:&quot;template_operating_system&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;4145-4641&quot;} -->
<h2 class="sectionedit6" id="installing_os">Installing OS</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> <a href="http://elinux.org/RPi_SD_cards" class="urlextern" target="blanc" title="http://elinux.org/RPi_SD_cards" rel="nofollow noopener">Check </a> that your SD card is not trash </div>
</li>
<li class="level1"><div class="li"> <a href="https://www.raspberrypi.org/downloads/" class="urlextern" target="blanc" title="https://www.raspberrypi.org/downloads/" rel="nofollow noopener"> Download </a> Linux Debian derived operating system: Raspbian Jessie 4.1, released Nov. 2015</div>
</li>
<li class="level1"><div class="li">  <a href="http://elinux.org/RPi_Easy_SD_Card_Setup#Using_the_Linux_command_line" class="urlextern" target="blanc" title="http://elinux.org/RPi_Easy_SD_Card_Setup#Using_the_Linux_command_line" rel="nofollow noopener"> and set up the SD card </a></div>
</li>
<li class="level1"><div class="li"> <a href="http://elinux.org/RPi_Resize_Flash_Partitions#Manually_resizing_the_SD_card_on_Linux" class="urlextern" target="blanc" title="http://elinux.org/RPi_Resize_Flash_Partitions#Manually_resizing_the_SD_card_on_Linux" rel="nofollow noopener"> Resizing the SD card </a> using parted </div>
</li>
</ol>
<pre class="code">  df -h # find out for a partition that matches the roughly 1.something GB 
  # in our case is sdb2
  umount /dev/sdb2
  sudo parted /dev/sdb
  # enter in parted 
  $ sudo parted /dev/sdd
  (parted) unit chs
  (parted) print
  (parted) rm 2
  (parted) mkpart primary 8,40,32 866,80,9 # begin and end of the partition depend on your sd card size
  (parted) quit</pre>
<ol>
<li class="level1"><div class="li"> Plug Ethernet cable from raspi 1 to home router </div>
</li>
<li class="level1"><div class="li"> Insert SD in raspberry, </div>
</li>
<li class="level1"><div class="li"> Power raspi 1 </div>
</li>
<li class="level1"><div class="li"> Open a terminal using a computer connected to the home router (via wireless or cable)</div>
</li>
</ol>

</div>

<h4 id="check_your_ip_adress">check your ip adress</h4>
<div class="level4">
<pre class="code">  ifconfig | grep &quot;inet addr&quot;
        inet addr:127.0.0.1  Mask:255.0.0.0
        inet addr:192.168.1.68  Bcast:192.168.1.255  Mask:255.255.255.0</pre>

</div>

<h4 id="search_for_the_ip_adress_of_the_raspberry_pi">search for the ip adress of the raspberry pi</h4>
<div class="level4">
<pre class="code">  sudo nmap -sP 192.168.1.1-255
  Starting Nmap 5.21 ( http://nmap.org ) at 2015-05-23 15:24 BST
     Nmap scan report for Unknown-28-32-c5-ae-4e-19.home (192.168.1.64)
     Host is up (0.0029s latency).
     MAC Address: 28:32:C5:AE:4E:19 (Unknown)
     Nmap scan report for ace.home (192.168.1.68)
     Host is up.
     Nmap scan report for Unknown-e8-06-88-9c-0f-66.home (192.168.1.70)
     Host is up (0.10s latency).
     MAC Address: E8:06:88:9C:0F:66 (Unknown)
     Nmap scan report for raspberrypi.home (192.168.1.80)
     Host is up (0.015s latency).
     MAC Address: B8:27:EB:65:6C:FF (Unknown)
     Nmap scan report for BThomehub.home (192.168.1.254)
     Host is up (0.013s latency).
     MAC Address: D0:84:B0:D7:AC:30 (Unknown)
     Nmap done: 255 IP addresses (5 hosts up) scanned in 5.44 seconds</pre>

<p>
You are now ready to connect to raspi1 via ssh, default login and pass are pi, raspberry. 
</p>
<pre class="code">  ssh pi@192.168.1.80
  yes</pre>

<p>
you are loged in the raspberry pi. Next steps are easy to do with the raspi-config <abbr title="Graphical User Interface">GUI</abbr>:
</p>
<pre class="code">  sudo raspi-config</pre>
<ol>
<li class="level1"><div class="li"> Change password to masterpi</div>
</li>
<li class="level1"><div class="li"> Set time zone : internationalisation –&gt; london</div>
</li>
<li class="level1"><div class="li"> Set the memory split and change the value to 16 (in advanced options)</div>
</li>
<li class="level1"><div class="li"> change hostname “ raspberry” to “grappolo” (in advanced options)</div>
</li>
</ol>
<pre class="code">  sudo apt-get update
  sudo apt-get upgrade
  sudo reboot
  ssh pi@192.168.1.80
  </pre>

<p>
Add user admin (administartor) and remove user pi.<br/>

Password for user “admin” = “admin” <em>…old pass for pi was masterpi</em>
</p>
<pre class="code bash"><span class="kw2">sudo</span> useradd <span class="re5">-m</span> admin
<span class="kw2">sudo</span> <span class="kw2">passwd</span> admin <span class="co0">#admin</span>
<span class="kw2">sudo</span> <span class="kw2">nano</span> <span class="sy0">/</span>etc<span class="sy0">/</span>group
<span class="co0"># Go through the file adding ,ad to the end of all of the groups that pi is in.  eg:   &quot; adm:x:4:pi,admin  &quot;</span>
<span class="kw3">exit</span>
<span class="kw2">ssh</span> <span class="re5">-X</span> admin<span class="sy0">@</span>192.168.1.80
<span class="kw2">chsh</span> <span class="re5">-s</span> <span class="sy0">/</span>bin<span class="sy0">/</span><span class="kw2">bash</span> <span class="co0">#default terminal is bash</span>
<span class="kw2">sudo</span> userdel pi</pre>

</div>

<h4 id="set_connections_configurations">Set connections configurations</h4>
<div class="level4">

</div>

<h5 id="connect_the_grappolo_cluster_to_the_outside_world">Connect the grappolo cluster to the outside world</h5>
<div class="level5">

<p>
We will generate a dynamic ip address to connect to the head node “grappolo” to the outside world. This will be be physically done ether via wifi dongle or via a usb-ethernet adapter depending on our working environment. <br/>

</p>

</div>

<h5 id="connect_nodes_within_the_grappolo_cluster">Connect nodes within the grappolo cluster</h5>
<div class="level5">

<p>
Within the cluster we create a static ip network using the Ethernet ports of each of the 3 raspi.
The /etc/network/interface configuration file determine the above parameters. We need to insert the name of the wifi network and password wile connecting using the wifi dongle or we need to uncomment the two <em> eth1</em> lines if we are using an ethernet connection from the cluster to the external world. The grappolo configuration using the wifi dongle looks like this:
</p>
<pre class="code bash">pi<span class="sy0">@</span>grappolo ~ $ <span class="kw2">cat</span> <span class="sy0">/</span>etc<span class="sy0">/</span>network<span class="sy0">/</span>interfaces
auto lo
iface lo inet loopback
&nbsp;
auto eth0
iface eth0 inet static
address 10.141.255.254
netmask 255.255.0.0
network 10.141.0.0
broadcast 10.141.255.255
<span class="co0">#gateway 10.141.255.254</span>
&nbsp;
<span class="co0"># To connect via usb ethernet adaptor instead of wifi, uncomment the next two lines</span>
<span class="co0">#auto eth1</span>
<span class="co0">#iface eth1 inet dhcp</span>
&nbsp;
allow-hotplug wlan0
auto wlan0
&nbsp;
iface wlan0 inet dhcp
<span class="co0">#wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf</span>
       wpa-ssid <span class="st0">&quot;NETWORK_NAME&quot;</span>
       wpa-psk <span class="st0">&quot;NETWORK_PASSWORD&quot;</span></pre>

<p>
Next we need to reboot and log in via the usb dongle or ethernet-usb:
</p>
<pre class="code">     sudo reboot
     ssh -X pi@192.168.1.81
     </pre>

<p>
And the resulting connection configuration is the following
</p>
<pre class="code bash">pi<span class="sy0">@</span>grappolo ~ $ <span class="kw2">ifconfig</span>
eth0      Link encap:Ethernet  HWaddr b8:<span class="nu0">27</span>:eb:b6:4b:a5  
          inet addr:10.141.255.254  Bcast:10.141.255.255  Mask:255.255.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:<span class="nu0">1500</span>  Metric:<span class="nu0">1</span>
          RX packets:<span class="nu0">69</span> errors:<span class="nu0">0</span> dropped:<span class="nu0">0</span> overruns:<span class="nu0">0</span> frame:<span class="nu0">0</span>
          TX packets:<span class="nu0">23</span> errors:<span class="nu0">0</span> dropped:<span class="nu0">0</span> overruns:<span class="nu0">0</span> carrier:<span class="nu0">0</span>
          collisions:<span class="nu0">0</span> txqueuelen:<span class="nu0">1000</span> 
          RX bytes:<span class="nu0">9100</span> <span class="br0">&#40;</span><span class="nu0">8.8</span> KiB<span class="br0">&#41;</span>  TX bytes:<span class="nu0">3231</span> <span class="br0">&#40;</span><span class="nu0">3.1</span> KiB<span class="br0">&#41;</span>
&nbsp;
lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:<span class="nu0">65536</span>  Metric:<span class="nu0">1</span>
          RX packets:<span class="nu0">72</span> errors:<span class="nu0">0</span> dropped:<span class="nu0">0</span> overruns:<span class="nu0">0</span> frame:<span class="nu0">0</span>
          TX packets:<span class="nu0">72</span> errors:<span class="nu0">0</span> dropped:<span class="nu0">0</span> overruns:<span class="nu0">0</span> carrier:<span class="nu0">0</span>
          collisions:<span class="nu0">0</span> txqueuelen:<span class="nu0">0</span> 
          RX bytes:<span class="nu0">6288</span> <span class="br0">&#40;</span><span class="nu0">6.1</span> KiB<span class="br0">&#41;</span>  TX bytes:<span class="nu0">6288</span> <span class="br0">&#40;</span><span class="nu0">6.1</span> KiB<span class="br0">&#41;</span>
&nbsp;
wlan0     Link encap:Ethernet  HWaddr 00:<span class="nu0">87</span>:<span class="nu0">31</span>:<span class="nu0">13</span>:<span class="nu0">37</span>:aa  
          inet addr:192.168.1.81  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:<span class="nu0">1500</span>  Metric:<span class="nu0">1</span>
          RX packets:<span class="nu0">455</span> errors:<span class="nu0">0</span> dropped:<span class="nu0">0</span> overruns:<span class="nu0">0</span> frame:<span class="nu0">0</span>
          TX packets:<span class="nu0">221</span> errors:<span class="nu0">0</span> dropped:<span class="nu0">0</span> overruns:<span class="nu0">0</span> carrier:<span class="nu0">0</span>
          collisions:<span class="nu0">0</span> txqueuelen:<span class="nu0">1000</span> 
          RX bytes:<span class="nu0">104200</span> <span class="br0">&#40;</span><span class="nu0">101.7</span> KiB<span class="br0">&#41;</span>  TX bytes:<span class="nu0">29337</span> <span class="br0">&#40;</span><span class="nu0">28.6</span> KiB<span class="br0">&#41;</span></pre>

<p>
To read your configuration information (address; netmask; network; broadcast; gateway) you can type:
</p>
<pre class="code">   pi@grappolo ~ $ ifconfig | grep -A1 eth0 | tail -1  
        inet addr:10.141.255.254  Bcast:10.141.255.255  Mask:255.255.0.0</pre>
<pre class="code">   pi@grappolo ~ $ netstat -nr | tail -2 | awk &#039;{if(NR==1)print &quot;Gateway &quot;$2 \\ 
                   else print &quot;Destination &quot;$1 }&#039; 
             Gateway 0.0.0.0
             Destination 192.168.1.0</pre>

<p>
<del>          Gateway 192.168.1.254
          Destination 192.168.1.0</del>
We use the 10.141.255 internal static ip address to avoid any inconvenient ip-adress overlap between the dhcp extrnal and static internal cluster network configurations.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Installing OS&quot;,&quot;hid&quot;:&quot;installing_os&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;4642-11246&quot;} -->
<h2 class="sectionedit7" id="install_software">Install Software</h2>
<div class="level2">

<p>
Grappolo is specifically designed to process spatio-temporal data nonetheless could provide excellent teaching platform for cluster processing other data sources not geographically related. We start to install geographic information systems and geospatial libraries and tools:
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Install Software&quot;,&quot;hid&quot;:&quot;install_software&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:7,&quot;range&quot;:&quot;11247-11553&quot;} -->
<h3 class="sectionedit8" id="data_processing_software">Data processing software</h3>
<div class="level3">

<p>
<strong> PROG.4 - Gdal/Ogr - GRASS </strong> <br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:grasslogo_vector_small.png" class="media" title="wiki:grasslogo_vector_small.png"><img src="/dokuwiki/lib/exe/fetch.php?w=100&amp;tok=419280&amp;media=wiki:grasslogo_vector_small.png" class="media" alt="" width="100" /></a><a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:logo_gdal.png" class="media" title="wiki:logo_gdal.png"><img src="/dokuwiki/lib/exe/fetch.php?w=100&amp;tok=4a18c0&amp;media=wiki:logo_gdal.png" class="media" alt="" width="100" /></a> <a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:proj4_logo.jpeg" class="media" title="wiki:proj4_logo.jpeg"><img src="/dokuwiki/lib/exe/fetch.php?w=150&amp;tok=a92353&amp;media=wiki:proj4_logo.jpeg" class="media" alt="" width="150" /></a>
</p>
<pre class="code bash"><span class="kw2">sudo</span> <span class="kw2">apt-get install</span> grass grass-doc grass-dev</pre>

<p>
<strong> Openforis Geospatial toolkit </strong> <br/>

<a href="http://www.openforis.org/tools/geospatial-toolkit" class="media" target="blanc" title="http://www.openforis.org/tools/geospatial-toolkit" rel="nofollow noopener"><img src="/dokuwiki/lib/exe/fetch.php?w=300&amp;tok=bd439c&amp;media=wiki:openforis_logo_210x60.png" class="media" alt="" width="300" /></a>
</p>
<pre class="code bash"><span class="kw2">sudo</span> <span class="kw2">apt-get install</span> <span class="kw2">gcc</span> <span class="kw2">g++</span> gdal-bin libgdal1-dev \\
  libgsl0-dev libgsl0ldbl libproj-dev python-gdal \\
  python-scipy python-tk python-qt4
<span class="co0"># some of the above are already installed</span>
<span class="kw2">wget</span> foris.fao.org<span class="sy0">/</span>static<span class="sy0">/</span>geospatialtoolkit<span class="sy0">/</span>releases<span class="sy0">/</span>OpenForisToolkit.run
<span class="kw2">sudo</span> <span class="kw2">chmod</span> u+x OpenForisToolkit.run
<span class="kw2">sudo</span> .<span class="sy0">/</span>OpenForisToolkit.run</pre>

<p>
<strong> PKtools - Processing Kernel for geospatial data </strong> <br/>

<a href="http://example.com" class="media" target="blanc" title="http://example.com" rel="nofollow noopener"><img src="/dokuwiki/lib/exe/fetch.php?w=70&amp;tok=da44d3&amp;media=wiki:pktools_logo.png" class="media" alt="" width="70" /></a>
</p>
<pre class="code bash"><span class="kw2">sudo</span> <span class="kw2">apt-get install</span> pktools</pre>

<p>
<strong> AWK, Python and friends </strong> <br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:logo_whitew_awk.png" class="media" title="wiki:logo_whitew_awk.png"><img src="/dokuwiki/lib/exe/fetch.php?w=100&amp;tok=779f62&amp;media=wiki:logo_whitew_awk.png" class="media" alt="" width="100" /></a><a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:python_logo.jpeg" class="media" title="wiki:python_logo.jpeg"><img src="/dokuwiki/lib/exe/fetch.php?w=80&amp;tok=485aab&amp;media=wiki:python_logo.jpeg" class="media" title="https://www.python.org" alt="https://www.python.org" width="80" /></a><a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:scipy_logo.jpeg" class="media" title="wiki:scipy_logo.jpeg"><img src="/dokuwiki/lib/exe/fetch.php?w=100&amp;tok=34b967&amp;media=wiki:scipy_logo.jpeg" class="media" title="www.scipy.org/" alt="www.scipy.org/" width="100" /></a><a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:numpy_logo.jpeg" class="media" title="wiki:numpy_logo.jpeg"><img src="/dokuwiki/lib/exe/fetch.php?w=200&amp;tok=731f9c&amp;media=wiki:numpy_logo.jpeg" class="media" title="www.numpy.org/" alt="www.numpy.org/" width="200" /></a><br/>

AWK, Python, Numpy and Scipy are installed as default Raspian-Jessie <abbr title="Operating System">OS</abbr> and as dependencies form the previous libraries.<br/>

</p>

<p>
<strong> R language and environment for statistical computing</strong><br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:rlogo-5.png" class="media" title="wiki:rlogo-5.png"><img src="/dokuwiki/lib/exe/fetch.php?w=100&amp;tok=4e104f&amp;media=wiki:rlogo-5.png" class="media" alt="" width="100" /></a>
</p>
<pre class="code bash"><span class="kw2">wget</span> http:<span class="sy0">//</span>cran.rstudio.com<span class="sy0">/</span>src<span class="sy0">/</span>base<span class="sy0">/</span>R-<span class="nu0">3</span><span class="sy0">/</span>R-3.1.2.tar.gz
<span class="kw2">mkdir</span> R_HOME
<span class="kw2">mv</span> R-3.1.2.tar.gz R_HOME<span class="sy0">/</span>
<span class="kw3">cd</span> R_HOME<span class="sy0">/</span>
<span class="kw2">tar</span> zxvf R-3.1.2.tar.gz
<span class="kw3">cd</span> R-3.1.2<span class="sy0">/</span>
<span class="kw2">sudo</span> <span class="kw2">apt-get install</span> gfortran libreadline6-dev libx11-dev libxt-dev
.<span class="sy0">/</span>configure
<span class="kw2">make</span>
<span class="kw2">sudo</span> <span class="kw2">make</span> <span class="kw2">install</span>
<span class="co0"># get a coup of tea and start watching Battleship Potemkin you have an hour to wait</span></pre>

<p>
Further we install R library for spatial data analysis and machine learning modelling using the CRAN Task View: <a href="http://cran.r-project.org/web/views/Spatial.html" class="urlextern" target="blanc" title="http://cran.r-project.org/web/views/Spatial.html" rel="nofollow noopener"> Analysis of Spatial Data</a> as suggested in <a href="http://cran.r-project.org/web/views/" class="urlextern" target="blanc" title="http://cran.r-project.org/web/views/" rel="nofollow noopener">http://cran.r-project.org/web/views/</a>
</p>
<pre class="code">   sudo su
   R
   install.packages(pkgs=&quot;ctv&quot;, dependencies=TRUE)
   # we selected Bristol UK as CRAN repository
   library(&quot;ctv&quot;)
   update.views(&quot;Spatial&quot;)
   update.views(&quot;MachineLearning&quot;)</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Data processing software&quot;,&quot;hid&quot;:&quot;data_processing_software&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:8,&quot;range&quot;:&quot;11554-13662&quot;} -->
<h3 class="sectionedit9" id="other_useful_tools">Other useful tools</h3>
<div class="level3">

<p>
<strong> Emacs editor</strong> <br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wiki%3Agrappolo&amp;media=wiki:logo_emacs.png" class="media" title="wiki:logo_emacs.png"><img src="/dokuwiki/lib/exe/fetch.php?w=100&amp;tok=a6ea25&amp;media=wiki:logo_emacs.png" class="media" alt="" width="100" /></a><br/>

… for people like Giuseppe or Pieter refusing to type on any other black squared thing with a cursor!
</p>
<pre class="code bash"><span class="kw2">sudo</span> <span class="kw2">apt-get install</span> emacs</pre>

<p>
I like the bash <a href="http://ss64.com/bash/locate.html" class="urlextern" target="blanc" title="http://ss64.com/bash/locate.html" rel="nofollow noopener"> locate</a> command.
</p>
<pre class="code bash"><span class="kw2">sudo</span> <span class="kw2">apt-get install</span> mlocate
<span class="kw2">sudo</span> <span class="kw2">updatedb</span></pre>

<p>
Insatall <strong>screen</strong> to eventually launch several process in different teminals and leave them open on the background. <a href="http://ss64.com/bash/screen.html" class="urlextern" target="blanc" title="http://ss64.com/bash/screen.html" rel="nofollow noopener"> Screen</a> : Multiplex a physical terminal between several processes (typically interactive shells)
</p>
<pre class="code">  sudo apt-get install screen
  </pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Other useful tools&quot;,&quot;hid&quot;:&quot;other_useful_tools&quot;,&quot;codeblockOffset&quot;:7,&quot;secid&quot;:9,&quot;range&quot;:&quot;13663-14322&quot;} -->
<h2 class="sectionedit10" id="setting_up_an_nfs_server">Setting Up an NFS Server</h2>
<div class="level2">

<p>
The default installation of Grid Engine assumes that the executables corresponding to the sge command are found on a $SGE_ROOT directory sitting on a shared filesystem accessible by all hosts in the cluster <a href="http://arc.liv.ac.uk/SGE/howto/nfsreduce.html" class="urlextern" target="blanc" title="http://arc.liv.ac.uk/SGE/howto/nfsreduce.html" rel="nofollow noopener"> more info here</a>.<br/>

For this purpose, we use a Network File System (NFS) which is a distributed file system allowing a user on a client computer to access files over a network. We are going to create and share the /usr/local/apps folder between master and slave nodes and be able to install the Grid engine executables and configuration files in the slave nodes. We first install the nfs server in the master:
</p>
<pre class="code bash"><span class="kw2">sudo</span> <span class="kw2">apt-get install</span> nfs-kernel-server portmap nfs-common
<span class="kw2">sudo</span> <span class="kw2">nano</span> <span class="sy0">/</span>etc<span class="sy0">/</span>exports
<span class="co0"># append  &quot;/usr/local/apps 10.141.0.0/16(rw,sync)&quot; to the end of /etc/exports file</span>
&nbsp;
<span class="kw2">sudo</span> service rpcbind restart
<span class="kw2">sudo</span> <span class="sy0">/</span>etc<span class="sy0">/</span>init.d<span class="sy0">/</span>nfs-kernel-server restart</pre>
<div class="notetip"> <strong> /etc/init.d/nfs-kernel-server status </strong>to check nfs service status

</div><div class="notewarning"> In previous versions of Debian (ex.: Weezy) it was applied the concept of <em>Run levels</em> now replaced by <em>target units</em>. If using Raspbian Weezy, the run level need to be switched from 2 to 3 
</div><pre class="code">runlevel # to check your default run level</pre>

<p>
Follow the following steps if you need to switch into appropriate <a href="http://www.tldp.org/LDP/sag/html/run-levels-intro.html" class="urlextern" target="blanc" title="http://www.tldp.org/LDP/sag/html/run-levels-intro.html" rel="nofollow noopener"> Linux Run Level</a> (e.g. A run level is a state of init and the whole system that defines what system services are operating.) 
Raspi by default is set to a state of run level 2 - Local Multiuser with Networking but without network service (like NFS) - and we want to switch to run level 3 - Full Multiuser with Networking. Once we are in level 3 we can use the two <em>update-rc.d</em> command below to allow automatic starting of the nfs servers at reboot.
</p>
<pre class="code bash"><span class="kw2">sudo</span> <span class="kw2">nano</span> <span class="sy0">/</span>etc<span class="sy0">/</span>inittab
<span class="co0"># to set default runlevel = 3</span>
<span class="co0"># change id:2:initdefault with: id:3.... it should look like this:</span>
<span class="co0"># The default runlevel.</span>
<span class="co0"># id:3:initdefault:</span>
<span class="kw2">sudo</span> update-rc.d nfs-kernel-server defaults
<span class="kw2">sudo</span> update-rc.d rpcbind defaults
<span class="kw2">sudo</span> <span class="kw2">apt-get install</span> nfs-kernel-server portmap nfs-common
<span class="kw2">sudo</span> <span class="kw2">nano</span> <span class="sy0">/</span>etc<span class="sy0">/</span>exports <span class="co0"># add the export as above</span>
<span class="kw2">sudo</span> service portmap start
<span class="kw2">sudo</span> reboot</pre>
<div class="notewarning"> if NFS is still not running at reboot try the lines below 
</div><pre class="code bash"><span class="kw2">sudo</span> <span class="kw2">apt-get purge</span> rpcbind
<span class="kw2">sudo</span> <span class="kw2">apt-get install</span> nfs-kernel-server portmap nfs-common
<span class="kw2">sudo</span> <span class="kw2">nano</span> <span class="sy0">/</span>etc<span class="sy0">/</span>exports <span class="co0"># edit the exports as above</span>
<span class="kw2">sudo</span> service portmap start <span class="co0"># this didn't actually worked</span>
<span class="kw2">sudo</span> reboot</pre>

<p>
Later we will create a folder in the client server @node1  and mount in as shared with the correspondent folder in grappolo.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Setting Up an NFS Server&quot;,&quot;hid&quot;:&quot;setting_up_an_nfs_server&quot;,&quot;codeblockOffset&quot;:9,&quot;secid&quot;:10,&quot;range&quot;:&quot;14323-17065&quot;} -->
<h2 class="sectionedit11" id="clone_os">Clone OS</h2>
<div class="level2">

<p>
Shut down grappolo, remove the sd card and insert it in a linux machine. Copy sd image file to computer disk as back up and clone template. 
</p>
<pre class="code">   umount /dev/sdb1
   umount /dev/sdb2
   sudo dd bs=4M if=/dev/sdb of=jessie_and_softwares.img</pre>

<p>
This image is also usefull as back up <abbr title="Operating System">OS</abbr> template file.
Now copy the clone template <em> jessie<em>and</em>softwares.img </em> image in two different SD cards.
Insert successively the new micro sd cards into a laptop (in our case is mounted at<em> /dev/sdb </em>; unmount the card and copy the “.img” using the dd command.
</p>
<pre class="code bash"><span class="kw2">umount</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sdb1
<span class="kw2">umount</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sdb2
<span class="kw2">sudo</span> <span class="kw2">dd</span> <span class="re2">bs</span>=4M <span class="re2">if</span>=jessie_and_soft.img <span class="re2">of</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>sdb</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Clone OS&quot;,&quot;hid&quot;:&quot;clone_os&quot;,&quot;codeblockOffset&quot;:12,&quot;secid&quot;:11,&quot;range&quot;:&quot;17066-17742&quot;} -->
<h1 class="sectionedit12" id="customize_grid_engine_master_and_computing_nodes">Customize grid engine master and computing nodes</h1>
<div class="level1">

<p>
<a href="/dokuwiki/doku.php?id=wiki:grappolo_ii" class="wikilink1" title="wiki:grappolo_ii"> Next </a> we explain how to customize the cloned sd card for master (job scheduler)  and slave (computation) nodes.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Customize grid engine master and computing nodes&quot;,&quot;hid&quot;:&quot;customize_grid_engine_master_and_computing_nodes&quot;,&quot;codeblockOffset&quot;:13,&quot;secid&quot;:12,&quot;range&quot;:&quot;17743-17940&quot;} -->
<h1 class="sectionedit13" id="users_accounts_and_data_storage">Users accounts and data storage</h1>
<div class="level1">

<p>
<a href="/dokuwiki/doku.php?id=wiki:grappolo_iii" class="wikilink1" title="wiki:grappolo_iii"> Next </a> we explain how to add multiple students accounts and add usb drives to the master and computing nodes to read and write data.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Users accounts and data storage&quot;,&quot;hid&quot;:&quot;users_accounts_and_data_storage&quot;,&quot;codeblockOffset&quot;:13,&quot;secid&quot;:13,&quot;range&quot;:&quot;17941-18143&quot;} -->
<h1 class="sectionedit14" id="hands_on_cluster_processing_with_grappolo">Hands on cluster processing with grappolo</h1>
<div class="level1">

<p>
<a href="/dokuwiki/doku.php?id=wiki:grappolo_basic" class="wikilink1" title="wiki:grappolo_basic"> Here </a> we explain how to use grappolo for submitting data processing jobs into a grid engine. 
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Hands on cluster processing with grappolo&quot;,&quot;hid&quot;:&quot;hands_on_cluster_processing_with_grappolo&quot;,&quot;codeblockOffset&quot;:13,&quot;secid&quot;:14,&quot;range&quot;:&quot;18144-&quot;} -->