
<h1 class="sectionedit1" id="least_cost-path_analysis_applied_to_grey-sided_vole_movement_between_older_stands_of_pine_forest_habitat_patches">Least cost-path analysis applied to grey-sided vole movement between older stands of pine forest habitat patches</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Least cost-path analysis applied to grey-sided vole movement between older stands of pine forest habitat patches&quot;,&quot;hid&quot;:&quot;least_cost-path_analysis_applied_to_grey-sided_vole_movement_between_older_stands_of_pine_forest_habitat_patches&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-130&quot;} -->
<h2 class="sectionedit2" id="introduction">INTRODUCTION</h2>
<div class="level2">

<p>
The structure of the modern day landscape is highly influenced by human activities. Many species of animals and plants have a hard time finding suitable habitats since these are getting more and more fragmented as a result of human preference of large-scale similar aged monocultural type of agriculture or forestry. Therefore there is a need for closer investigations of the dispersal difficulties between fragmented habitats.<br/>

<br/>

Outside Umeå in boreal Sweden, the abundance of the grey-sided vole (<em>Clethrionomys rufocanus</em>) has been measured annually since 1971. The population of today peaks at 2-3% of the seventies&#039; maxima. Hypotheses suggests that the decrease is due to:
</p>
<ol>
<li class="level1"><div class="li"> Smaller focal patch size; from median 200 to 50 ha.</div>
</li>
<li class="level1"><div class="li"> Increased inter-patch distance</div>
</li>
</ol>

<p>
<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_gs_trend.png" class="media" title="wikidk:am_gs_trend.png"><img src="/dokuwiki/lib/exe/fetch.php?w=300&amp;tok=2eafd0&amp;media=wikidk:am_gs_trend.png" class="media" alt="" width="300" /></a><br/>

<em>Population decrease of grey-sided vole.</em>
<br/>

<br/>

</p>

<p>
We address the second hypothesis be here presenting a cost path analysis aiming to make the habitat connectivity estimation more detailed and hence realistic. Least cost-path analysis is a GIS based method of investigating movement patterns of a certain organism. The approach is general and can be used for species with different habitat preferences and different movement capabilities.
</p>

<p>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;INTRODUCTION&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;131-1410&quot;} -->
<h3 class="sectionedit3" id="project_objectives">Project objectives</h3>
<div class="level3">

<p>
To investigate animal movement in a forest landscape by producing a &#039;least cost-path&#039; between fragmented habitat patches for the grey-sided vole.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Project objectives&quot;,&quot;hid&quot;:&quot;project_objectives&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;1411-1590&quot;} -->
<h2 class="sectionedit4" id="metadata">METADATA</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;METADATA&quot;,&quot;hid&quot;:&quot;metadata&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;1591-1611&quot;} -->
<h3 class="sectionedit5" id="raster_data">Raster data</h3>
<div class="level3">

<p>
Data covering the province of Västerbottens Län in northern Sweden (resolution 25&times;25 meters per pixel):<br/>

<br/>

- Age of forest areas<br/>

<br/>

- Volume of Pine trees<br/>

<br/>

- Volume of all trees<br/>

<br/>

- Land use<br/>

<br/>

</p>

<p>
<strong>Pine volume</strong> (cubic meters / ha)<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_pin.png" class="media" title="wikidk:am_pin.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wikidk:am_pin.png" class="media" alt="" /></a>
<br/>

<strong>Total volume</strong> (cubic meters / ha)<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_tot.png" class="media" title="wikidk:am_tot.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wikidk:am_tot.png" class="media" alt="" /></a> <br/>

<br/>

<strong>Age</strong> (years)<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_age.png" class="media" title="wikidk:am_age.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wikidk:am_age.png" class="media" alt="" /></a> <br/>

<br/>

<strong>Landcover map</strong> <br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_veg_tr.png" class="media" title="wikidk:am_veg_tr.png"><img src="/dokuwiki/lib/exe/fetch.php?w=500&amp;tok=2fc262&amp;media=wikidk:am_veg_tr.png" class="media" alt="" width="500" /></a> <br/>

<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Raster data&quot;,&quot;hid&quot;:&quot;raster_data&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;1612-2085&quot;} -->
<h3 class="sectionedit6" id="text_files_and_tables">Text files and tables</h3>
<div class="level3">

<p>
A table of land cover classifications, where every type was an traversal cost (permeability value) for the grey-sided vole.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Text files and tables&quot;,&quot;hid&quot;:&quot;text_files_and_tables&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;2086-2244&quot;} -->
<h2 class="sectionedit7" id="method">METHOD</h2>
<div class="level2">

<p>
<br/>

<strong>GRASS operations</strong> <br/>

<br/>

- Reproject input raster tif-files from &#039;RT-90 2.5 GON V&#039; to &#039;SWEREF 99 TM&#039; using &#039;gdalwarp&#039;<br/>

<br/>

- Import raster tif-files to GRASS-format using &#039;r.in.gdal&#039;<br/>

<br/>

- Rectify position of cost raster to better fit patch layers using &#039;gdal_translate&#039;, &#039;awk&#039; and &#039;r.in.gdal&#039;<br/>

<br/>

- Replace zero or negative &#039;no data&#039; values with &#039;null&#039; to eliminate interference using &#039;r.null&#039;<br/>

<br/>

- Perform &#039;smoothing&#039; in order to create coherent patches of similar aged forest stands using &#039;r.neighbor&#039;<br/>

<br/>

- Reclass everything greater than 60 years old forest to 1 using &#039;r.recode&#039;<br/>

<br/>

- Remove nodata pixels in &#039;smoothed&#039; layer using &#039;r.mapcalc&#039;<br/>

<br/>

- Extract high quality habitat patches with min forest age of 80 years and at least 70 % Pine using &#039;r.mapcalc&#039;<br/>

<br/>

- Assign a unique category value to every patch using &#039;r.clump&#039;<br/>

<br/>

- Calculate number of high quality Pine forest pixels in each patch in relation to number of pixels in each patch using &#039;r.statistics&#039; and &#039;r.mapcalc&#039;<br/>

<br/>

- Create vector point layers with start and stopping points to be used with &#039;r.cost&#039; and &#039;r.drain&#039; functions<br/>

<br/>

- Calculate cost &#039;cloud&#039; in the cost raster with edges of neighboring habitat patches as starting and stopping points using &#039;r.cost&#039;<br/>

<br/>

- Visualize least cost-path between start and stop points in the cost raster using &#039;r.drain&#039;<br/>

<br/>

<strong>Finished!!!</strong><br/>

<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;METHOD&quot;,&quot;hid&quot;:&quot;method&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;2245-3647&quot;} -->
<h2 class="sectionedit8" id="data_import">DATA IMPORT</h2>
<div class="level2">

<p>
<br/>

</p>
<pre class="code bash">grass <span class="re5">-text</span> ~<span class="sy0">/</span>ost4sem<span class="sy0">/</span>grassdb<span class="sy0">/</span>sweden<span class="sy0">/</span>kNN2005
&nbsp;
<span class="co0">##########################################################################</span>
<span class="co0">###########   The following are GRASS commands     #######################</span>
&nbsp;
<span class="co0"># set the working directories</span>
<span class="re2">INDIR</span>=~<span class="sy0">/</span>ost4sem<span class="sy0">/</span>project<span class="sy0">/</span>unidk2010<span class="sy0">/</span>costpath<span class="sy0">/</span>input<span class="sy0">/</span>VB 
<span class="re2">OUTDIR</span>=~<span class="sy0">/</span>ost4sem<span class="sy0">/</span>project<span class="sy0">/</span>unidk2010<span class="sy0">/</span>costpath<span class="sy0">/</span>outputVB
&nbsp;
<span class="kw3">cd</span> <span class="re1">$INDIR</span>
<span class="kw3">echo</span> the input <span class="kw2">file</span> directory is : <span class="re1">$INDIR</span><span class="sy0">/</span>
<span class="kw3">echo</span> the output <span class="kw2">file</span> directory is : <span class="re1">$OUTDIR</span><span class="sy0">/</span>
&nbsp;
<span class="co0"># check coordinate system and NoData values of input files</span>
gdalinfo <span class="re5">-mm</span> AGE_24_P_05.tif <span class="sy0">|</span> <span class="kw2">head</span> <span class="re5">-40</span>
gdalinfo <span class="re5">-mm</span> PINEVOL_24_P_05.tif <span class="sy0">|</span> <span class="kw2">head</span> <span class="re5">-40</span>
gdalinfo <span class="re5">-mm</span> TOTALVOL_24_P_05.tif <span class="sy0">|</span> <span class="kw2">head</span> <span class="re5">-40</span>
<span class="co0"># Projection of input files is RT90_25_gon_W (EPSG: 2400)</span>
<span class="co0"># Our desired projection is SWEREF99 TM (or EPSG:3006)</span>
<span class="co0"># NoData Value=-32768</span>
<span class="co0"># STATISTICS_MINIMUM=0</span>
&nbsp;
<span class="co0">##########################################################################</span>
<span class="co0">##########   gdalwarp -- REPROJECT INPUT RASTERS       ###################</span>
<span class="kw3">cd</span> <span class="re1">$INDIR</span>
<span class="kw1">for</span> oldfile <span class="kw1">in</span> <span class="sy0">*</span>.tif ; <span class="kw1">do</span>
  <span class="re2">filename</span>=<span class="sy0">`</span><span class="kw2">basename</span> <span class="re1">$oldfile</span> .tif<span class="sy0">`</span>
  <span class="kw3">echo</span> <span class="st0">&quot;old file:&quot;</span> <span class="re1">$oldfile</span>  <span class="st0">&quot;   new filename:&quot;</span> <span class="re1">$filename</span><span class="st0">&quot;_prj.tif&quot;</span>
  gdalwarp  -t_srs EPSG:<span class="nu0">3006</span>  -s_srs EPSG:<span class="nu0">2400</span>  <span class="re1">$INDIR</span><span class="sy0">/</span><span class="re1">$oldfile</span> <span class="re1">$INDIR</span><span class="sy0">/</span><span class="re1">$filename</span><span class="st0">&quot;_prj.tif&quot;</span>
<span class="co0"># gdalwarp   -srcnodata &quot;-32768 -2147483647&quot; -dstnodata -9999 -t_srs EPSG:3006 -s_srs EPSG:2400 $INDIR/$oldfile $OUTDIR/$filename&quot;_prj.tif&quot;</span>
<span class="kw1">done</span>
<span class="co0"># gdalwarp can merge adjecent areas if needed</span>
&nbsp;
<span class="co0"># view the reprojected .tif</span>
openev2 <span class="re1">$INDIR</span><span class="sy0">/</span><span class="re1">$filename</span><span class="st0">&quot;_prj.tif&quot;</span>
&nbsp;
<span class="co0">##########################################################################</span>
<span class="co0">##########   r.in.gdal -- IMPORT RASTERS INTO GRASS    ###################</span>
<span class="kw3">cd</span> <span class="re1">$INDIR</span>
<span class="kw1">for</span> inputFile <span class="kw1">in</span> <span class="sy0">*</span>_prj.tif ; <span class="kw1">do</span>
  <span class="kw3">echo</span> <span class="st0">&quot;Input file &quot;</span> <span class="re1">$inputFile</span> <span class="st0">&quot; is imported as raster &quot;</span> <span class="co1">${inputFile:0:3}</span>
  r.in.gdal <span class="re2">input</span>=<span class="re1">$INDIR</span><span class="sy0">/</span><span class="re1">$inputFile</span> <span class="re2">output</span>=<span class="co1">${inputFile:0:3}</span>
<span class="kw1">done</span>
&nbsp;
<span class="co0">##########################################################################</span>
<span class="co0">##########   g.region -- set smaller working regions   ###################</span>
g.region <span class="re2">n</span>=<span class="nu0">7080000</span> <span class="re2">e</span>=<span class="nu0">730000</span> <span class="re2">s</span>=<span class="nu0">7066000</span> <span class="re2">w</span>=<span class="nu0">710000</span> <span class="re2">res</span>=<span class="nu0">25</span> <span class="re2">save</span>=umetest <span class="re5">--overwrite</span>
g.region <span class="re5">-p</span>
&nbsp;
<span class="co0">##########################################################################</span>
<span class="co0">###    LAND COVER RASTER SEEMS TO BE DISLOCATED       </span>
<span class="co0">###    MOVE RASTER 125 METERS UP/NORTH AND 175 METERS RIGHT/EAST</span>
gdal_translate <span class="re5">-of</span>  AAIGrid  ume<span class="sy0">/</span>order_202207_356387_1.tif  ume<span class="sy0">/</span>order_202207_356387_1.asc   
<span class="kw2">awk</span> <span class="st_h">' {if(NR&lt;=2) {print}  else{if(NR==3) {print $1 ,$2+175} else if(NR==4) {print $1 ,$2+125} else{print} }} '</span>  ume<span class="sy0">/</span>order_202207_356387_1.asc <span class="sy0">&gt;</span>  ume<span class="sy0">/</span>order_202207_356387_1_tr.asc 
<span class="kw2">cp</span>  ume<span class="sy0">/</span>order_202207_356387_1.prj  ume<span class="sy0">/</span>order_202207_356387_1_tr.prj 
gdal_translate  ume<span class="sy0">/</span>order_202207_356387_1_tr.asc  ume<span class="sy0">/</span>order_202207_356387_1_tr.tif  
r.in.gdal <span class="re2">input</span>=<span class="re1">$INDIR</span><span class="sy0">/</span>ume<span class="sy0">/</span>order_202207_356387_1_tr.tif <span class="re2">output</span>=VEG_tr
<span class="co0">##########################################################################</span>
<span class="co0"># display imported rasters</span>
d.mon <span class="re2">start</span>=x1
d.rast VEG_tr
<span class="co0">##########################################################################</span></pre>

<p>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;DATA IMPORT&quot;,&quot;hid&quot;:&quot;data_import&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;3648-6588&quot;} -->
<h2 class="sectionedit9" id="data_processing">DATA PROCESSING</h2>
<div class="level2">

<p>
<br/>

</p>
<pre class="code bash"><span class="co0">##########################################################################</span>
<span class="co0">##########   SMOOTHING OF FOREST DATA      ###############################</span>
&nbsp;
<span class="co0"># r.null does not create a new raster, but changes the input</span>
r.null <span class="re2">map</span>=AGE<span class="sy0">@</span>kNN2005 <span class="re2">setnull</span>=-<span class="nu0">32768</span>
r.null <span class="re2">map</span>=PIN<span class="sy0">@</span>kNN2005 <span class="re2">setnull</span>=-<span class="nu0">32768</span>
r.null <span class="re2">map</span>=TOT<span class="sy0">@</span>kNN2005 <span class="re2">setnull</span>=-<span class="nu0">32768</span>
&nbsp;
r.null <span class="re2">map</span>=AGE<span class="sy0">@</span>kNN2005 <span class="re2">setnull</span>=<span class="nu0">0</span>
r.null <span class="re2">map</span>=PIN<span class="sy0">@</span>kNN2005 <span class="re2">setnull</span>=<span class="nu0">0</span>
r.null <span class="re2">map</span>=TOT<span class="sy0">@</span>kNN2005 <span class="re2">setnull</span>=<span class="nu0">0</span>
&nbsp;
<span class="co0"># Circle 3 median</span>
r.neighbors <span class="re5">-c</span> <span class="re2">input</span>=Age<span class="sy0">@</span>kNN2005 <span class="re2">output</span>=Age_c3medN <span class="re2">method</span>=median <span class="re2">size</span>=<span class="nu0">3</span> 
<span class="co0"># using processed input</span>
r.neighbors <span class="re5">-c</span> <span class="re2">input</span>=Age_c3med<span class="sy0">@</span>kNN2005 <span class="re2">output</span>=Age_c3med2 <span class="re2">method</span>=median <span class="re2">size</span>=<span class="nu0">3</span> 
&nbsp;
<span class="co0"># Square 3 median</span>
r.neighbors <span class="re2">input</span>=AGE<span class="sy0">@</span>kNN2005 <span class="re2">output</span>=AGE_sq3medN <span class="re2">method</span>=median <span class="re2">size</span>=<span class="nu0">3</span> <span class="re5">--overwrite</span> <span class="re2">title</span>=<span class="st0">&quot;r.neighbors input=AGE@kNN2005 output=AGE_sq3medN method=median size=3&quot;</span>
<span class="co0"># Repeat</span>
r.neighbors <span class="re2">input</span>=AGE_sq3medN<span class="sy0">@</span>kNN2005 <span class="re2">output</span>=AGE_sq3med2N <span class="re2">method</span>=median <span class="re2">size</span>=<span class="nu0">3</span> <span class="re5">--overwrite</span>
<span class="co0"># After inspection we choose to continue with the double 3x3px square neighborhood</span>
<span class="co0">##########################################################################</span>
<span class="co0">##########    IDENTIFY FOREST PATCHES &gt;60 YRS        #####################</span>
<span class="co0"># Reclass everything greater than 60 to 1(&quot;patch class&quot;). </span>
r.recode <span class="re2">in</span>=AGE_sq3med2N <span class="re2">out</span>=fp60_2n <span class="re5">--overwrite</span> <span class="co2">&lt;&lt;EOF
60:*:1
EOF</span></pre>

<p>
<br/>

<strong>Each pixel is assigned the median value of its neighborhood.</strong>
<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_age_sq3medn.png" class="media" title="wikidk:am_age_sq3medn.png"><img src="/dokuwiki/lib/exe/fetch.php?w=600&amp;tok=719157&amp;media=wikidk:am_age_sq3medn.png" class="media" alt="" width="600" /></a>
<br/>

<br/>

<strong>The procedure is repeated to get fewer and more smooth patches.</strong>
<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_age_sq3med2n.png" class="media" title="wikidk:am_age_sq3med2n.png"><img src="/dokuwiki/lib/exe/fetch.php?w=600&amp;tok=b352f3&amp;media=wikidk:am_age_sq3med2n.png" class="media" alt="" width="600" /></a>
<br/>

<br/>

<strong>Now we can identify forest patches older than 60 years</strong>
<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_patches.png" class="media" title="wikidk:am_patches.png"><img src="/dokuwiki/lib/exe/fetch.php?w=600&amp;tok=1b3b55&amp;media=wikidk:am_patches.png" class="media" alt="" width="600" /></a>
<br/>

</p>
<pre class="code bash"><span class="co0">##########################################################################</span>
<span class="co0">### MASK SMOOTHED FOREST PATCHES WITH NoData AREAS (LAKES, RIVERS, ETC) ##</span>
&nbsp;
<span class="co0"># Identified patch pixels in smoothed data that are NoData in original age</span>
<span class="co0"># will be classes as NULL</span>
r.mapcalc patches = <span class="st0">&quot;if(isnull(AGE), null(), fp60_2n)&quot;</span>
&nbsp;
<span class="co0">##########################################################################</span>
<span class="co0">##############      FIND OLD PINE PIXELS    ##############################</span>
&nbsp;
<span class="co0"># Select pixles of pine forest (70% volume)</span>
r.mapcalc pxlspine =   <span class="st0">&quot;if((PIN&gt;=10 &amp;&amp; PIN/TOT&gt;=0.7) || PIN&gt;100, 1, null())&quot;</span>
&nbsp;
<span class="co0"># Select old pixels</span>
<span class="co0"># r.mapcalc pxls100yrs = &quot;if(AGE&gt;=100, 1, null())&quot;</span>
r.mapcalc pxls80yrs = <span class="st0">&quot;if(AGE&gt;=80, 1, null())&quot;</span>
&nbsp;
<span class="co0"># Select old pine pixels</span>
<span class="co0"># r.mapcalc pxlspine100y =&quot;if(pxls100yrs, pxlspine, null())&quot;</span>
r.mapcalc pxlspine80y =<span class="st0">&quot;if(pxls80yrs, pxlspine, null())&quot;</span>
&nbsp;
<span class="co0">##########################################################################</span>
<span class="co0">##############     PATCH CALCULATIONS    #################################</span>
&nbsp;
<span class="co0"># Assign a unique category value to every identified patch</span>
r.clump <span class="re2">input</span>=patches<span class="sy0">@</span>kNN2005 <span class="re2">output</span>=
&nbsp;
<span class="co0"># r.statistics is a tool to analyse exploratory statistics of a &quot;cover layer&quot;</span>
<span class="co0"># according to how it intersects with objects in a &quot;base layer&quot;. A variety</span>
<span class="co0"># of standard statistical measures are possible (called &quot;zonal statistics&quot; in some GIS). </span>
r.statistics <span class="re2">base</span>=patches_nrd<span class="sy0">@</span>kNN2005 <span class="re2">cover</span>=pxlspine80y<span class="sy0">@</span>kNN2005 <span class="re2">method</span>=<span class="kw2">sum</span> <span class="re2">output</span>=pat_sum_pine 
r.statistics <span class="re2">base</span>=patches_nrd<span class="sy0">@</span>kNN2005 <span class="re2">cover</span>=patches<span class="sy0">@</span>kNN2005 <span class="re2">method</span>=<span class="kw2">sum</span> <span class="re2">output</span>=pat_sum_pat
&nbsp;
<span class="co0"># If a raster map layer name is preceded by the @ operator, then the labels in </span>
<span class="co0"># the category file for the raster map layer are used in the expression instead</span>
<span class="co0"># of the category value.</span>
r.category pat_sum_pine
r.category pat_sum_pat
r.mapcalc <span class="st0">&quot;aggregated_pinearea=@pat_sum_pine&quot;</span>
r.mapcalc <span class="st0">&quot;patcharea=@pat_sum_pat&quot;</span>
&nbsp;
<span class="co0"># Selection of patches with pine</span>
r.mapcalc patch_w20perc_pine =<span class="st0">&quot;if((aggregated_pinearea&gt;0 &amp;&amp; aggregated_pinearea/patcharea&gt;=0.20) || (patcharea&lt;32  &amp;&amp; aggregated_pinearea&gt;=2) || (patcharea&gt;640 &amp;&amp; aggregated_pinearea&gt;=64), 1, null())&quot;</span>
<span class="co0"># &quot;aggregated_pinearea&gt;0&quot;   --- to avoid mapcalc on patches without category values of &quot;aggregated_pinearea&quot;</span>
<span class="co0"># STANDARD CRITERIA: 20% pine</span>
<span class="co0"># SPECIAL PINE CRITERIA FOR...</span>
<span class="co0"># ...small patches</span>
<span class="co0"># 32px   = 1ha</span>
<span class="co0"># ... large patches</span>
<span class="co0"># 640px  = 40ha</span>
<span class="co0"># 64px   = 4ha</span>
<span class="co0">##########################################################################</span></pre>

<p>
<br/>

<br/>

<strong>In previous studies voles were found in patches with at 20 % pine. By combining the age and pine rasters we select pixels with pine forest older than 80 years</strong>
<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_pxlspine80y.png" class="media" title="wikidk:am_pxlspine80y.png"><img src="/dokuwiki/lib/exe/fetch.php?w=600&amp;tok=5d18a9&amp;media=wikidk:am_pxlspine80y.png" class="media" alt="" width="600" /></a>
<br/>

<br/>

</p>

<p>
<strong>To get patch specific statistics, we assign a unique identifier to each patch</strong>
<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:patches_nrd.png" class="media" title="wikidk:patches_nrd.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wikidk:patches_nrd.png" class="media" alt="" /></a>
<br/>

<br/>

<strong>Finally we select those forest patches(&gt;60yrs) that contain at least 20 percent old growth pine</strong>
<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_patch_w20perc_pine.png" class="media" title="wikidk:am_patch_w20perc_pine.png"><img src="/dokuwiki/lib/exe/fetch.php?w=600&amp;tok=7e8c4d&amp;media=wikidk:am_patch_w20perc_pine.png" class="media" alt="" width="600" /></a>
<br/>

<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;DATA PROCESSING&quot;,&quot;hid&quot;:&quot;data_processing&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:9,&quot;range&quot;:&quot;6589-11133&quot;} -->
<h3 class="sectionedit10" id="cost_path_modeling">Cost Path Modeling</h3>
<div class="level3">
<pre class="code bash"><span class="co0">##########################################################################</span>
<span class="co0">##############      COST PATH CALCULATIONS     ###########################</span>
&nbsp;
<span class="co0"># Create raster with cost categories</span>
r.reclass <span class="re2">input</span>=VEG_tr <span class="re2">output</span>=cost_surf <span class="re2">rules</span>=cost_table_gs 
&nbsp;
<span class="co0"># Create cost path between test points</span>
<span class="co0"># In Quantum GIS we create vector point layers for start and stop locations </span>
r.cost <span class="re5">-k</span> <span class="re2">input</span>=cost_surf <span class="re2">output</span>=cumulcostsume <span class="re2">start_points</span>=startpts2ume <span class="re2">stop_points</span>=stopptsume <span class="re2">max_cost</span>=<span class="nu0">5000</span>
&nbsp;
<span class="co0"># Create path</span>
r.drain <span class="re5">-a</span> <span class="re2">input</span>=cumulcostsume <span class="re2">output</span>=pathsume <span class="re2">vector_points</span>=stopptsume
r.to.vect <span class="re5">-s</span> <span class="re2">input</span>=pathsume<span class="sy0">@</span>kNN2005 <span class="re2">output</span>=pathsume <span class="re2">feature</span>=line
&nbsp;
<span class="co0">##########################################################################</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Cost Path Modeling&quot;,&quot;hid&quot;:&quot;cost_path_modeling&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:10,&quot;range&quot;:&quot;11134-11890&quot;} -->
<h2 class="sectionedit11" id="results_and_discussion">RESULTS and DISCUSSION</h2>
<div class="level2">

<p>
<br/>

<strong>Classified costs and patches (darker areas)</strong> <br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_costsurf_pat.png" class="media" title="wikidk:am_costsurf_pat.png"><img src="/dokuwiki/lib/exe/fetch.php?w=600&amp;tok=ce0c6f&amp;media=wikidk:am_costsurf_pat.png" class="media" alt="" width="600" /></a>
<br/>
<strong>Accumulated movement cost and least-cost paths</strong>
<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_pathsume.png" class="media" title="wikidk:am_pathsume.png"><img src="/dokuwiki/lib/exe/fetch.php?w=600&amp;tok=366044&amp;media=wikidk:am_pathsume.png" class="media" alt="" width="600" /></a><br/>

<strong>Least-cost paths and land types</strong>
<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10animal&amp;media=wikidk:am_veg_tr_paths.png" class="media" title="wikidk:am_veg_tr_paths.png"><img src="/dokuwiki/lib/exe/fetch.php?w=600&amp;tok=ffebcc&amp;media=wikidk:am_veg_tr_paths.png" class="media" alt="" width="600" /></a>
<br/>

<br/>

<br/>

This theoretical dispersal model has produced practically usable results. For this project, we used arbitrary cost values of grey-sided vole movement in the different land use areas. Although we believe we have achieved a successful rough cost estimate, with proper empirical data on the distribution and ecology of the modelled organism one could create a model that could correspond very well to realistic conditions.Cost path analysis allow us to make more realistic representation of habitat networks, which in turn can provide different kinds of information to land-use management: <br/>

</p>
<ul>
<li class="level1"><div class="li"> Can local extinctions be compensated for by recolonization from connected habitat?</div>
</li>
<li class="level1"><div class="li"> How do matrix quality affect dispersal processes in fragmented habitat?<br/>
  * Identify high-connectivity areas to protect</div>
</li>
<li class="level1"><div class="li"> Analyze the existence of distance thresholds e.g emerging from human activities like forestry. Suggest alternative spatial management schemes.</div>
</li>
</ul>

<p>
<br/>

We have shown that the open-source GIS platform (GRASS, QGIS), used together with bash/awk scripting, is well suited for studying the concept of least cost-path movement. Cost-path analysis could be used to study effective habitat connectivity for many ground dispersing vertebrates or invertebrates that depend on relatively undisturbed habitat types that are getting more and more fragmented as a result of anthropogenic activities in the landscape.<br/>

<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;RESULTS and DISCUSSION&quot;,&quot;hid&quot;:&quot;results_and_discussion&quot;,&quot;codeblockOffset&quot;:4,&quot;secid&quot;:11,&quot;range&quot;:&quot;11891-&quot;} -->