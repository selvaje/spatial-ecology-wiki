
<h1 class="sectionedit1" id="bird_abundance_and_diversity_in_sweden_s_agricultural_landscapes">Bird Abundance and Diversity in Sweden&#039;s Agricultural Landscapes</h1>
<div class="level1">

<p>
Ryan Clark
</p>

<p>
Swedish University of Agricultural Sciences
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Bird Abundance and Diversity in Sweden&#039;s Agricultural Landscapes&quot;,&quot;hid&quot;:&quot;bird_abundance_and_diversity_in_sweden_s_agricultural_landscapes&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-135&quot;} -->
<h2 class="sectionedit2" id="introduction">INTRODUCTION</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;INTRODUCTION&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;136-161&quot;} -->
<h3 class="sectionedit3" id="general_framework_of_the_analysis">General framework of the analysis</h3>
<div class="level3">
<ol>
<li class="level1"><div class="li"> Background: Farmland bird populations across Europe have been declining rapidly due to increase of agricultural land use and intensity. Some types of agricultural land use, or farm management, may benefit some bird species. Data on bird species presence and abundance has been collected at many farms across Sweden between 2006 - 2011. Some farms have been surveyed twice (i.e. in two different years between 2006 - 2011).</div>
</li>
<li class="level1"><div class="li"> keywords: agriculture, farmland birds, R, species richness, Sweden</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;General framework of the analysis&quot;,&quot;hid&quot;:&quot;general_framework_of_the_analysis&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;162-705&quot;} -->
<h3 class="sectionedit4" id="project_objectives">Project objectives</h3>
<div class="level3">

<p>
To use R (along with BASH) to process and analyse the data and examine trends in farmland bird diversity and/or abundance in Sweden across years (i.e. between 2006 - 2011), and/or between different regions in Sweden, or different farm-crop types. For the result I will produce figure(s) summarising the trends/patterns, and potentially map(s) as well. If possible, I will conduct a basic statistical test.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Project objectives&quot;,&quot;hid&quot;:&quot;project_objectives&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;706-1142&quot;} -->
<h2 class="sectionedit5" id="metadata">METADATA</h2>
<div class="level2">

<p>
The core data consists of the following: an Excel (xlsx) file containing 24452 observations (i.e. rows) with data collected for up to 47 variables (i.e. columns), and an associated polygon shapefile of the Sweden farms where the data in the Excel file were collected.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;METADATA&quot;,&quot;hid&quot;:&quot;metadata&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;1143-1432&quot;} -->
<h3 class="sectionedit6" id="vector_data">Vector data</h3>
<div class="level3">

<p>
Three shapefiles:
</p>
<ul>
<li class="level1"><div class="li"> polygon shapefile of the farm fields in Sweden where the data in the “FarmBirds” Excel file were collected between 2006 - 2011.</div>
</li>
<li class="level1"><div class="li"> polygon shapefile of the counties of Sweden</div>
</li>
<li class="level1"><div class="li"> polygon shapefile of the land boundary of Sweden</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Vector data&quot;,&quot;hid&quot;:&quot;vector_data&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;1433-1707&quot;} -->
<h3 class="sectionedit7" id="other_data_sources">Other data sources</h3>
<div class="level3">

<p>
An Excel (xlsx) file, “FarmBirds”, containing 24452 observations (i.e. rows) with data collected for up to 47 variables (i.e. columns). The variables include information about each farm and field (e.g. farm name and ID, field ID, crop or land use type, and centroid coordinates), the year and exact date of each bird survey, the number observed of each of 29 bird species, and some additional variables not used in the analysis.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Other data sources&quot;,&quot;hid&quot;:&quot;other_data_sources&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;1708-2165&quot;} -->
<h2 class="sectionedit8" id="method">METHOD</h2>
<div class="level2">

<p>
The script is primarily based in R and consists of two main parts. The first part is used to import the xlsx file into R and create a summarised version of the data. The reading of the xlsx file in R may first require the use of BASH to complete this process on a remote server. Once this is completed, R is used to create a summarised version of the data, and to add two new variables containing the total abundance and the richness (i.e. number of different species) observed on each farm for each year surveyed. The second part of the script, also in R, was written to create two boxplots, one of the total abundance per year, and one of the richness.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;METHOD&quot;,&quot;hid&quot;:&quot;method&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;2166-2842&quot;} -->
<h2 class="sectionedit9" id="computational_implementation">Computational implementation</h2>
<div class="level2">
<dl class="code">
<dt><a href="/dokuwiki/doku.php?do=export_code&amp;id=wikistudholland:utwente_rayan&amp;codeblock=0" title="Download Snippet" class="mediafile mf_">- mycode</a></dt>
<dd><pre class="code bash"><span class="co0">### 1. The first step is to read the xls file into R:</span>
<span class="co0">### Depending on the size of the xls file, and the limited RAM,</span>
<span class="co0">### it may be better to convert the xls file to a csv on a remote server as follows:</span>
 <span class="co0">## copy xls file to remote server:</span>
 <span class="kw2">scp</span> <span class="sy0">/</span>media<span class="sy0">/</span>sf_ProjectShare<span class="sy0">/</span>FarmBirds.xlsx  user<span class="sy0">@</span>remoteserver:~ost4sem<span class="sy0">/</span>MyProject<span class="sy0">/</span>FarmBirds.xlsx
&nbsp;
 <span class="co0">## if needed - copy the R directory from local to remote server:</span>
 <span class="kw2">scp</span> <span class="re5">-r</span> R user<span class="sy0">@</span>remoteserver:~<span class="re1">$R</span>
&nbsp;
 <span class="co0">## Log in to the remote server, enter R and install and load the &quot;gdata&quot; package:</span>
 <span class="kw2">ssh</span> user<span class="sy0">@</span>remoteserver
 R
 install.packages<span class="br0">&#40;</span><span class="st0">&quot;gdata&quot;</span><span class="br0">&#41;</span>
 library<span class="br0">&#40;</span>gdata<span class="br0">&#41;</span>
&nbsp;
 <span class="co0">## convert xls to csv file:</span>
 xls2csv<span class="br0">&#40;</span>xls = <span class="st0">&quot;ost4sem/MyProject/FarmBirds.xlsx&quot;</span><span class="br0">&#41;</span>
&nbsp;
 <span class="co0">## quit R and move the resulting csv file to the project directory on the remote server:</span>
 q<span class="br0">&#40;</span><span class="br0">&#41;</span>
 <span class="kw2">mv</span> tmp<span class="sy0">/</span>RtmpKI5hk8<span class="sy0">/</span>fileb83e1230546e.csv home<span class="sy0">/</span>user<span class="sy0">/</span>ost4sem<span class="sy0">/</span>MyProject
&nbsp;
 <span class="co0">## exit the remote server, and copy csv file from the remote server to the local working directory:</span>
 <span class="kw3">exit</span>
 <span class="kw2">scp</span> user<span class="sy0">@</span>remoteserver:~<span class="sy0">/</span>ost4sem<span class="sy0">/</span>MyProject<span class="sy0">/</span>fileb83e1230546e.csv RyWork<span class="sy0">/</span>MyProject<span class="sy0">/</span>
&nbsp;
 <span class="co0">## rename csv file:</span>
 <span class="kw2">mv</span> <span class="sy0">/</span>home<span class="sy0">/</span>user<span class="sy0">/</span>RyWork<span class="sy0">/</span>MyProject<span class="sy0">/</span>fileb83e1230546e.csv <span class="sy0">/</span>home<span class="sy0">/</span>user<span class="sy0">/</span>RyWork<span class="sy0">/</span>MyProject<span class="sy0">/</span>FarmBirds_Rcsv.csv
&nbsp;
 <span class="co0">## Enter R, or open R console (RStudio), and read in the &quot;FarmBirds_Rcsv.csv&quot; as a data.frame:</span>
 FarmBirds <span class="sy0">&lt;</span>- read.csv<span class="br0">&#40;</span><span class="re2">file</span>=<span class="st0">&quot;/home/user/RyWork/MyProject/FarmBirds_Rcsv.csv&quot;</span>,<span class="re2">sep</span>=<span class="st0">&quot;,&quot;</span><span class="br0">&#41;</span>
&nbsp;
 <span class="co0">## for later steps - copy shapefiles to be processed in R to the local working directory:</span>
 <span class="kw2">cp</span> <span class="sy0">/</span>media<span class="sy0">/</span>sf_ProjectShare<span class="sy0">/</span>Sweden<span class="sy0">*</span> <span class="sy0">/</span>home<span class="sy0">/</span>user<span class="sy0">/</span>RyWork<span class="sy0">/</span>MyProject<span class="sy0">/</span>
 <span class="kw2">cp</span> <span class="sy0">/</span>media<span class="sy0">/</span>sf_ProjectShare<span class="sy0">/</span>Inventoried_Fields<span class="sy0">*</span> <span class="sy0">/</span>home<span class="sy0">/</span>user<span class="sy0">/</span>RyWork<span class="sy0">/</span>MyProject<span class="sy0">/</span>
&nbsp;</pre>
</dd></dl>
<pre class="code R">### 1. The first step is to read the xls file into R: 
 ## Enter R or open the R console (e.g. RStudio), install and load the &quot;gdata&quot; package,
 ## which contains various tools for data manipulation, particularly for reading and converting xls files:
 R
 install.packages(&quot;gdata&quot;)
 library(gdata)
&nbsp;
## Read the xls file into R (this creates a temporary csv that is treated as a data frame):
 FB &lt;- read.xls(&quot;/home/user/RyWork/MyProject/FarmBirds.xlsx&quot;)
&nbsp;
### 2. To obtain summed counts of each bird species for each year on each farm:
 ## Step 1: Define the columns for grouping, and those that contain data to be evaluated in the data frame (FB)
 ## representing the original xls (or csv) file from part 1 (above):
 colnames(FB) # to determine the order numbers of columns in the data frame for use in the following steps
 GroupCols &lt;- colnames(FB[,3:4]) # creates a vector of the column names to be used for grouping in the ddply command (plyr pacakge)
 BirdNames &lt;- colnames(FB[,19:47]) # creates a vector of the column names containing counts of individual bird species
&nbsp;
 ## Step 2: Use ddply command (plyr package) to create a summarised data frame of the original data
 FB.SUMp1 &lt;- ddply(FB, GroupCols, numcolwise(sum))
&nbsp;
 ## Step 3: Using the mutate command (plyr package) - add columns to FB.SUMp1 containing -
 ## the total number of birds counted, and the number of different species observed at least once 
  # if needed - use colnames to determine the order numbers of columns in the FB.SUMp1 data frame for use in -
  # subsequent processes (this can also be determined from info in the Workspace window, or using View(FB.SUMp1))
  colnames(FB.SUMp1)
&nbsp;
  # create a new data frame, maintaining FB.SUMp1, and add two new columns with total sums from two different rowSums functions.
  FB.SUMp2 &lt;- mutate(FB.SUMp1, TotalIndiv = rowSums(FB.SUMp1[,3:31]), Richness = rowSums(FB.SUMp1[,3:31]&gt;0))
&nbsp;
### Create some basic boxplots to view general trends
 ## Boxplot of bird abundance
 boxplot(TotalIndiv~YEAR, data=FB.SUM4, varwidth=T, main = &quot;Median Birds Counted per Farm per Year&quot;,
        ylab = &quot;Abundance (count of individuals)&quot;, xlab = &quot;Year&quot;)
 ## Boxplot of bird species richness
 boxplot(Richness~YEAR, data=FB.SUM4, varwidth=T, main = &quot;Median Bird Species Richness per Farm per Year&quot;,
        ylab = &quot;Number of Species&quot;, xlab = &quot;Year&quot;)</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Computational implementation&quot;,&quot;hid&quot;:&quot;computational_implementation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;2843-6857&quot;} -->
<h2 class="sectionedit10" id="results_and_discussion">RESULTS and DISCUSSION</h2>
<div class="level2">

<p>
<br/>

</p>
<ul>
<li class="level1"><div class="li"> Graphic 1.</div>
</li>
</ul>

<p>
<a href="/dokuwiki/lib/exe/detail.php?id=wikistudholland%3Autwente_rayan&amp;media=wikistudholland:abundanceboxplotstandard1.png" class="media" title="wikistudholland:abundanceboxplotstandard1.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wikistudholland:abundanceboxplotstandard1.png" class="media" title="My graphic caption" alt="My graphic caption" /></a>
</p>
<ul>
<li class="level1"><div class="li">Graphic 2.
<a href="/dokuwiki/lib/exe/detail.php?id=wikistudholland%3Autwente_rayan&amp;media=wikistudholland:richnessstandardboxplot1.png" class="media" title="wikistudholland:richnessstandardboxplot1.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wikistudholland:richnessstandardboxplot1.png" class="media" title="My graphic caption" alt="My graphic caption" /></a>
</div>
</li>
<li class="level1"><div class="li">Map 1. <br/>

<a href="/dokuwiki/lib/exe/fetch.php?media=" class="media mediafile mf_" title=" (4 KB)"></a></div>
</li>
</ul>

<p>
<em></em>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;RESULTS and DISCUSSION&quot;,&quot;hid&quot;:&quot;results_and_discussion&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:10,&quot;range&quot;:&quot;6858-&quot;} -->