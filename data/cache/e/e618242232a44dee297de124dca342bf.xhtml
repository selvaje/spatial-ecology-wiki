
<h1 class="sectionedit1" id="forest_dynamics_in_space_and_time">FOREST DYNAMICS IN SPACE AND TIME</h1>
<div class="level1">

<p>
Renats Trubins. Southern Swedish Forest Research Centre, SLU.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;FOREST DYNAMICS IN SPACE AND TIME&quot;,&quot;hid&quot;:&quot;forest_dynamics_in_space_and_time&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-111&quot;} -->
<h2 class="sectionedit2" id="introduction">INTRODUCTION</h2>
<div class="level2">

<p>
Future state of forest landscape is strongly affected by applied forest management. In Sweden the dominant practice is even-aged management. It implies harvesting forest stands in blocks, usually in the range of a few hectars, and consequent establishing of a new generation of trees on the area. Such management results in a landscape consisting of a mosaic of forest stands with all trees within a stand belonging to the same generation and often to the same species. The lower limits of the age of forest stands when harvesting them is allowed are defined in the Forest Code. Within the legal boundaries, it is forest owner that decides when a forest stand is eventually harvested. The actual age at which forest stands are cut, called rotation age,  is crucial for the economical performance of forest as wood factory but also for ecological and social functions of forest in landscape. Any rotation age is too short for forest to fully realize its ecological role while economically, according to the most of approaches, extending it beyond a certain number of years very soon makes the wood production unprofitable. Thus there is a need for balancing different expectations from forests. This makes simulations of the effects of forest management strategies in space and time relevant in different contexts.
</p>

<p>
This work initially was envisaged to provide an input for the Animal Movement project by simulating future development of a forest landscape. The results of the simulation can be used as a base for ecological and spatial analyses as are used the data on the actual state of the landscape.
</p>

<p>
In this study I modeled only the age of forest stands in the landscape. To simulate forest development in terms of volume growth requires a ready growth model or a very large amount of data to create such a model. Such a task would have gone far beyond the scope of this course. However, despite the simplicity of my simulation modeling it still can be useful for following reasons.
</p>
<ul>
<li class="level1"><div class="li"> For many important ecological functions of the forest in landscape it is the age that is the crucial parameter. Some species find their habitats only in forest stands older than certain age and constituted by certain tree species.</div>
</li>
<li class="level1"><div class="li">Simulating forest development in a spatially explicit way, based on spatially explicit data allows for exploring spatial characteristics of the simulated future states of the landscape in connection with simulated forest age.</div>
</li>
<li class="level1"><div class="li">Cutting levels expressed in terms of area (in absence of volume data) still allow for an indirect assessment of the simulated scenarios in terms of resource sustainability.</div>
</li>
<li class="level1"><div class="li">As with the volume growth excluded the model becomes very simple, the computation is much faster.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;INTRODUCTION&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;112-2873&quot;} -->
<h3 class="sectionedit3" id="general_framework_of_this_analysis">General framework of this analysis</h3>
<div class="level3">

<p>
Simulation modeling is a common technique used to assess and compare development scenarios based on different assumptions concerning policies and management with the aim to provide decision support.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;General framework of this analysis&quot;,&quot;hid&quot;:&quot;general_framework_of_this_analysis&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;2874-3118&quot;} -->
<h3 class="sectionedit4" id="project_objectives">Project objectives</h3>
<div class="level3">

<p>
To simulate forest landscape development under different assumptions concerning forest management in order to provide a basis for ecological analyses of the simulated future states of the landscape and to compare assumed forest management strategies.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Project objectives&quot;,&quot;hid&quot;:&quot;project_objectives&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;3119-3399&quot;} -->
<h2 class="sectionedit5" id="metadata">METADATA</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;METADATA&quot;,&quot;hid&quot;:&quot;metadata&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;3400-3420&quot;} -->
<h3 class="sectionedit6" id="raster_data">Raster data</h3>
<div class="level3">

<p>
Forest cover description in raster including:
- age
- volume by species
</p>

<p>
(more descriptors are available but not used in this study)
</p>

<p>
The data is compiled by classifying satellite images and data from the sample plots of the National Forest Inventory of Sweden and presents the state of 2005.
The method of classification is k-NN (k- closest neighbour).
The resolution is 25 m.
</p>

<p>
The data is compiled at the Swedish University of Agricultural Sciences and is available for download at at <a href="http://skogskarta.slu.se/" class="urlextern" target="blanc" title="http://skogskarta.slu.se/" rel="nofollow noopener">http://skogskarta.slu.se/</a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Raster data&quot;,&quot;hid&quot;:&quot;raster_data&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;3421-3963&quot;} -->
<h2 class="sectionedit7" id="method">METHOD</h2>
<div class="level2">

<p>
The simulations were performed on data describing a forested landscape in Vasterbotten county in Sweden. The assumptions concerning forest management were the following. Rotation age for
</p>
<ul>
<li class="level1"><div class="li"> pine stands 110 years,</div>
</li>
<li class="level1"><div class="li"> spruce stands 80 years, </div>
</li>
<li class="level1"><div class="li"> birch stands 70 years. </div>
</li>
</ul>

<p>
Two scenarios were simulated:
</p>
<ol>
<li class="level1"><div class="li"> With no constraints except the rotation ages applied</div>
</li>
<li class="level1"><div class="li"> With constrained maximum cutting area per period (5% of total forest area)</div>
</li>
</ol>

<p>
In the first scenario principal assumption underlying the model were that all the forest that exceeded the rotation age was removed within one period, that after removal a new generation of trees starts growing immediately and that the dominant tree species  remains the same over time. In the second scenario the potential cutting area was compared with the max allowed and when the potential cuttings exceeded the limit, a number of pixels corresponding to the max allowed area was randomly distributed within the potential cutting areas. 
</p>

<p>
In order to choose between the different forest management programs, forest stands needed to be classified by species. For this initial classification data on volume by species were used. A simple rule was applied choosing the species that gave the highest volume in a given pixel. When several species had same volume at the location, the species were prioritized in the following order: pine, spruce and, at last, birch. Contorta pine stands that are also present in the region were classified as pine. A special class of pine was used where the volume proportion of pine was higher the 70% as this was the criterion used for the analyses by the Animal Movement (cost path analysis) group.
</p>

<p>
Development was simulated for 20 periods à 5 years with an output age raster file produced for each period. Statistics on cuttings by species (area) where compiled in a text files. All computations were made at a pixel level with no segmentation or aggregation of pixels into larger blocks to represent the stands. Computation were performed in GRASS mainly using various r.mapcalc functions. All the GRASS computations were embedded in scripts compiled in BASH and AWK languages. QGIS was used for visualisation. 
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;METHOD&quot;,&quot;hid&quot;:&quot;method&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;3964-6176&quot;} -->
<h2 class="sectionedit8" id="data_import">DATA IMPORT</h2>
<div class="level2">
<pre class="code bash"><span class="co0">##############################DOWNLOAD AND EXPLORE DATA########################################################################</span>
&nbsp;
<span class="kw2">wget</span> ftp:<span class="sy0">//</span>salix.slu.se<span class="sy0">/</span>download<span class="sy0">/</span>skogskarta<span class="sy0">/</span><span class="nu0">2005</span><span class="sy0">/</span><span class="nu0">2005</span>__Sweden_all.rar 
&nbsp;
<span class="co0">#Downloads the data to current directory (INPUT). It was not possible do download Væsterbottens læn separately because of the specific letter characters.</span>
&nbsp;
<span class="co0"># compute min and max for all the file *.tif</span>
&nbsp;
<span class="kw1">for</span> <span class="kw2">file</span> <span class="kw1">in</span> <span class="sy0">*</span>.tif ; <span class="kw1">do</span> 
  <span class="kw3">echo</span> <span class="re1">$file</span> ; gdalinfo <span class="re5">-mm</span> <span class="re1">$file</span>  <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st0">&quot;Min/Max&quot;</span> 
<span class="kw1">done</span> 
&nbsp;
<span class="co0"># change geographicqal projection (can be seen in gdalinfo) from EPSG:2400 RT 90 2.5 gon W to EPSG:3006 SWEREF99 (beacuse it is newer)</span>
&nbsp;
<span class="kw1">for</span> <span class="kw2">file</span> <span class="kw1">in</span> <span class="sy0">*</span>.tif ; <span class="kw1">do</span>
<span class="re2">filename</span>=<span class="sy0">`</span><span class="kw2">basename</span> <span class="re1">$file</span> .tif<span class="sy0">`</span> 
  <span class="kw3">echo</span> <span class="re1">$file</span> <span class="re1">$filename</span><span class="st0">&quot;_prj.tif&quot;</span>  
  gdalwarp -s_srs  EPSG:<span class="nu0">2400</span>   -t_srs   EPSG:<span class="nu0">3006</span>   <span class="re1">$file</span> <span class="re1">$filename</span><span class="st0">&quot;_prj.tif&quot;</span> 
<span class="kw1">done</span> 
&nbsp;
&nbsp;
<span class="co0">#Create new GRASS locations by r.in.gdal command in GRASS</span>
&nbsp;
r.in.gdal <span class="re2">input</span>=input_raster <span class="re2">output</span>=output_GRASS_raster <span class="re2">location</span>=new_Location <span class="re5">--overwrite</span>
r.in.gdal <span class="re2">input</span>=<span class="sy0">/</span>ost4sem<span class="sy0">/</span>project<span class="sy0">/</span>unidk2010<span class="sy0">/</span>INPUT<span class="sy0">/</span>Lan24<span class="sy0">/</span>AGE_24_P_05_prj.tif <span class="re2">output</span>=AGE_24_P_05_grass  <span class="re2">location</span>=Sweden <span class="re5">--overwrite</span>
&nbsp;
&nbsp;
<span class="co0">#Import other rasters (as the location is created - no need to set new location again)</span>
&nbsp;
<span class="kw3">cd</span> ~<span class="sy0">/</span>ost4sem<span class="sy0">/</span>project<span class="sy0">/</span>unidk2010<span class="sy0">/</span>INPUT<span class="sy0">/</span>Lan24
<span class="kw1">for</span> m <span class="kw1">in</span> <span class="sy0">*</span>_prj.tif; <span class="kw1">do</span>
<span class="re2">filename</span>=<span class="sy0">`</span><span class="kw2">basename</span> <span class="re1">$m</span> .tif<span class="sy0">`</span>
  <span class="kw3">echo</span> <span class="re1">$m</span> <span class="re1">$filename</span>
  r.in.gdal <span class="re2">input</span>=~<span class="sy0">/</span>ost4sem<span class="sy0">/</span>project<span class="sy0">/</span>unidk2010<span class="sy0">/</span>INPUT<span class="sy0">/</span>Lan24<span class="sy0">/</span><span class="re1">$m</span> <span class="re2">output</span>=<span class="re1">$filename</span><span class="st0">&quot;_grass&quot;</span> <span class="re5">--overwrite</span>
<span class="kw1">done</span>
&nbsp;
g.region <span class="re2">n</span>=<span class="nu0">7200000</span>  <span class="re2">s</span>=<span class="nu0">7150000</span>    <span class="re2">w</span>=<span class="nu0">600000</span>   <span class="re2">e</span>=<span class="nu0">700000</span>  <span class="re5">--overwrite</span> </pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;DATA IMPORT&quot;,&quot;hid&quot;:&quot;data_import&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;6177-7676&quot;} -->
<h2 class="sectionedit9" id="data_processing">DATA PROCESSING</h2>
<div class="level2">

<p>
<br/>

</p>
<pre class="code bash"><span class="co0">##############################CLASSSIFICATION########################################################################</span>
&nbsp;
<span class="co0">#The routine creates a classification of forest into different forest type defined by dominant tree species</span>
<span class="co0">#In order to assign different forest management programms, in this case i.e. final felling ages, every forest pixel needs to be assigned a type. Here are conidered 4 forest types: </span>
<span class="co0"># type 1 where pine or contorta has the highest volume</span>
<span class="co0"># type 2 where spruce has the highest volume</span>
<span class="co0"># type 3 where birch has the highest volume</span>
<span class="co0"># type 4 a special type where pine constitutes at least 0.7 of the total volume for given pixel </span>
<span class="co0"># where more than one species have equal volume the types are priritized in the following order type 4, type 1, type 2, type 3</span>
&nbsp;
<span class="co0"># Compare volumes of different tree species and record the max in a new file</span>
r.mapcalc <span class="re2">max_gr</span>=max<span class="st0">&quot;(BIRCHVOL_24_P_05_prj_grass , CONTORTAVOL_24_P_05_prj_grass , PINEVOL_24_P_05_prj_grass , SPRUCEVOL_24_P_05_prj_grass)&quot;</span>
&nbsp;
<span class="co0">#The order matters! Choose forest type: pine&gt;=0,7(4), pine(1), spruce(2), birch(3).</span>
r.mapcalc <span class="re2">species</span>=<span class="kw1">if</span><span class="st0">&quot;(max_gr==BIRCHVOL_24_P_05_prj_grass, 3 , 0 )&quot;</span>
r.mapcalc <span class="re2">species</span>=<span class="kw1">if</span><span class="st0">&quot;(max_gr==SPRUCEVOL_24_P_05_prj_grass, 2 , species )&quot;</span>
r.mapcalc <span class="re2">species</span>=<span class="kw1">if</span><span class="st0">&quot;(max_gr==PINEVOL_24_P_05_prj_grass || CONTORTAVOL_24_P_05_prj_grass, 1 , species )&quot;</span>
r.mapcalc <span class="re2">species</span>=<span class="kw1">if</span><span class="st0">&quot;(PINEVOL_24_P_05_prj_grass &gt;= (0.7*TOTALVOL_24_P_05_prj_grass), 4 , species )&quot;</span></pre>
<pre class="code bash"><span class="co0">##################################SIMULATION##################################################################</span>
&nbsp;
&nbsp;
&nbsp;
<span class="co0">#Set the rotation ages (ie age when the forest clearfelled)#</span>
&nbsp;
<span class="re2">rpine</span>=<span class="nu0">110</span>
<span class="re2">rspruce</span>=<span class="nu0">80</span>
<span class="re2">rbirch</span>=<span class="nu0">70</span>
<span class="kw3">echo</span> <span class="st0">&quot;Rotation age: Pine <span class="es2">$rpine</span> years, Spruce <span class="es2">$rspruce</span> years, Birch <span class="es2">$rbirch</span> years&quot;</span> <span class="sy0">&gt;</span> report.txt
&nbsp;
  <span class="co0">#Set number of periods (5 years) for simulation#</span>
  <span class="re2">n</span>=<span class="nu0">20</span>
  <span class="kw3">echo</span> <span class="st0">&quot;Number of periods=&quot;</span><span class="re1">$n</span> <span class="sy0">&gt;&gt;</span> report.txt
&nbsp;
&nbsp;
<span class="co0">#Set the lengh (nr of years) of a period</span>
<span class="re2">l</span>=<span class="nu0">5</span>
<span class="kw3">echo</span> <span class="st0">&quot;Length of a period=<span class="es2">$l</span> years&quot;</span> <span class="sy0">&gt;&gt;</span> report.txt
&nbsp;
&nbsp;
<span class="co0">#Set the allowed cut as a percentage of the total forest area</span>
<span class="re2">aff</span>=<span class="nu0">5</span>
&nbsp;
<span class="co0">#Set the initial age raster (period 0)</span>
r.mapcalc <span class="re2">age_0</span>=AGE_24_P_05_prj_grass
&nbsp;
<span class="co0"># Set NULLL for no data value (-32768) to make it easier for creating histogramms later on</span>
r.null <span class="re2">map</span>=age_0 <span class="re2">setnull</span>=-<span class="nu0">32768</span>
&nbsp;
<span class="co0">#Calculate the allowed cutting area in pixels (lm) for all forests (here only sums the total forest area, continuation see below)</span>
r.mapcalc <span class="re2">areatotal</span>=<span class="kw1">if</span><span class="st0">&quot;( age_0 &gt;= 0, 1, 0 )&quot;</span>
r.sum <span class="re2">rast</span>=areatotal <span class="sy0">&gt;</span> areatotal.txt
&nbsp;
<span class="re2">lm</span>=<span class="sy0">`</span><span class="kw2">awk</span>  <span class="re5">-v</span> <span class="re2">aff</span>=<span class="re1">$aff</span> <span class="st_h">'{ printf(&quot;%.0f\n&quot;, $3*aff/100) }'</span> areatotal.txt<span class="sy0">`</span> <span class="co0">#THIS WORKS!!!!!!!!!!!!!!!!!!!!! 5 is the percentage of total forest area allowed to be cut within 1 period</span>
<span class="kw3">echo</span> <span class="st0">&quot;Allowed cutting level - <span class="es2">$aff</span> % of the total forest area PER PERIOD&quot;</span> <span class="sy0">&gt;&gt;</span> report.txt
<span class="kw3">echo</span> <span class="st0">&quot;Allowed cutting area per period <span class="es2">$lm</span> pixels&quot;</span> <span class="sy0">&gt;&gt;</span> report.txt
&nbsp;
<span class="co0">#Print the column headings for the report in the sum1.txt</span>
<span class="kw2">awk</span> <span class="st_h">'BEGIN { print &quot;Period&quot; , &quot;Species&quot; , &quot;Clearcut area&quot;, &quot;Unit&quot; }'</span> <span class="sy0">&gt;</span> sum1.txt
&nbsp;
<span class="co0">#Run the loop. age_1, age_2 etc are the age files after periods 1,2 etc given the specified rotation ages</span>
&nbsp;
<span class="kw1">for</span> nn <span class="kw1">in</span> <span class="sy0">`</span><span class="kw2">seq</span> <span class="nu0">1</span> <span class="re1">$n</span><span class="sy0">`</span>; <span class="kw1">do</span>
&nbsp;
  <span class="kw3">echo</span> Period <span class="re1">$nn</span>
  <span class="re2">np</span>=$<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re1">$nn</span>-<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
  r.mapcalc age_<span class="re1">$nn</span>=age_<span class="re1">$np</span>
&nbsp;
        <span class="co0">#Identify potential cutting areas (in pixels)</span>
	r.mapcalc cuts_<span class="re1">$nn</span>=<span class="kw1">if</span><span class="st0">&quot;( species==1 &amp; age_<span class="es2">$nn</span> &gt; <span class="es2">$rpine</span> , 1 , 0 )&quot;</span>     
	r.mapcalc cuts_<span class="re1">$nn</span>=<span class="kw1">if</span><span class="st0">&quot;( species==4 &amp; age_<span class="es2">$nn</span> &gt; <span class="es2">$rpine</span> , 1 , cuts_<span class="es2">$nn</span> )&quot;</span>       
	r.mapcalc cuts_<span class="re1">$nn</span>=<span class="kw1">if</span><span class="st0">&quot;( species==2 &amp; age_<span class="es2">$nn</span> &gt; <span class="es2">$rspruce</span> , 1 , cuts_<span class="es2">$nn</span> )&quot;</span> 
	r.mapcalc cuts_<span class="re1">$nn</span>=<span class="kw1">if</span><span class="st0">&quot;( species==3 &amp; age_<span class="es2">$nn</span> &gt; <span class="es2">$rbirch</span> , 1 ,  cuts_<span class="es2">$nn</span> )&quot;</span> 
&nbsp;
	<span class="co0">#Sum all the potential cutting area (in pixels)</span>
	r.sum <span class="re2">rast</span>=cuts_<span class="re1">$nn</span> <span class="sy0">&gt;</span> sum.txt
	<span class="re2">pcuts</span>=<span class="sy0">`</span><span class="kw2">awk</span> <span class="st_h">'{ printf (&quot;%.0f\n&quot;, $3) }'</span> sum.txt<span class="sy0">`</span>
	<span class="kw3">echo</span> <span class="st0">&quot;Area of forest that reached minimum allowed cutting age <span class="es2">$pcuts</span> pixels&quot;</span> <span class="sy0">&gt;&gt;</span> report.txt
	<span class="co0">#counts the pixels selected for cutting</span>
&nbsp;
			      <span class="co0">#Test if the identified potential cutting area (pcuts) exceeds the allowed limit (lm) If it exceeds it randomly choose an area equal to lm out of the potential cuts</span>
&nbsp;
			      <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re1">$pcuts</span> <span class="re5">-gt</span> <span class="re1">$lm</span> <span class="br0">&#93;</span> ; <span class="kw1">then</span>
&nbsp;
			      <span class="kw3">echo</span> <span class="st0">&quot;Potential cutting area exceeds the allowed area of <span class="es2">$aff</span> % of forest area per period&quot;</span> <span class="sy0">&gt;&gt;</span> report.txt
&nbsp;
			      r.null <span class="re2">map</span>=cuts_<span class="re1">$nn</span> <span class="re2">setnull</span>=<span class="nu0">0</span>
&nbsp;
			      r.random <span class="re2">input</span>=cuts_<span class="re1">$nn</span> <span class="re2">n</span>=<span class="re1">$lm</span> <span class="re2">raster_output</span>=re_cuts_<span class="re1">$nn</span> <span class="re5">--overwrite</span>
&nbsp;
			      r.mapcalc cuts_<span class="re1">$nn</span>=re_cuts_<span class="re1">$nn</span>
&nbsp;
			      g.remove re_cuts_<span class="re1">$nn</span>
&nbsp;
			      r.sum <span class="re2">rast</span>=cuts_<span class="re1">$nn</span> <span class="sy0">&gt;</span> sum.txt
			      <span class="re2">pcuts</span>=<span class="re1">$lm</span> 
&nbsp;
			       <span class="co0">#NULL values must be replace back by 0 (zeros) to make the next test.</span>
			      r.null <span class="re2">map</span>=cuts_<span class="re1">$nn</span> <span class="re2">null</span>=<span class="nu0">0</span>	
&nbsp;
			      <span class="kw1">fi</span>
&nbsp;
	    <span class="co0"># When the cutting area (pcuts) is reset to (lm) the cuttings can be executed - i.e. the age raster can be manipulated. Cuts_$nn raster contains now all the &quot;approved&quot; cuts</span>
	    <span class="kw3">echo</span> <span class="st0">&quot;Approved area of cuttings <span class="es2">$pcuts</span> pixels&quot;</span> <span class="sy0">&gt;&gt;</span> report.txt
&nbsp;
&nbsp;
	    <span class="co0"># Thus the age in the age_$nn raster has to be reset for pixels where the cut is &quot;approved&quot; in cuts_$nn raster as results from the previous manipulations.</span>
&nbsp;
&nbsp;
	    r.mapcalc age_<span class="re1">$nn</span>=<span class="kw1">if</span><span class="st0">&quot;( cuts_<span class="es2">$nn</span>==1, 0 , age_<span class="es2">$nn</span> )&quot;</span>
&nbsp;
	    r.mapcalc <span class="re2">pinecuts</span>=<span class="kw1">if</span><span class="st0">&quot;( cuts_<span class="es2">$nn</span>==1 &amp; species==1, 1, 0)&quot;</span>
	    r.sum <span class="re2">rast</span>=pinecuts <span class="sy0">&gt;</span> cuts.txt
	    <span class="kw2">awk</span> <span class="re5">-v</span> <span class="re2">nn</span>=<span class="re1">$nn</span> <span class="st_h">'{ print  nn, &quot;     &quot;, &quot;Pine&quot;, &quot;     &quot;, $3/16, &quot;    &quot;, &quot;ha&quot; }'</span>  cuts.txt <span class="sy0">&gt;&gt;</span> sum1.txt
&nbsp;
	    r.mapcalc <span class="re2">pine07cuts</span>=<span class="kw1">if</span><span class="st0">&quot;( cuts_<span class="es2">$nn</span>==1 &amp; species==4, 1, 0)&quot;</span>
	    r.sum <span class="re2">rast</span>=pine07cuts <span class="sy0">&gt;</span> cuts.txt
	    <span class="kw2">awk</span> <span class="re5">-v</span> <span class="re2">nn</span>=<span class="re1">$nn</span> <span class="st_h">'{ print  nn, &quot;     &quot;, &quot;Pine07&quot;, &quot;   &quot;, $3/16, &quot;    &quot;, &quot;ha&quot; }'</span>  cuts.txt <span class="sy0">&gt;&gt;</span> sum1.txt
&nbsp;
	    r.mapcalc <span class="re2">sprucecuts</span>=<span class="kw1">if</span><span class="st0">&quot;( cuts_<span class="es2">$nn</span>==1 &amp; species==2, 1, 0)&quot;</span>
	    r.sum <span class="re2">rast</span>=sprucecuts <span class="sy0">&gt;</span> cuts.txt
	    <span class="kw2">awk</span> <span class="re5">-v</span> <span class="re2">nn</span>=<span class="re1">$nn</span> <span class="st_h">'{ print  nn, &quot;     &quot;, &quot;Spruce&quot;, &quot;   &quot;, $3/16, &quot;    &quot;, &quot;ha&quot; }'</span>  cuts.txt <span class="sy0">&gt;&gt;</span> sum1.txt
&nbsp;
	    r.mapcalc <span class="re2">birchcuts</span>=<span class="kw1">if</span><span class="st0">&quot;( cuts_<span class="es2">$nn</span>==1 &amp; species==3, 1, 0)&quot;</span>
	    r.sum <span class="re2">rast</span>=birchcuts <span class="sy0">&gt;</span> cuts.txt
	    <span class="kw2">awk</span> <span class="re5">-v</span> <span class="re2">nn</span>=<span class="re1">$nn</span> <span class="st_h">'{ print  nn, &quot;     &quot;, &quot;Birch&quot;, &quot;    &quot;, $3/16, &quot;    &quot;, &quot;ha&quot; }'</span>  cuts.txt <span class="sy0">&gt;&gt;</span> sum1.txt
&nbsp;
&nbsp;
	    <span class="co0"># Here I use the same sum1.txt file because it should conatin the pcuts_$nn count as it has rewritten last time in the while routine</span>
	    <span class="co0"># In this version report is created only for total cut area together</span>
	    <span class="kw2">awk</span> <span class="re5">-v</span> <span class="re2">nn</span>=<span class="re1">$nn</span> <span class="st_h">'{ print  nn, &quot;     &quot;, &quot;all&quot;, &quot;      &quot;, $3/16, &quot;    &quot;, &quot;ha&quot; }'</span>  sum.txt <span class="sy0">&gt;&gt;</span> sum1.txt
&nbsp;
<span class="co0"># Update age before next period</span>
r.mapcalc age_<span class="re1">$nn</span>=age_<span class="re1">$nn</span> + <span class="re1">$l</span>
&nbsp;
<span class="kw1">done</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;DATA PROCESSING&quot;,&quot;hid&quot;:&quot;data_processing&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:9,&quot;range&quot;:&quot;7677-13900&quot;} -->
<h3 class="sectionedit10" id="model_parametrization">Model parametrization</h3>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Model parametrization&quot;,&quot;hid&quot;:&quot;model_parametrization&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:10,&quot;range&quot;:&quot;13901-13932&quot;} -->
<h3 class="sectionedit11" id="model_prediction">Model prediction</h3>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Model prediction&quot;,&quot;hid&quot;:&quot;model_prediction&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:11,&quot;range&quot;:&quot;13933-13959&quot;} -->
<h3 class="sectionedit12" id="validation">Validation</h3>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Validation&quot;,&quot;hid&quot;:&quot;validation&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:12,&quot;range&quot;:&quot;13960-13981&quot;} -->
<h2 class="sectionedit13" id="results_and_discussion">RESULTS and DISCUSSION</h2>
<div class="level2">

<p>
Map 1. Initial forest age before the simulation. (Lighter green - young, darker green - older, 100 years and more)
<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10forestgrow&amp;media=wikidk:age_0new.png" class="media" title="wikidk:age_0new.png"><img src="/dokuwiki/lib/exe/fetch.php?w=400&amp;tok=2f9bd0&amp;media=wikidk:age_0new.png" class="media" alt="" width="400" /></a>
</p>

<p>
Map 2. Forest age after 10 periods (50 years) according to the first (no max cutting are constraint)
<br/>
<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10forestgrow&amp;media=wikidk:agenc_10new.png" class="media" title="wikidk:agenc_10new.png"><img src="/dokuwiki/lib/exe/fetch.php?w=400&amp;tok=37e914&amp;media=wikidk:agenc_10new.png" class="media" alt="" width="400" /></a>
</p>

<p>
Map3 and Map4. Forest after 20 periods (100 years) according to the first (no max cutting are constraint) and the second (with constrained max cutting area) scenarios. 
<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10forestgrow&amp;media=wikidk:agenc_20new.png" class="media" title="wikidk:agenc_20new.png"><img src="/dokuwiki/lib/exe/fetch.php?w=400&amp;tok=e6a64b&amp;media=wikidk:agenc_20new.png" class="media" alt="" width="400" /></a>  <a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10forestgrow&amp;media=wikidk:ageac_20new.png" class="media" title="wikidk:ageac_20new.png"><img src="/dokuwiki/lib/exe/fetch.php?w=400&amp;tok=b0e0cb&amp;media=wikidk:ageac_20new.png" class="media" alt="" width="400" /></a>
<br/>

<br/>

</p>

<p>
Figure 1. Initial forest age structure:vertical axis shows area; horizontal axes age (*10) in years
<br/>
<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10forestgrow&amp;media=wikidk:map_0.png" class="media" title="wikidk:map_0.png"><img src="/dokuwiki/lib/exe/fetch.php?w=450&amp;tok=268b26&amp;media=wikidk:map_0.png" class="media" alt="" width="450" /></a>
<br/>

<br/>

Figure 2 and 3. Forest age structure after 10 simulation periods (50 years): on the left - scenario with no constraint, on the right - scenario with constrained max cutting area per period
<br/>
<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10forestgrow&amp;media=wikidk:mapnc_10.png" class="media" title="wikidk:mapnc_10.png"><img src="/dokuwiki/lib/exe/fetch.php?w=450&amp;tok=b2bed4&amp;media=wikidk:mapnc_10.png" class="media" alt="" width="450" /></a> <a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10forestgrow&amp;media=wikidk:mapac_10.png" class="media" title="wikidk:mapac_10.png"><img src="/dokuwiki/lib/exe/fetch.php?w=450&amp;tok=72271b&amp;media=wikidk:mapac_10.png" class="media" alt="" width="450" /></a>
<br/>

<br/>

Figure 4 and 5. Forest age structure after 20 simulation periods (100 years): on the left - scenario with no constraint, on the right - scenario with constrained max cutting area per period
<br/>
<a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10forestgrow&amp;media=wikidk:mapnc_20.png" class="media" title="wikidk:mapnc_20.png"><img src="/dokuwiki/lib/exe/fetch.php?w=450&amp;tok=39374c&amp;media=wikidk:mapnc_20.png" class="media" alt="" width="450" /></a> <a href="/dokuwiki/lib/exe/detail.php?id=wikidk%3Adk10forestgrow&amp;media=wikidk:mapac_20.png" class="media" title="wikidk:mapac_20.png"><img src="/dokuwiki/lib/exe/fetch.php?w=450&amp;tok=1fddc1&amp;media=wikidk:mapac_20.png" class="media" alt="" width="450" /></a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;RESULTS and DISCUSSION&quot;,&quot;hid&quot;:&quot;results_and_discussion&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:13,&quot;range&quot;:&quot;13982-&quot;} -->