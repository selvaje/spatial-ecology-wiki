
<h1 class="sectionedit1" id="use_of_environmental_geostatitical_methods_for_the_study_of_soil_heavy-metals_concentration">Use of environmental geostatitical methods for the study of soil heavy-metals concentration</h1>
<div class="level1">

<p>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Use of environmental geostatitical methods for the study of soil heavy-metals concentration&quot;,&quot;hid&quot;:&quot;use_of_environmental_geostatitical_methods_for_the_study_of_soil_heavy-metals_concentration&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-110&quot;} -->
<h2 class="sectionedit2" id="introduction">INTRODUCTION</h2>
<div class="level2">

<p>
Geostatistical techniques, as the Kriging technique, are widely used for the study and mapping of soil heavy-metals concentration.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;INTRODUCTION&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;111-268&quot;} -->
<h3 class="sectionedit3" id="project_objectives">Project objectives</h3>
<div class="level3">

<p>
The main objective of this project was to automate the modeling and mapping steps for the application of the Kriging technique.
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Project objectives&quot;,&quot;hid&quot;:&quot;project_objectives&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;269-430&quot;} -->
<h2 class="sectionedit4" id="metadata">METADATA</h2>
<div class="level2">

<p>
The dataset used for the study contains the sampling results (n=70), measured using a regular grid of 200m width, made on the perimeter of an industrial area; in particular were sampled the soil&#039;s concentration of following heavy-metals: Al, As, Be, Cd, Co, Cr, Cu, Hg, Mn, Ni, Pb, Sb, Se, Sn, Tl, V and Zn.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;METADATA&quot;,&quot;hid&quot;:&quot;metadata&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;431-761&quot;} -->
<h3 class="sectionedit5" id="text_files_and_tables">Text files and tables</h3>
<div class="level3">

<p>
The data set was imported in R environment from an *.txt file to a “data-frame” file that presents the following structure:
<br/>

</p>
<pre class="code r">str(punti)
'data.frame':   70 obs. of  17 variables:
 $ COD: Factor w/ 70 levels &quot;ST1 &quot;,&quot;ST10 &quot;,..: 1 12 23 33 44 55 65 69 70 2 ...
 $ X  : num  2580900 2581100 2581300 2581500 2579100 ...                      
 $ Y  : num  4495500 4495500 4495500 4495500 4495300 ...                      
 $ AS : num  23.59 30.5 23 17.27 9.75 ...                                     
 $ BE : num  3.64 5.16 4.43 3.2 2.51 2.11 2.05 2.9 1.18 2.21 ...              
 $ CD : num  0.19 0.32 0.29 0.15 0.11 0.14 0.13 0.15 0.17 0.1 ...             
 $ CO : num  26.4 84 25.1 23.9 11.5 ...
 $ CR : num  55.5 55.1 53.9 82.6 39 ...
 $ CU : num  34.2 38.3 39.2 46.7 23.1 ...
 $ NI : num  36.7 39.4 39.2 57.1 18.6 ...
 $ PB : num  49.9 69.1 51.1 32 35.5 ...
 $ SB : num  1.07 1.49 1.17 0.77 0.92 0.75 0.92 0.89 0.7 0.75 ...
 $ SE : num  0.91 1.26 1.19 0.91 0.61 0.78 0.43 0.59 0.37 0.38 ...
 $ SN : num  3.31 6.08 3.91 3.85 3.62 3.57 3 3.95 1.93 2.62 ...
 $ TL : num  1.31 2.13 1.65 0.94 0.96 0.64 0.95 1.13 0.67 1.25 ...
 $ V  : num  113.5 133.2 110.2 126.4 72.5 ...
 $ ZN : num  127.7 126.1 143.9 153.8 95.3 ...</pre>

<p>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Text files and tables&quot;,&quot;hid&quot;:&quot;text_files_and_tables&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;762-2029&quot;} -->
<h2 class="sectionedit6" id="method">METHOD</h2>
<div class="level2">

<p>
The data analysis was done by means of the following steps:<br/>

* statistical analysis: data distribution control and their validation;<br/>

* geostatistical analysis: study of the variogram map, experimental semi-variogram creation, choice of the model and its parameters (nugget, range and sill);<br/>

* Kriging interpolation: creation of the isoconcentration maps and their cross-validation.
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;METHOD&quot;,&quot;hid&quot;:&quot;method&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:6,&quot;range&quot;:&quot;2030-2439&quot;} -->
<h2 class="sectionedit7" id="data_import">DATA IMPORT</h2>
<div class="level2">
<pre class="code r">punti=read.csv2(&quot;~/ost4sem/project/input/punti.csv&quot;, header=T)</pre>

<p>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;DATA IMPORT&quot;,&quot;hid&quot;:&quot;data_import&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:7,&quot;range&quot;:&quot;2440-2546&quot;} -->
<h2 class="sectionedit8" id="data_processing">DATA PROCESSING</h2>
<div class="level2">

<p>
A preliminary statistical analysis was performed to individuate the presence of eventual outliers, that were then eliminated from the original dataset, and to verify the data normality or log-normality distribution.
<br/>

The following R packages were used during this analysis:
</p>
<pre class="code r">#installo i paccheti necessari
install.packages(c(&quot;outliers&quot;, &quot;nortest&quot;, &quot;automap&quot;))</pre>

<p>
The visualization of the box-plot and the normal-qqplot provide an initial idea about the presence of outliers.
</p>
<pre class="code r">#creo i boxplot
a=3
for (i in c(&quot;As&quot;,&quot;Be&quot;,&quot;Cd&quot;,&quot;Co&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Ni&quot;,&quot;Pb&quot;,&quot;Sb&quot;,&quot;Se&quot;,&quot;Sn&quot;,&quot;Tl&quot;,&quot;V&quot;,&quot;Zn&quot;)){
    png(paste(&quot;~/ost4sem/project/output/boxplot_&quot;,i,&quot;.png&quot;,sep=&quot;&quot;),width = 800, height = 800)
    a=a+1
    boxplot(punti[[a]], main=i, cex.main=3, cex=2, axes=F, col=7)
    axis(2, cex.axis=2)
    box()
    dev.off()
}</pre>

<p>
<a href="/dokuwiki/lib/exe/detail.php?id=wikibas10%3Abas10krigging&amp;media=wiki:boxplot_selow.png" class="media" title="wiki:boxplot_selow.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wiki:boxplot_selow.png" class="media" alt="" /></a>
</p>
<pre class="code r">#creo i qqplot
a=3
for (i in c(&quot;As&quot;,&quot;Be&quot;,&quot;Cd&quot;,&quot;Co&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Ni&quot;,&quot;Pb&quot;,&quot;Sb&quot;,&quot;Se&quot;,&quot;Sn&quot;,&quot;Tl&quot;,&quot;V&quot;,&quot;Zn&quot;)){
    png(paste(&quot;~/ost4sem/project/output/qqplot_&quot;,i,&quot;.png&quot;,sep=&quot;&quot;),width = 800, height = 800)
    a=a+1    
    par(mar=c(6,6,5,1))
    qqnorm(punti[[a]], main=i, cex.main=3, cex=2,
     axes=F, xlab=&quot;Theoretical Quantiles&quot;,ylab=&quot;Sample Quantiles&quot;, cex.lab=2 )
    axis(2, cex.axis=2)
    axis(1, cex.axis=2)
    box()
    qqline(punti[[a]], lwd=2, col=&quot;red&quot;)
    dev.off()
}</pre>

<p>
<a href="/dokuwiki/lib/exe/detail.php?id=wikibas10%3Abas10krigging&amp;media=wiki:qqplot_selow.png" class="media" title="wiki:qqplot_selow.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wiki:qqplot_selow.png" class="media" alt="" /></a>
<br/>

The outliers individuated were then eliminated using the “outliers” package. 
</p>
<pre class="code r">#rimuovo gli outliers
library(outliers)
elementi_wo=punti
for (i in c(4:17)){
elementi_wo[[i]]= rm.outlier(punti[[i]], fill=TRUE)
}</pre>

<p>
The histograms provide an initial idea about the data distribution.
</p>
<pre class="code r">#creo gli istogrammi
a=3
for (i in c(&quot;As&quot;,&quot;Be&quot;,&quot;Cd&quot;,&quot;Co&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Ni&quot;,&quot;Pb&quot;,&quot;Sb&quot;,&quot;Se&quot;,&quot;Sn&quot;,&quot;Tl&quot;,&quot;V&quot;,&quot;Zn&quot;)){
    png(paste(&quot;~/ost4sem/project/output/ist_&quot;,i,&quot;.png&quot;,sep=&quot;&quot;),width = 800, height = 800)
    a=a+1
    par(mar=c(6,6,5,1))
    hist(elementi_wo[[a]], main=i, cex.main=3, axes=F, xlab=&quot;Concentration&quot;,ylab=&quot;Frequency&quot;, cex.lab=2, col=3)
    axis(2, cex.axis=2)
    axis(1, cex.axis=2)
    box()
    dev.off()
}</pre>

<p>
<a href="/dokuwiki/lib/exe/detail.php?id=wikibas10%3Abas10krigging&amp;media=wiki:ist_selow.png" class="media" title="wiki:ist_selow.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wiki:ist_selow.png" class="media" alt="" /></a>
<br/>

For the study of the data distribution the Lilliefors&#039;s test was used.
</p>
<pre class="code r"># verifico la normalità o la log-normalità della distribuzione dei dati ed elimino quelli con distribuzione non gaussiana
library(nortest)
elementi_norm=elementi_wo
test=matrix(data = NA, nrow = 1, ncol = 14,dimnames = list(&quot;p-value&quot;, c(&quot;As&quot;,&quot;Be&quot;,&quot;Cd&quot;,&quot;Co&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Ni&quot;,&quot;Pb&quot;,&quot;Sb&quot;,&quot;Se&quot;,&quot;Sn&quot;,&quot;Tl&quot;,&quot;V&quot;,&quot;Zn&quot;)))
for (i in c(4:17)){
  if (lillie.test(elementi_wo[[i]])[[2]]&gt;=0.01){
  elementi_norm[[i]]=elementi_wo[[i]] 
  test_=lillie.test(elementi_wo[[i]]) 
  test[,i-3]=test_[[2]]}
  else
      if (lillie.test(log(elementi_wo[[i]]))[[2]]&gt;=0.01){
	elementi_norm[[i]]=log(elementi_wo[[i]])
	test_=lillie.test(elementi_wo[[i]]) 
	test[,i-3]=test_[[2]]}
      else{
	elementi_norm[[i]]=0
	test_=lillie.test(elementi_wo[[i]]) 
	test[,i-3]=test_[[2]]}
write.table(test, file = &quot;test_normalità.txt&quot;)
}</pre>

<p>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;DATA PROCESSING&quot;,&quot;hid&quot;:&quot;data_processing&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:8,&quot;range&quot;:&quot;2547-5615&quot;} -->
<h3 class="sectionedit9" id="model_parametrization">Model parametrization</h3>
<div class="level3">

<p>
The “automap” package was used to obtain the experimental semi-variogram and to compare the use of several models (shperical, exponential, gaussian and Matern model).
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Model parametrization&quot;,&quot;hid&quot;:&quot;model_parametrization&quot;,&quot;codeblockOffset&quot;:8,&quot;secid&quot;:9,&quot;range&quot;:&quot;5616-5816&quot;} -->
<h3 class="sectionedit10" id="model_prediction">Model prediction</h3>
<div class="level3">

<p>
The best model was then used for the Kriging technique and the heavy-metals distribution concentration maps were obtained. 
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Model prediction&quot;,&quot;hid&quot;:&quot;model_prediction&quot;,&quot;codeblockOffset&quot;:8,&quot;secid&quot;:10,&quot;range&quot;:&quot;5817-5969&quot;} -->
<h3 class="sectionedit11" id="validation">Validation</h3>
<div class="level3">

<p>
A cross-validation for the comparison of the estimated values and the sampled ones was done and the maps of the standard error distribution were then obtained. 
</p>
<pre class="code r">#kriging
library(sp)
coordinates(elementi_norm) = ~X + Y
library(automap)
a=2
for (i in c(&quot;As&quot;,&quot;Be&quot;,&quot;Cd&quot;,&quot;Co&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Ni&quot;,&quot;Pb&quot;,&quot;Sb&quot;,&quot;Se&quot;,&quot;Sn&quot;,&quot;Tl&quot;,&quot;V&quot;,&quot;Zn&quot;)){
  if (mean(elementi_norm[[a]])!=0){
    png(paste(&quot;~/ost4sem/project/output/automap_&quot;,i,&quot;.png&quot;,sep=&quot;&quot;),width = 800, height = 800)
    plot(autoKrige(elementi_norm[[a]]~1,elementi_norm, model = c(&quot;Sph&quot;, &quot;Exp&quot;, &quot;Gau&quot;, &quot;Ste&quot;)))    
    dev.off()}
  else print(paste(i, &quot;non ha distribuzione normale&quot;, sep=&quot; &quot;))
a=a+1
}</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Validation&quot;,&quot;hid&quot;:&quot;validation&quot;,&quot;codeblockOffset&quot;:8,&quot;secid&quot;:11,&quot;range&quot;:&quot;5970-6648&quot;} -->
<h2 class="sectionedit12" id="results_and_discussion">RESULTS and DISCUSSION</h2>
<div class="level2">

<p>
Insert a map and related table or graphics if available<br/>

Discuss the biological or geographical significance of results<br/>

<a href="/dokuwiki/lib/exe/detail.php?id=wikibas10%3Abas10krigging&amp;media=wiki:automap_se.png" class="media" title="wiki:automap_se.png"><img src="/dokuwiki/lib/exe/fetch.php?media=wiki:automap_se.png" class="media" alt="" /></a>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;RESULTS and DISCUSSION&quot;,&quot;hid&quot;:&quot;results_and_discussion&quot;,&quot;codeblockOffset&quot;:9,&quot;secid&quot;:12,&quot;range&quot;:&quot;6649-&quot;} -->